(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const f of a)if(f.type==="childList")for(const s of f.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function n(a){const f={};return a.integrity&&(f.integrity=a.integrity),a.referrerPolicy&&(f.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?f.credentials="include":a.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function t(a){if(a.ep)return;a.ep=!0;const f=n(a);fetch(a.href,f)}})();const V0=`/* Main function, uniforms & utils */
precision mediump float;
uniform sampler2D uColorTex;
uniform float uParticleRadius;

varying vec2 vPos;
varying float dist;
#define PI_TWO 1.570796326794897
#define PI 3.141592653589793
#define TWO_PI 6.283185307179586

void main() {
  vec3 pointColor = texture2D(uColorTex, vPos).rgb;
  float fragDist = distance(vec2(.5, .5), gl_PointCoord);
  float slightDist = ((1. + dist) / 2.) * 0.5;

  float alpha = mix(1., 0., (fragDist * 2.) + slightDist);
  if(alpha < .1) {
    discard;
  }
  gl_FragColor = vec4(vec3(.8 - slightDist), 1.);

}`,j0=`/* Main function, uniforms & utils */
precision mediump float;
#pragma glslify: snoise = require(glsl-noise/simplex/2d) 

attribute float aIndex;

uniform sampler2D uColorTex;
uniform sampler2D uPhysTex;
uniform float uParticleRadius;
uniform mat4 uCamMat;
varying vec2 vPos;
varying float dist;
#define PI_TWO 1.570796326794897
#define PI 3.141592653589793
#define TWO_PI 6.283185307179586

vec2 transformCoord(vec2 source) {
    float x = (2. * source.x) - 1.;
    float interY = 1. - source.y;
    float y = (2. * source.y) - 1.;
    return vec2(x, y);
}

void main() {
    float x = mod(aIndex, uParticleRadius) / uParticleRadius;
    float y = floor(aIndex / uParticleRadius) / uParticleRadius;
    vec4 particlePhysData = texture2D(uPhysTex, vec2(x, y));
    vPos = vec2(x, y);
    vec2 form = clamp(particlePhysData.xy, vec2(-1.), vec2(1.));
    float z = snoise(vec2(x * 12., y * 12.) * 12.);
    gl_PointSize = 32.;
    vec4 pos = vec4(transformCoord(form), 0.1 - .2 * z, 1.) * uCamMat;
    dist = pos.z;
    gl_Position = pos;
}`,q0=`/* Main function, uniforms & utils */
precision mediump float;

uniform sampler2D uPhysTex;
uniform float uParticleRadius;

varying vec2 vUV;

#define PI_TWO 1.570796326794897
#define PI 3.141592653589793
#define TWO_PI 6.283185307179586

void main() {
  vec4 pastData = texture2D(uPhysTex, vUV);
  vec2 pos = pastData.xy;
  vec2 vel = pastData.zw;
  vec2 newPos = pos + (vel / 2000.);
  ;
  float dist = distance(newPos, vec2(.5, .5));
  vec2 v = vec2(.5, .5) - newPos;
  float force = 1. / (pow(dist, 2.) * 4096.);
  vec2 normV = normalize(v) * force;
  gl_FragColor = vec4(newPos, pastData.zw + normV);
}`,X0=`/* Main function, uniforms & utils */

precision mediump float;

attribute float aIndex;

uniform sampler2D uPhysTex;
uniform float uParticleRadius;

varying vec2 vUV;

#define PI_TWO 1.570796326794897
#define PI 3.141592653589793
#define TWO_PI 6.283185307179586

void main() {
  float xPosition = (.5 + mod(aIndex, uParticleRadius)) / uParticleRadius;
  float yPosition = 1. - ((.5 + floor(aIndex / uParticleRadius)) / uParticleRadius);
  vec2 screenPos = vec2(-1. + (xPosition * 2.), -1. + (yPosition * 2.));
  gl_Position = vec4(screenPos, 0., 1.);
  gl_PointSize = 1.;
  vUV = vec2(xPosition, yPosition);
}`;var H0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ns(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function W0(e){if(e.__esModule)return e;var r=e.default;if(typeof r=="function"){var n=function t(){if(this instanceof t){var a=[null];a.push.apply(a,arguments);var f=Function.bind.apply(r,a);return new f}return r.apply(this,arguments)};n.prototype=r.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var a=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,a.get?a:{enumerable:!0,get:function(){return e[t]}})}),n}var ts={exports:{}};(function(e,r){(function(n,t){e.exports=t()})(H0,function(){var n=function(i){return i instanceof Uint8Array||i instanceof Uint16Array||i instanceof Uint32Array||i instanceof Int8Array||i instanceof Int16Array||i instanceof Int32Array||i instanceof Float32Array||i instanceof Float64Array||i instanceof Uint8ClampedArray},t=function(i,u){for(var b=Object.keys(u),P=0;P<b.length;++P)i[b[P]]=u[b[P]];return i},a=`
`;function f(i){return typeof atob<"u"?atob(i):"base64:"+i}function s(i){var u=new Error("(regl) "+i);throw console.error(u),u}function c(i,u){i||s(u)}function o(i){return i?": "+i:""}function m(i,u,b){i in u||s("unknown parameter ("+i+")"+o(b)+". possible values: "+Object.keys(u).join())}function E(i,u){n(i)||s("invalid parameter type"+o(u)+". must be a typed array")}function R(i,u){switch(u){case"number":return typeof i=="number";case"object":return typeof i=="object";case"string":return typeof i=="string";case"boolean":return typeof i=="boolean";case"function":return typeof i=="function";case"undefined":return typeof i>"u";case"symbol":return typeof i=="symbol"}}function G(i,u,b){R(i,u)||s("invalid parameter type"+o(b)+". expected "+u+", got "+typeof i)}function F(i,u){i>=0&&(i|0)===i||s("invalid parameter type, ("+i+")"+o(u)+". must be a nonnegative integer")}function V(i,u,b){u.indexOf(i)<0&&s("invalid value"+o(b)+". must be one of: "+u)}var K=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function j(i){Object.keys(i).forEach(function(u){K.indexOf(u)<0&&s('invalid regl constructor argument "'+u+'". must be one of '+K)})}function fe(i,u){for(i=i+"";i.length<u;)i=" "+i;return i}function Ge(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Re(i,u){this.number=i,this.line=u,this.errors=[]}function Ce(i,u,b){this.file=i,this.line=u,this.message=b}function Oe(){var i=new Error,u=(i.stack||i).toString(),b=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(u);if(b)return b[1];var P=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(u);return P?P[1]:"unknown"}function Pe(){var i=new Error,u=(i.stack||i).toString(),b=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(u);if(b)return b[1];var P=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(u);return P?P[1]:"unknown"}function He(i,u){var b=i.split(`
`),P=1,U=0,D={unknown:new Ge,0:new Ge};D.unknown.name=D[0].name=u||Oe(),D.unknown.lines.push(new Re(0,""));for(var N=0;N<b.length;++N){var Q=b[N],Y=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Q);if(Y)switch(Y[1]){case"line":var ne=/(\d+)(\s+\d+)?/.exec(Y[2]);ne&&(P=ne[1]|0,ne[2]&&(U=ne[2]|0,U in D||(D[U]=new Ge)));break;case"define":var ae=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Y[2]);ae&&(D[U].name=ae[1]?f(ae[2]):ae[2]);break}D[U].lines.push(new Re(P++,Q))}return Object.keys(D).forEach(function(te){var se=D[te];se.lines.forEach(function(Z){se.index[Z.number]=Z})}),D}function Qe(i){var u=[];return i.split(`
`).forEach(function(b){if(!(b.length<5)){var P=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(b);P?u.push(new Ce(P[1]|0,P[2]|0,P[3].trim())):b.length>0&&u.push(new Ce("unknown",0,b))}}),u}function Ke(i,u){u.forEach(function(b){var P=i[b.file];if(P){var U=P.index[b.line];if(U){U.errors.push(b),P.hasErrors=!0;return}}i.unknown.hasErrors=!0,i.unknown.lines[0].errors.push(b)})}function Xe(i,u,b,P,U){if(!i.getShaderParameter(u,i.COMPILE_STATUS)){var D=i.getShaderInfoLog(u),N=P===i.FRAGMENT_SHADER?"fragment":"vertex";Br(b,"string",N+" shader source must be a string",U);var Q=He(b,U),Y=Qe(D);Ke(Q,Y),Object.keys(Q).forEach(function(ne){var ae=Q[ne];if(!ae.hasErrors)return;var te=[""],se=[""];function Z(re,S){te.push(re),se.push(S||"")}Z("file number "+ne+": "+ae.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ae.lines.forEach(function(re){if(re.errors.length>0){Z(fe(re.number,4)+"|  ","background-color:yellow; font-weight:bold"),Z(re.line+a,"color:red; background-color:yellow; font-weight:bold");var S=0;re.errors.forEach(function($){var ee=$.message,me=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ee);if(me){var W=me[1];switch(ee=me[2],W){case"assign":W="=";break}S=Math.max(re.line.indexOf(W,S),0)}else S=0;Z(fe("| ",6)),Z(fe("^^^",S+3)+a,"font-weight:bold"),Z(fe("| ",6)),Z(ee+a,"font-weight:bold")}),Z(fe("| ",6)+a)}else Z(fe(re.number,4)+"|  "),Z(re.line+a,"color:red")}),typeof document<"u"&&!window.chrome?(se[0]=te.join("%c"),console.log.apply(console,se)):console.log(te.join(""))}),c.raise("Error compiling "+N+" shader, "+Q[0].name)}}function er(i,u,b,P,U){if(!i.getProgramParameter(u,i.LINK_STATUS)){var D=i.getProgramInfoLog(u),N=He(b,U),Q=He(P,U),Y='Error linking program with vertex shader, "'+Q[0].name+'", and fragment shader "'+N[0].name+'"';typeof document<"u"?console.log("%c"+Y+a+"%c"+D,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Y+a+D),c.raise(Y)}}function We(i){i._commandRef=Oe()}function rr(i,u,b,P){We(i);function U(Y){return Y?P.id(Y):0}i._fragId=U(i.static.frag),i._vertId=U(i.static.vert);function D(Y,ne){Object.keys(ne).forEach(function(ae){Y[P.id(ae)]=!0})}var N=i._uniformSet={};D(N,u.static),D(N,u.dynamic);var Q=i._attributeSet={};D(Q,b.static),D(Q,b.dynamic),i._hasCount="count"in i.static||"count"in i.dynamic||"elements"in i.static||"elements"in i.dynamic}function $e(i,u){var b=Pe();s(i+" in command "+(u||Oe())+(b==="unknown"?"":" called from "+b))}function xr(i,u,b){i||$e(u,b||Oe())}function Qr(i,u,b,P){i in u||$e("unknown parameter ("+i+")"+o(b)+". possible values: "+Object.keys(u).join(),P||Oe())}function Br(i,u,b,P){R(i,u)||$e("invalid parameter type"+o(b)+". expected "+u+", got "+typeof i,P||Oe())}function Qn(i){i()}function Kn(i,u,b){i.texture?V(i.texture._texture.internalformat,u,"unsupported texture format for attachment"):V(i.renderbuffer._renderbuffer.format,b,"unsupported renderbuffer format for attachment")}var Zn=33071,Ya=9728,mc=9984,pc=9985,yc=9986,_c=9987,bc=5120,xc=5121,Ec=5122,Ac=5123,Tc=5124,gc=5125,Qa=5126,Ka=32819,Za=32820,Ja=33635,ei=34042,Mc=36193,Er={};Er[bc]=Er[xc]=1,Er[Ec]=Er[Ac]=Er[Mc]=Er[Ja]=Er[Ka]=Er[Za]=2,Er[Tc]=Er[gc]=Er[Qa]=Er[ei]=4;function ri(i,u){return i===Za||i===Ka||i===Ja?2:i===ei?4:Er[i]*u}function Jn(i){return!(i&i-1)&&!!i}function Sc(i,u,b){var P,U=u.width,D=u.height,N=u.channels;c(U>0&&U<=b.maxTextureSize&&D>0&&D<=b.maxTextureSize,"invalid texture shape"),(i.wrapS!==Zn||i.wrapT!==Zn)&&c(Jn(U)&&Jn(D),"incompatible wrap mode for texture, both width and height must be power of 2"),u.mipmask===1?U!==1&&D!==1&&c(i.minFilter!==mc&&i.minFilter!==yc&&i.minFilter!==pc&&i.minFilter!==_c,"min filter requires mipmap"):(c(Jn(U)&&Jn(D),"texture must be a square power of 2 to support mipmapping"),c(u.mipmask===(U<<1)-1,"missing or incomplete mipmap data")),u.type===Qa&&(b.extensions.indexOf("oes_texture_float_linear")<0&&c(i.minFilter===Ya&&i.magFilter===Ya,"filter not supported, must enable oes_texture_float_linear"),c(!i.genMipmaps,"mipmap generation not supported with float textures"));var Q=u.images;for(P=0;P<16;++P)if(Q[P]){var Y=U>>P,ne=D>>P;c(u.mipmask&1<<P,"missing mipmap data");var ae=Q[P];if(c(ae.width===Y&&ae.height===ne,"invalid shape for mip images"),c(ae.format===u.format&&ae.internalformat===u.internalformat&&ae.type===u.type,"incompatible type for mip image"),!ae.compressed)if(ae.data){var te=Math.ceil(ri(ae.type,N)*Y/ae.unpackAlignment)*ae.unpackAlignment;c(ae.data.byteLength===te*ne,"invalid data for image, buffer size is inconsistent with image format")}else ae.element||ae.copy}else i.genMipmaps||c((u.mipmask&1<<P)===0,"extra mipmap data");u.compressed&&c(!i.genMipmaps,"mipmap generation for compressed images not supported")}function wc(i,u,b,P){var U=i.width,D=i.height,N=i.channels;c(U>0&&U<=P.maxTextureSize&&D>0&&D<=P.maxTextureSize,"invalid texture shape"),c(U===D,"cube map must be square"),c(u.wrapS===Zn&&u.wrapT===Zn,"wrap mode not supported by cube map");for(var Q=0;Q<b.length;++Q){var Y=b[Q];c(Y.width===U&&Y.height===D,"inconsistent cube map face shape"),u.genMipmaps&&(c(!Y.compressed,"can not generate mipmap for compressed textures"),c(Y.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var ne=Y.images,ae=0;ae<16;++ae){var te=ne[ae];if(te){var se=U>>ae,Z=D>>ae;c(Y.mipmask&1<<ae,"missing mipmap data"),c(te.width===se&&te.height===Z,"invalid shape for mip images"),c(te.format===i.format&&te.internalformat===i.internalformat&&te.type===i.type,"incompatible type for mip image"),te.compressed||(te.data?c(te.data.byteLength===se*Z*Math.max(ri(te.type,N),te.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):te.element||te.copy)}}}}var v=t(c,{optional:Qn,raise:s,commandRaise:$e,command:xr,parameter:m,commandParameter:Qr,constructor:j,type:G,commandType:Br,isTypedArray:E,nni:F,oneOf:V,shaderError:Xe,linkError:er,callSite:Pe,saveCommandRef:We,saveDrawInfo:rr,framebufferFormat:Kn,guessCommand:Oe,texture2D:Sc,textureCube:wc}),Lc=0,Rc=0,Oc=5,Cc=6;function Kr(i,u){this.id=Lc++,this.type=i,this.data=u}function ni(i){return i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function On(i){if(i.length===0)return[];var u=i.charAt(0),b=i.charAt(i.length-1);if(i.length>1&&u===b&&(u==='"'||u==="'"))return['"'+ni(i.substr(1,i.length-2))+'"'];var P=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(i);if(P)return On(i.substr(0,P.index)).concat(On(P[1])).concat(On(i.substr(P.index+P[0].length)));var U=i.split(".");if(U.length===1)return['"'+ni(i)+'"'];for(var D=[],N=0;N<U.length;++N)D=D.concat(On(U[N]));return D}function ti(i){return"["+On(i).join("][")+"]"}function Gc(i,u){return new Kr(i,ti(u+""))}function Fc(i){return typeof i=="function"&&!i._reglType||i instanceof Kr}function ai(i,u){if(typeof i=="function")return new Kr(Rc,i);if(typeof i=="number"||typeof i=="boolean")return new Kr(Oc,i);if(Array.isArray(i))return new Kr(Cc,i.map(function(b,P){return ai(b,u+"["+P+"]")}));if(i instanceof Kr)return i;v(!1,"invalid option type in uniform "+u)}var Ar={DynamicVariable:Kr,define:Gc,isDynamic:Fc,unbox:ai,accessor:ti},kt={next:typeof requestAnimationFrame=="function"?function(i){return requestAnimationFrame(i)}:function(i){return setTimeout(i,16)},cancel:typeof cancelAnimationFrame=="function"?function(i){return cancelAnimationFrame(i)}:clearTimeout},ii=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Dc(){var i={"":0},u=[""];return{id:function(b){var P=i[b];return P||(P=i[b]=u.length,u.push(b),P)},str:function(b){return u[b]}}}function Pc(i,u,b){var P=document.createElement("canvas");t(P.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),i.appendChild(P),i===document.body&&(P.style.position="absolute",t(i.style,{margin:0,padding:0}));function U(){var Q=window.innerWidth,Y=window.innerHeight;if(i!==document.body){var ne=P.getBoundingClientRect();Q=ne.right-ne.left,Y=ne.bottom-ne.top}P.width=b*Q,P.height=b*Y}var D;i!==document.body&&typeof ResizeObserver=="function"?(D=new ResizeObserver(function(){setTimeout(U)}),D.observe(i)):window.addEventListener("resize",U,!1);function N(){D?D.disconnect():window.removeEventListener("resize",U),i.removeChild(P)}return U(),{canvas:P,onDestroy:N}}function Ic(i,u){function b(P){try{return i.getContext(P,u)}catch{return null}}return b("webgl")||b("experimental-webgl")||b("webgl-experimental")}function $c(i){return typeof i.nodeName=="string"&&typeof i.appendChild=="function"&&typeof i.getBoundingClientRect=="function"}function Nc(i){return typeof i.drawArrays=="function"||typeof i.drawElements=="function"}function fi(i){return typeof i=="string"?i.split():(v(Array.isArray(i),"invalid extension array"),i)}function si(i){return typeof i=="string"?(v(typeof document<"u","not supported outside of DOM"),document.querySelector(i)):i}function Bc(i){var u=i||{},b,P,U,D,N={},Q=[],Y=[],ne=typeof window>"u"?1:window.devicePixelRatio,ae=!1,te=function(re){re&&v.raise(re)},se=function(){};if(typeof u=="string"?(v(typeof document<"u","selector queries only supported in DOM enviroments"),b=document.querySelector(u),v(b,"invalid query string for element")):typeof u=="object"?$c(u)?b=u:Nc(u)?(D=u,U=D.canvas):(v.constructor(u),"gl"in u?D=u.gl:"canvas"in u?U=si(u.canvas):"container"in u&&(P=si(u.container)),"attributes"in u&&(N=u.attributes,v.type(N,"object","invalid context attributes")),"extensions"in u&&(Q=fi(u.extensions)),"optionalExtensions"in u&&(Y=fi(u.optionalExtensions)),"onDone"in u&&(v.type(u.onDone,"function","invalid or missing onDone callback"),te=u.onDone),"profile"in u&&(ae=!!u.profile),"pixelRatio"in u&&(ne=+u.pixelRatio,v(ne>0,"invalid pixel ratio"))):v.raise("invalid arguments to regl"),b&&(b.nodeName.toLowerCase()==="canvas"?U=b:P=b),!D){if(!U){v(typeof document<"u","must manually specify webgl context outside of DOM environments");var Z=Pc(P||document.body,te,ne);if(!Z)return null;U=Z.canvas,se=Z.onDestroy}N.premultipliedAlpha===void 0&&(N.premultipliedAlpha=!0),D=Ic(U,N)}return D?{gl:D,canvas:U,container:P,extensions:Q,optionalExtensions:Y,pixelRatio:ne,profile:ae,onDone:te,onDestroy:se}:(se(),te("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function kc(i,u){var b={};function P(N){v.type(N,"string","extension name must be string");var Q=N.toLowerCase(),Y;try{Y=b[Q]=i.getExtension(Q)}catch{}return!!Y}for(var U=0;U<u.extensions.length;++U){var D=u.extensions[U];if(!P(D))return u.onDestroy(),u.onDone('"'+D+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return u.optionalExtensions.forEach(P),{extensions:b,restore:function(){Object.keys(b).forEach(function(N){if(b[N]&&!P(N))throw new Error("(regl): error restoring extension "+N)})}}}function Tr(i,u){for(var b=Array(i),P=0;P<i;++P)b[P]=u(P);return b}var zc=5120,Uc=5121,Vc=5122,jc=5123,qc=5124,Xc=5125,Hc=5126;function Wc(i){for(var u=16;u<=1<<28;u*=16)if(i<=u)return u;return 0}function ci(i){var u,b;return u=(i>65535)<<4,i>>>=u,b=(i>255)<<3,i>>>=b,u|=b,b=(i>15)<<2,i>>>=b,u|=b,b=(i>3)<<1,i>>>=b,u|=b,u|i>>1}function li(){var i=Tr(8,function(){return[]});function u(D){var N=Wc(D),Q=i[ci(N)>>2];return Q.length>0?Q.pop():new ArrayBuffer(N)}function b(D){i[ci(D.byteLength)>>2].push(D)}function P(D,N){var Q=null;switch(D){case zc:Q=new Int8Array(u(N),0,N);break;case Uc:Q=new Uint8Array(u(N),0,N);break;case Vc:Q=new Int16Array(u(2*N),0,N);break;case jc:Q=new Uint16Array(u(2*N),0,N);break;case qc:Q=new Int32Array(u(4*N),0,N);break;case Xc:Q=new Uint32Array(u(4*N),0,N);break;case Hc:Q=new Float32Array(u(4*N),0,N);break;default:return null}return Q.length!==N?Q.subarray(0,N):Q}function U(D){b(D.buffer)}return{alloc:u,free:b,allocType:P,freeType:U}}var ir=li();ir.zero=li();var Yc=3408,Qc=3410,Kc=3411,Zc=3412,Jc=3413,el=3414,rl=3415,nl=33901,tl=33902,al=3379,il=3386,fl=34921,sl=36347,cl=36348,ll=35661,ol=35660,ul=34930,vl=36349,dl=34076,hl=34024,ml=7936,pl=7937,yl=7938,_l=35724,bl=34047,xl=36063,El=34852,et=3553,oi=34067,Al=34069,Tl=33984,Cn=6408,zt=5126,ui=5121,Ut=36160,gl=36053,Ml=36064,Sl=16384,wl=function(i,u){var b=1;u.ext_texture_filter_anisotropic&&(b=i.getParameter(bl));var P=1,U=1;u.webgl_draw_buffers&&(P=i.getParameter(El),U=i.getParameter(xl));var D=!!u.oes_texture_float;if(D){var N=i.createTexture();i.bindTexture(et,N),i.texImage2D(et,0,Cn,1,1,0,Cn,zt,null);var Q=i.createFramebuffer();if(i.bindFramebuffer(Ut,Q),i.framebufferTexture2D(Ut,Ml,et,N,0),i.bindTexture(et,null),i.checkFramebufferStatus(Ut)!==gl)D=!1;else{i.viewport(0,0,1,1),i.clearColor(1,0,0,1),i.clear(Sl);var Y=ir.allocType(zt,4);i.readPixels(0,0,1,1,Cn,zt,Y),i.getError()?D=!1:(i.deleteFramebuffer(Q),i.deleteTexture(N),D=Y[0]===1),ir.freeType(Y)}}var ne=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ae=!0;if(!ne){var te=i.createTexture(),se=ir.allocType(ui,36);i.activeTexture(Tl),i.bindTexture(oi,te),i.texImage2D(Al,0,Cn,3,3,0,Cn,ui,se),ir.freeType(se),i.bindTexture(oi,null),i.deleteTexture(te),ae=!i.getError()}return{colorBits:[i.getParameter(Qc),i.getParameter(Kc),i.getParameter(Zc),i.getParameter(Jc)],depthBits:i.getParameter(el),stencilBits:i.getParameter(rl),subpixelBits:i.getParameter(Yc),extensions:Object.keys(u).filter(function(Z){return!!u[Z]}),maxAnisotropic:b,maxDrawbuffers:P,maxColorAttachments:U,pointSizeDims:i.getParameter(nl),lineWidthDims:i.getParameter(tl),maxViewportDims:i.getParameter(il),maxCombinedTextureUnits:i.getParameter(ll),maxCubeMapSize:i.getParameter(dl),maxRenderbufferSize:i.getParameter(hl),maxTextureUnits:i.getParameter(ul),maxTextureSize:i.getParameter(al),maxAttributes:i.getParameter(fl),maxVertexUniforms:i.getParameter(sl),maxVertexTextureUnits:i.getParameter(ol),maxVaryingVectors:i.getParameter(cl),maxFragmentUniforms:i.getParameter(vl),glsl:i.getParameter(_l),renderer:i.getParameter(pl),vendor:i.getParameter(ml),version:i.getParameter(yl),readFloat:D,npotTextureCube:ae}};function Lr(i){return!!i&&typeof i=="object"&&Array.isArray(i.shape)&&Array.isArray(i.stride)&&typeof i.offset=="number"&&i.shape.length===i.stride.length&&(Array.isArray(i.data)||n(i.data))}var gr=function(i){return Object.keys(i).map(function(u){return i[u]})},rt={shape:Cl,flatten:Ol};function Ll(i,u,b){for(var P=0;P<u;++P)b[P]=i[P]}function Rl(i,u,b,P){for(var U=0,D=0;D<u;++D)for(var N=i[D],Q=0;Q<b;++Q)P[U++]=N[Q]}function vi(i,u,b,P,U,D){for(var N=D,Q=0;Q<u;++Q)for(var Y=i[Q],ne=0;ne<b;++ne)for(var ae=Y[ne],te=0;te<P;++te)U[N++]=ae[te]}function di(i,u,b,P,U){for(var D=1,N=b+1;N<u.length;++N)D*=u[N];var Q=u[b];if(u.length-b===4){var Y=u[b+1],ne=u[b+2],ae=u[b+3];for(N=0;N<Q;++N)vi(i[N],Y,ne,ae,P,U),U+=D}else for(N=0;N<Q;++N)di(i[N],u,b+1,P,U),U+=D}function Ol(i,u,b,P){var U=1;if(u.length)for(var D=0;D<u.length;++D)U*=u[D];else U=0;var N=P||ir.allocType(b,U);switch(u.length){case 0:break;case 1:Ll(i,u[0],N);break;case 2:Rl(i,u[0],u[1],N);break;case 3:vi(i,u[0],u[1],u[2],N,0);break;default:di(i,u,0,N,0)}return N}function Cl(i){for(var u=[],b=i;b.length;b=b[0])u.push(b.length);return u}var Vt={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Gl=5120,Fl=5122,Dl=5124,Pl=5121,Il=5123,$l=5125,Nl=5126,Bl=5126,Zr={int8:Gl,int16:Fl,int32:Dl,uint8:Pl,uint16:Il,uint32:$l,float:Nl,float32:Bl},kl=35048,zl=35040,nt={dynamic:kl,stream:zl,static:35044},jt=rt.flatten,hi=rt.shape,mi=35044,Ul=35040,qt=5121,Xt=5126,kr=[];kr[5120]=1,kr[5122]=2,kr[5124]=4,kr[5121]=1,kr[5123]=2,kr[5125]=4,kr[5126]=4;function tt(i){return Vt[Object.prototype.toString.call(i)]|0}function pi(i,u){for(var b=0;b<u.length;++b)i[b]=u[b]}function yi(i,u,b,P,U,D,N){for(var Q=0,Y=0;Y<b;++Y)for(var ne=0;ne<P;++ne)i[Q++]=u[U*Y+D*ne+N]}function Vl(i,u,b,P){var U=0,D={};function N(S){this.id=U++,this.buffer=i.createBuffer(),this.type=S,this.usage=mi,this.byteLength=0,this.dimension=1,this.dtype=qt,this.persistentData=null,b.profile&&(this.stats={size:0})}N.prototype.bind=function(){i.bindBuffer(this.type,this.buffer)},N.prototype.destroy=function(){se(this)};var Q=[];function Y(S,$){var ee=Q.pop();return ee||(ee=new N(S)),ee.bind(),te(ee,$,Ul,0,1,!1),ee}function ne(S){Q.push(S)}function ae(S,$,ee){S.byteLength=$.byteLength,i.bufferData(S.type,$,ee)}function te(S,$,ee,me,W,de){var ue;if(S.usage=ee,Array.isArray($)){if(S.dtype=me||Xt,$.length>0){var Ae;if(Array.isArray($[0])){ue=hi($);for(var q=1,z=1;z<ue.length;++z)q*=ue[z];S.dimension=q,Ae=jt($,ue,S.dtype),ae(S,Ae,ee),de?S.persistentData=Ae:ir.freeType(Ae)}else if(typeof $[0]=="number"){S.dimension=W;var _e=ir.allocType(S.dtype,$.length);pi(_e,$),ae(S,_e,ee),de?S.persistentData=_e:ir.freeType(_e)}else n($[0])?(S.dimension=$[0].length,S.dtype=me||tt($[0])||Xt,Ae=jt($,[$.length,$[0].length],S.dtype),ae(S,Ae,ee),de?S.persistentData=Ae:ir.freeType(Ae)):v.raise("invalid buffer data")}}else if(n($))S.dtype=me||tt($),S.dimension=W,ae(S,$,ee),de&&(S.persistentData=new Uint8Array(new Uint8Array($.buffer)));else if(Lr($)){ue=$.shape;var ce=$.stride,J=$.offset,le=0,oe=0,Fe=0,Le=0;ue.length===1?(le=ue[0],oe=1,Fe=ce[0],Le=0):ue.length===2?(le=ue[0],oe=ue[1],Fe=ce[0],Le=ce[1]):v.raise("invalid shape"),S.dtype=me||tt($.data)||Xt,S.dimension=oe;var ve=ir.allocType(S.dtype,le*oe);yi(ve,$.data,le,oe,Fe,Le,J),ae(S,ve,ee),de?S.persistentData=ve:ir.freeType(ve)}else $ instanceof ArrayBuffer?(S.dtype=qt,S.dimension=W,ae(S,$,ee),de&&(S.persistentData=new Uint8Array(new Uint8Array($)))):v.raise("invalid buffer data")}function se(S){u.bufferCount--,P(S);var $=S.buffer;v($,"buffer must not be deleted already"),i.deleteBuffer($),S.buffer=null,delete D[S.id]}function Z(S,$,ee,me){u.bufferCount++;var W=new N($);D[W.id]=W;function de(q){var z=mi,_e=null,ce=0,J=0,le=1;return Array.isArray(q)||n(q)||Lr(q)||q instanceof ArrayBuffer?_e=q:typeof q=="number"?ce=q|0:q&&(v.type(q,"object","buffer arguments must be an object, a number or an array"),"data"in q&&(v(_e===null||Array.isArray(_e)||n(_e)||Lr(_e),"invalid data for buffer"),_e=q.data),"usage"in q&&(v.parameter(q.usage,nt,"invalid buffer usage"),z=nt[q.usage]),"type"in q&&(v.parameter(q.type,Zr,"invalid buffer type"),J=Zr[q.type]),"dimension"in q&&(v.type(q.dimension,"number","invalid dimension"),le=q.dimension|0),"length"in q&&(v.nni(ce,"buffer length must be a nonnegative integer"),ce=q.length|0)),W.bind(),_e?te(W,_e,z,J,le,me):(ce&&i.bufferData(W.type,ce,z),W.dtype=J||qt,W.usage=z,W.dimension=le,W.byteLength=ce),b.profile&&(W.stats.size=W.byteLength*kr[W.dtype]),de}function ue(q,z){v(z+q.byteLength<=W.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+q.byteLength+" starting from offset "+z+" to a buffer of size "+W.byteLength),i.bufferSubData(W.type,z,q)}function Ae(q,z){var _e=(z||0)|0,ce;if(W.bind(),n(q)||q instanceof ArrayBuffer)ue(q,_e);else if(Array.isArray(q)){if(q.length>0)if(typeof q[0]=="number"){var J=ir.allocType(W.dtype,q.length);pi(J,q),ue(J,_e),ir.freeType(J)}else if(Array.isArray(q[0])||n(q[0])){ce=hi(q);var le=jt(q,ce,W.dtype);ue(le,_e),ir.freeType(le)}else v.raise("invalid buffer data")}else if(Lr(q)){ce=q.shape;var oe=q.stride,Fe=0,Le=0,ve=0,he=0;ce.length===1?(Fe=ce[0],Le=1,ve=oe[0],he=0):ce.length===2?(Fe=ce[0],Le=ce[1],ve=oe[0],he=oe[1]):v.raise("invalid shape");var Me=Array.isArray(q.data)?W.dtype:tt(q.data),De=ir.allocType(Me,Fe*Le);yi(De,q.data,Fe,Le,ve,he,q.offset),ue(De,_e),ir.freeType(De)}else v.raise("invalid data for buffer subdata");return de}return ee||de(S),de._reglType="buffer",de._buffer=W,de.subdata=Ae,b.profile&&(de.stats=W.stats),de.destroy=function(){se(W)},de}function re(){gr(D).forEach(function(S){S.buffer=i.createBuffer(),i.bindBuffer(S.type,S.buffer),i.bufferData(S.type,S.persistentData||S.byteLength,S.usage)})}return b.profile&&(u.getTotalBufferSize=function(){var S=0;return Object.keys(D).forEach(function($){S+=D[$].stats.size}),S}),{create:Z,createStream:Y,destroyStream:ne,clear:function(){gr(D).forEach(se),Q.forEach(se)},getBuffer:function(S){return S&&S._buffer instanceof N?S._buffer:null},restore:re,_initBuffer:te}}var jl=0,ql=0,Xl=1,Hl=1,Wl=4,Yl=4,zr={points:jl,point:ql,lines:Xl,line:Hl,triangles:Wl,triangle:Yl,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Ql=0,Kl=1,Gn=4,Zl=5120,hn=5121,_i=5122,mn=5123,bi=5124,Jr=5125,Ht=34963,Jl=35040,eo=35044;function ro(i,u,b,P){var U={},D=0,N={uint8:hn,uint16:mn};u.oes_element_index_uint&&(N.uint32=Jr);function Q(re){this.id=D++,U[this.id]=this,this.buffer=re,this.primType=Gn,this.vertCount=0,this.type=0}Q.prototype.bind=function(){this.buffer.bind()};var Y=[];function ne(re){var S=Y.pop();return S||(S=new Q(b.create(null,Ht,!0,!1)._buffer)),te(S,re,Jl,-1,-1,0,0),S}function ae(re){Y.push(re)}function te(re,S,$,ee,me,W,de){re.buffer.bind();var ue;if(S){var Ae=de;!de&&(!n(S)||Lr(S)&&!n(S.data))&&(Ae=u.oes_element_index_uint?Jr:mn),b._initBuffer(re.buffer,S,$,Ae,3)}else i.bufferData(Ht,W,$),re.buffer.dtype=ue||hn,re.buffer.usage=$,re.buffer.dimension=3,re.buffer.byteLength=W;if(ue=de,!de){switch(re.buffer.dtype){case hn:case Zl:ue=hn;break;case mn:case _i:ue=mn;break;case Jr:case bi:ue=Jr;break;default:v.raise("unsupported type for element array")}re.buffer.dtype=ue}re.type=ue,v(ue!==Jr||!!u.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var q=me;q<0&&(q=re.buffer.byteLength,ue===mn?q>>=1:ue===Jr&&(q>>=2)),re.vertCount=q;var z=ee;if(ee<0){z=Gn;var _e=re.buffer.dimension;_e===1&&(z=Ql),_e===2&&(z=Kl),_e===3&&(z=Gn)}re.primType=z}function se(re){P.elementsCount--,v(re.buffer!==null,"must not double destroy elements"),delete U[re.id],re.buffer.destroy(),re.buffer=null}function Z(re,S){var $=b.create(null,Ht,!0),ee=new Q($._buffer);P.elementsCount++;function me(W){if(!W)$(),ee.primType=Gn,ee.vertCount=0,ee.type=hn;else if(typeof W=="number")$(W),ee.primType=Gn,ee.vertCount=W|0,ee.type=hn;else{var de=null,ue=eo,Ae=-1,q=-1,z=0,_e=0;Array.isArray(W)||n(W)||Lr(W)?de=W:(v.type(W,"object","invalid arguments for elements"),"data"in W&&(de=W.data,v(Array.isArray(de)||n(de)||Lr(de),"invalid data for element buffer")),"usage"in W&&(v.parameter(W.usage,nt,"invalid element buffer usage"),ue=nt[W.usage]),"primitive"in W&&(v.parameter(W.primitive,zr,"invalid element buffer primitive"),Ae=zr[W.primitive]),"count"in W&&(v(typeof W.count=="number"&&W.count>=0,"invalid vertex count for elements"),q=W.count|0),"type"in W&&(v.parameter(W.type,N,"invalid buffer type"),_e=N[W.type]),"length"in W?z=W.length|0:(z=q,_e===mn||_e===_i?z*=2:(_e===Jr||_e===bi)&&(z*=4))),te(ee,de,ue,Ae,q,z,_e)}return me}return me(re),me._reglType="elements",me._elements=ee,me.subdata=function(W,de){return $.subdata(W,de),me},me.destroy=function(){se(ee)},me}return{create:Z,createStream:ne,destroyStream:ae,getElements:function(re){return typeof re=="function"&&re._elements instanceof Q?re._elements:null},clear:function(){gr(U).forEach(se)}}}var xi=new Float32Array(1),no=new Uint32Array(xi.buffer),to=5123;function Ei(i){for(var u=ir.allocType(to,i.length),b=0;b<i.length;++b)if(isNaN(i[b]))u[b]=65535;else if(i[b]===1/0)u[b]=31744;else if(i[b]===-1/0)u[b]=64512;else{xi[0]=i[b];var P=no[0],U=P>>>31<<15,D=(P<<1>>>24)-127,N=P>>13&1024-1;if(D<-24)u[b]=U;else if(D<-14){var Q=-14-D;u[b]=U+(N+1024>>Q)}else D>15?u[b]=U+31744:u[b]=U+(D+15<<10)+N}return u}function Ze(i){return Array.isArray(i)||n(i)}var Ai=function(i){return!(i&i-1)&&!!i},ao=34467,Cr=3553,Wt=34067,at=34069,en=6408,Yt=6406,it=6407,Fn=6409,ft=6410,Ti=32854,Qt=32855,gi=36194,io=32819,fo=32820,so=33635,co=34042,Kt=6402,st=34041,Zt=35904,Jt=35906,pn=36193,ea=33776,ra=33777,na=33778,ta=33779,Mi=35986,Si=35987,wi=34798,Li=35840,Ri=35841,Oi=35842,Ci=35843,Gi=36196,yn=5121,aa=5123,ia=5125,Dn=5126,lo=10242,oo=10243,uo=10497,fa=33071,vo=33648,ho=10240,mo=10241,sa=9728,po=9729,ca=9984,Fi=9985,Di=9986,la=9987,yo=33170,ct=4352,_o=4353,bo=4354,xo=34046,Eo=3317,Ao=37440,To=37441,go=37443,Pi=37444,Pn=33984,Mo=[ca,Di,Fi,la],lt=[0,Fn,ft,it,en],Sr={};Sr[Fn]=Sr[Yt]=Sr[Kt]=1,Sr[st]=Sr[ft]=2,Sr[it]=Sr[Zt]=3,Sr[en]=Sr[Jt]=4;function _n(i){return"[object "+i+"]"}var Ii=_n("HTMLCanvasElement"),$i=_n("OffscreenCanvas"),Ni=_n("CanvasRenderingContext2D"),Bi=_n("ImageBitmap"),ki=_n("HTMLImageElement"),zi=_n("HTMLVideoElement"),So=Object.keys(Vt).concat([Ii,$i,Ni,Bi,ki,zi]),bn=[];bn[yn]=1,bn[Dn]=4,bn[pn]=2,bn[aa]=2,bn[ia]=4;var dr=[];dr[Ti]=2,dr[Qt]=2,dr[gi]=2,dr[st]=4,dr[ea]=.5,dr[ra]=.5,dr[na]=1,dr[ta]=1,dr[Mi]=.5,dr[Si]=1,dr[wi]=1,dr[Li]=.5,dr[Ri]=.25,dr[Oi]=.5,dr[Ci]=.25,dr[Gi]=.5;function Ui(i){return Array.isArray(i)&&(i.length===0||typeof i[0]=="number")}function Vi(i){if(!Array.isArray(i))return!1;var u=i.length;return!(u===0||!Ze(i[0]))}function rn(i){return Object.prototype.toString.call(i)}function ji(i){return rn(i)===Ii}function qi(i){return rn(i)===$i}function wo(i){return rn(i)===Ni}function Lo(i){return rn(i)===Bi}function Ro(i){return rn(i)===ki}function Oo(i){return rn(i)===zi}function oa(i){if(!i)return!1;var u=rn(i);return So.indexOf(u)>=0?!0:Ui(i)||Vi(i)||Lr(i)}function Xi(i){return Vt[Object.prototype.toString.call(i)]|0}function Co(i,u){var b=u.length;switch(i.type){case yn:case aa:case ia:case Dn:var P=ir.allocType(i.type,b);P.set(u),i.data=P;break;case pn:i.data=Ei(u);break;default:v.raise("unsupported texture type, must specify a typed array")}}function Hi(i,u){return ir.allocType(i.type===pn?Dn:i.type,u)}function Wi(i,u){i.type===pn?(i.data=Ei(u),ir.freeType(u)):i.data=u}function Go(i,u,b,P,U,D){for(var N=i.width,Q=i.height,Y=i.channels,ne=N*Q*Y,ae=Hi(i,ne),te=0,se=0;se<Q;++se)for(var Z=0;Z<N;++Z)for(var re=0;re<Y;++re)ae[te++]=u[b*Z+P*se+U*re+D];Wi(i,ae)}function ot(i,u,b,P,U,D){var N;if(typeof dr[i]<"u"?N=dr[i]:N=Sr[i]*bn[u],D&&(N*=6),U){for(var Q=0,Y=b;Y>=1;)Q+=N*Y*Y,Y/=2;return Q}else return N*b*P}function Fo(i,u,b,P,U,D,N){var Q={"don't care":ct,"dont care":ct,nice:bo,fast:_o},Y={repeat:uo,clamp:fa,mirror:vo},ne={nearest:sa,linear:po},ae=t({mipmap:la,"nearest mipmap nearest":ca,"linear mipmap nearest":Fi,"nearest mipmap linear":Di,"linear mipmap linear":la},ne),te={none:0,browser:Pi},se={uint8:yn,rgba4:io,rgb565:so,"rgb5 a1":fo},Z={alpha:Yt,luminance:Fn,"luminance alpha":ft,rgb:it,rgba:en,rgba4:Ti,"rgb5 a1":Qt,rgb565:gi},re={};u.ext_srgb&&(Z.srgb=Zt,Z.srgba=Jt),u.oes_texture_float&&(se.float32=se.float=Dn),u.oes_texture_half_float&&(se.float16=se["half float"]=pn),u.webgl_depth_texture&&(t(Z,{depth:Kt,"depth stencil":st}),t(se,{uint16:aa,uint32:ia,"depth stencil":co})),u.webgl_compressed_texture_s3tc&&t(re,{"rgb s3tc dxt1":ea,"rgba s3tc dxt1":ra,"rgba s3tc dxt3":na,"rgba s3tc dxt5":ta}),u.webgl_compressed_texture_atc&&t(re,{"rgb atc":Mi,"rgba atc explicit alpha":Si,"rgba atc interpolated alpha":wi}),u.webgl_compressed_texture_pvrtc&&t(re,{"rgb pvrtc 4bppv1":Li,"rgb pvrtc 2bppv1":Ri,"rgba pvrtc 4bppv1":Oi,"rgba pvrtc 2bppv1":Ci}),u.webgl_compressed_texture_etc1&&(re["rgb etc1"]=Gi);var S=Array.prototype.slice.call(i.getParameter(ao));Object.keys(re).forEach(function(y){var I=re[y];S.indexOf(I)>=0&&(Z[y]=I)});var $=Object.keys(Z);b.textureFormats=$;var ee=[];Object.keys(Z).forEach(function(y){var I=Z[y];ee[I]=y});var me=[];Object.keys(se).forEach(function(y){var I=se[y];me[I]=y});var W=[];Object.keys(ne).forEach(function(y){var I=ne[y];W[I]=y});var de=[];Object.keys(ae).forEach(function(y){var I=ae[y];de[I]=y});var ue=[];Object.keys(Y).forEach(function(y){var I=Y[y];ue[I]=y});var Ae=$.reduce(function(y,I){var C=Z[I];return C===Fn||C===Yt||C===Fn||C===ft||C===Kt||C===st||u.ext_srgb&&(C===Zt||C===Jt)?y[C]=C:C===Qt||I.indexOf("rgba")>=0?y[C]=en:y[C]=it,y},{});function q(){this.internalformat=en,this.format=en,this.type=yn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Pi,this.width=0,this.height=0,this.channels=0}function z(y,I){y.internalformat=I.internalformat,y.format=I.format,y.type=I.type,y.compressed=I.compressed,y.premultiplyAlpha=I.premultiplyAlpha,y.flipY=I.flipY,y.unpackAlignment=I.unpackAlignment,y.colorSpace=I.colorSpace,y.width=I.width,y.height=I.height,y.channels=I.channels}function _e(y,I){if(!(typeof I!="object"||!I)){if("premultiplyAlpha"in I&&(v.type(I.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),y.premultiplyAlpha=I.premultiplyAlpha),"flipY"in I&&(v.type(I.flipY,"boolean","invalid texture flip"),y.flipY=I.flipY),"alignment"in I&&(v.oneOf(I.alignment,[1,2,4,8],"invalid texture unpack alignment"),y.unpackAlignment=I.alignment),"colorSpace"in I&&(v.parameter(I.colorSpace,te,"invalid colorSpace"),y.colorSpace=te[I.colorSpace]),"type"in I){var C=I.type;v(u.oes_texture_float||!(C==="float"||C==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),v(u.oes_texture_half_float||!(C==="half float"||C==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),v(u.webgl_depth_texture||!(C==="uint16"||C==="uint32"||C==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),v.parameter(C,se,"invalid texture type"),y.type=se[C]}var ye=y.width,Ne=y.height,d=y.channels,l=!1;"shape"in I?(v(Array.isArray(I.shape)&&I.shape.length>=2,"shape must be an array"),ye=I.shape[0],Ne=I.shape[1],I.shape.length===3&&(d=I.shape[2],v(d>0&&d<=4,"invalid number of channels"),l=!0),v(ye>=0&&ye<=b.maxTextureSize,"invalid width"),v(Ne>=0&&Ne<=b.maxTextureSize,"invalid height")):("radius"in I&&(ye=Ne=I.radius,v(ye>=0&&ye<=b.maxTextureSize,"invalid radius")),"width"in I&&(ye=I.width,v(ye>=0&&ye<=b.maxTextureSize,"invalid width")),"height"in I&&(Ne=I.height,v(Ne>=0&&Ne<=b.maxTextureSize,"invalid height")),"channels"in I&&(d=I.channels,v(d>0&&d<=4,"invalid number of channels"),l=!0)),y.width=ye|0,y.height=Ne|0,y.channels=d|0;var x=!1;if("format"in I){var M=I.format;v(u.webgl_depth_texture||!(M==="depth"||M==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),v.parameter(M,Z,"invalid texture format");var w=y.internalformat=Z[M];y.format=Ae[w],M in se&&("type"in I||(y.type=se[M])),M in re&&(y.compressed=!0),x=!0}!l&&x?y.channels=Sr[y.format]:l&&!x?y.channels!==lt[y.format]&&(y.format=y.internalformat=lt[y.channels]):x&&l&&v(y.channels===Sr[y.format],"number of channels inconsistent with specified format")}}function ce(y){i.pixelStorei(Ao,y.flipY),i.pixelStorei(To,y.premultiplyAlpha),i.pixelStorei(go,y.colorSpace),i.pixelStorei(Eo,y.unpackAlignment)}function J(){q.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function le(y,I){var C=null;if(oa(I)?C=I:I&&(v.type(I,"object","invalid pixel data type"),_e(y,I),"x"in I&&(y.xOffset=I.x|0),"y"in I&&(y.yOffset=I.y|0),oa(I.data)&&(C=I.data)),v(!y.compressed||C instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),I.copy){v(!C,"can not specify copy and data field for the same texture");var ye=U.viewportWidth,Ne=U.viewportHeight;y.width=y.width||ye-y.xOffset,y.height=y.height||Ne-y.yOffset,y.needsCopy=!0,v(y.xOffset>=0&&y.xOffset<ye&&y.yOffset>=0&&y.yOffset<Ne&&y.width>0&&y.width<=ye&&y.height>0&&y.height<=Ne,"copy texture read out of bounds")}else if(!C)y.width=y.width||1,y.height=y.height||1,y.channels=y.channels||4;else if(n(C))y.channels=y.channels||4,y.data=C,!("type"in I)&&y.type===yn&&(y.type=Xi(C));else if(Ui(C))y.channels=y.channels||4,Co(y,C),y.alignment=1,y.needsFree=!0;else if(Lr(C)){var d=C.data;!Array.isArray(d)&&y.type===yn&&(y.type=Xi(d));var l=C.shape,x=C.stride,M,w,T,A,g,h;l.length===3?(T=l[2],h=x[2]):(v(l.length===2,"invalid ndarray pixel data, must be 2 or 3D"),T=1,h=1),M=l[0],w=l[1],A=x[0],g=x[1],y.alignment=1,y.width=M,y.height=w,y.channels=T,y.format=y.internalformat=lt[T],y.needsFree=!0,Go(y,d,A,g,h,C.offset)}else if(ji(C)||qi(C)||wo(C))ji(C)||qi(C)?y.element=C:y.element=C.canvas,y.width=y.element.width,y.height=y.element.height,y.channels=4;else if(Lo(C))y.element=C,y.width=C.width,y.height=C.height,y.channels=4;else if(Ro(C))y.element=C,y.width=C.naturalWidth,y.height=C.naturalHeight,y.channels=4;else if(Oo(C))y.element=C,y.width=C.videoWidth,y.height=C.videoHeight,y.channels=4;else if(Vi(C)){var _=y.width||C[0].length,p=y.height||C.length,O=y.channels;Ze(C[0][0])?O=O||C[0][0].length:O=O||1;for(var L=rt.shape(C),k=1,X=0;X<L.length;++X)k*=L[X];var ie=Hi(y,k);rt.flatten(C,L,"",ie),Wi(y,ie),y.alignment=1,y.width=_,y.height=p,y.channels=O,y.format=y.internalformat=lt[O],y.needsFree=!0}y.type===Dn?v(b.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):y.type===pn&&v(b.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function oe(y,I,C){var ye=y.element,Ne=y.data,d=y.internalformat,l=y.format,x=y.type,M=y.width,w=y.height;ce(y),ye?i.texImage2D(I,C,l,l,x,ye):y.compressed?i.compressedTexImage2D(I,C,d,M,w,0,Ne):y.needsCopy?(P(),i.copyTexImage2D(I,C,l,y.xOffset,y.yOffset,M,w,0)):i.texImage2D(I,C,l,M,w,0,l,x,Ne||null)}function Fe(y,I,C,ye,Ne){var d=y.element,l=y.data,x=y.internalformat,M=y.format,w=y.type,T=y.width,A=y.height;ce(y),d?i.texSubImage2D(I,Ne,C,ye,M,w,d):y.compressed?i.compressedTexSubImage2D(I,Ne,C,ye,x,T,A,l):y.needsCopy?(P(),i.copyTexSubImage2D(I,Ne,C,ye,y.xOffset,y.yOffset,T,A)):i.texSubImage2D(I,Ne,C,ye,T,A,M,w,l)}var Le=[];function ve(){return Le.pop()||new J}function he(y){y.needsFree&&ir.freeType(y.data),J.call(y),Le.push(y)}function Me(){q.call(this),this.genMipmaps=!1,this.mipmapHint=ct,this.mipmask=0,this.images=Array(16)}function De(y,I,C){var ye=y.images[0]=ve();y.mipmask=1,ye.width=y.width=I,ye.height=y.height=C,ye.channels=y.channels=4}function Be(y,I){var C=null;if(oa(I))C=y.images[0]=ve(),z(C,y),le(C,I),y.mipmask=1;else if(_e(y,I),Array.isArray(I.mipmap))for(var ye=I.mipmap,Ne=0;Ne<ye.length;++Ne)C=y.images[Ne]=ve(),z(C,y),C.width>>=Ne,C.height>>=Ne,le(C,ye[Ne]),y.mipmask|=1<<Ne;else C=y.images[0]=ve(),z(C,y),le(C,I),y.mipmask=1;z(y,y.images[0]),y.compressed&&(y.internalformat===ea||y.internalformat===ra||y.internalformat===na||y.internalformat===ta)&&v(y.width%4===0&&y.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Je(y,I){for(var C=y.images,ye=0;ye<C.length;++ye){if(!C[ye])return;oe(C[ye],I,ye)}}var nr=[];function ze(){var y=nr.pop()||new Me;q.call(y),y.mipmask=0;for(var I=0;I<16;++I)y.images[I]=null;return y}function cr(y){for(var I=y.images,C=0;C<I.length;++C)I[C]&&he(I[C]),I[C]=null;nr.push(y)}function Ye(){this.minFilter=sa,this.magFilter=sa,this.wrapS=fa,this.wrapT=fa,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ct}function sr(y,I){if("min"in I){var C=I.min;v.parameter(C,ae),y.minFilter=ae[C],Mo.indexOf(y.minFilter)>=0&&!("faces"in I)&&(y.genMipmaps=!0)}if("mag"in I){var ye=I.mag;v.parameter(ye,ne),y.magFilter=ne[ye]}var Ne=y.wrapS,d=y.wrapT;if("wrap"in I){var l=I.wrap;typeof l=="string"?(v.parameter(l,Y),Ne=d=Y[l]):Array.isArray(l)&&(v.parameter(l[0],Y),v.parameter(l[1],Y),Ne=Y[l[0]],d=Y[l[1]])}else{if("wrapS"in I){var x=I.wrapS;v.parameter(x,Y),Ne=Y[x]}if("wrapT"in I){var M=I.wrapT;v.parameter(M,Y),d=Y[M]}}if(y.wrapS=Ne,y.wrapT=d,"anisotropic"in I){var w=I.anisotropic;v(typeof w=="number"&&w>=1&&w<=b.maxAnisotropic,"aniso samples must be between 1 and "),y.anisotropic=I.anisotropic}if("mipmap"in I){var T=!1;switch(typeof I.mipmap){case"string":v.parameter(I.mipmap,Q,"invalid mipmap hint"),y.mipmapHint=Q[I.mipmap],y.genMipmaps=!0,T=!0;break;case"boolean":T=y.genMipmaps=I.mipmap;break;case"object":v(Array.isArray(I.mipmap),"invalid mipmap type"),y.genMipmaps=!1,T=!0;break;default:v.raise("invalid mipmap type")}T&&!("min"in I)&&(y.minFilter=ca)}}function lr(y,I){i.texParameteri(I,mo,y.minFilter),i.texParameteri(I,ho,y.magFilter),i.texParameteri(I,lo,y.wrapS),i.texParameteri(I,oo,y.wrapT),u.ext_texture_filter_anisotropic&&i.texParameteri(I,xo,y.anisotropic),y.genMipmaps&&(i.hint(yo,y.mipmapHint),i.generateMipmap(I))}var or=0,vr={},hr=b.maxTextureUnits,tr=Array(hr).map(function(){return null});function Ie(y){q.call(this),this.mipmask=0,this.internalformat=en,this.id=or++,this.refCount=1,this.target=y,this.texture=i.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ye,N.profile&&(this.stats={size:0})}function mr(y){i.activeTexture(Pn),i.bindTexture(y.target,y.texture)}function je(){var y=tr[0];y?i.bindTexture(y.target,y.texture):i.bindTexture(Cr,null)}function Te(y){var I=y.texture;v(I,"must not double destroy texture");var C=y.unit,ye=y.target;C>=0&&(i.activeTexture(Pn+C),i.bindTexture(ye,null),tr[C]=null),i.deleteTexture(I),y.texture=null,y.params=null,y.pixels=null,y.refCount=0,delete vr[y.id],D.textureCount--}t(Ie.prototype,{bind:function(){var y=this;y.bindCount+=1;var I=y.unit;if(I<0){for(var C=0;C<hr;++C){var ye=tr[C];if(ye){if(ye.bindCount>0)continue;ye.unit=-1}tr[C]=y,I=C;break}I>=hr&&v.raise("insufficient number of texture units"),N.profile&&D.maxTextureUnits<I+1&&(D.maxTextureUnits=I+1),y.unit=I,i.activeTexture(Pn+I),i.bindTexture(y.target,y.texture)}return I},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Te(this)}});function ke(y,I){var C=new Ie(Cr);vr[C.id]=C,D.textureCount++;function ye(l,x){var M=C.texInfo;Ye.call(M);var w=ze();return typeof l=="number"?typeof x=="number"?De(w,l|0,x|0):De(w,l|0,l|0):l?(v.type(l,"object","invalid arguments to regl.texture"),sr(M,l),Be(w,l)):De(w,1,1),M.genMipmaps&&(w.mipmask=(w.width<<1)-1),C.mipmask=w.mipmask,z(C,w),v.texture2D(M,w,b),C.internalformat=w.internalformat,ye.width=w.width,ye.height=w.height,mr(C),Je(w,Cr),lr(M,Cr),je(),cr(w),N.profile&&(C.stats.size=ot(C.internalformat,C.type,w.width,w.height,M.genMipmaps,!1)),ye.format=ee[C.internalformat],ye.type=me[C.type],ye.mag=W[M.magFilter],ye.min=de[M.minFilter],ye.wrapS=ue[M.wrapS],ye.wrapT=ue[M.wrapT],ye}function Ne(l,x,M,w){v(!!l,"must specify image data");var T=x|0,A=M|0,g=w|0,h=ve();return z(h,C),h.width=0,h.height=0,le(h,l),h.width=h.width||(C.width>>g)-T,h.height=h.height||(C.height>>g)-A,v(C.type===h.type&&C.format===h.format&&C.internalformat===h.internalformat,"incompatible format for texture.subimage"),v(T>=0&&A>=0&&T+h.width<=C.width&&A+h.height<=C.height,"texture.subimage write out of bounds"),v(C.mipmask&1<<g,"missing mipmap data"),v(h.data||h.element||h.needsCopy,"missing image data"),mr(C),Fe(h,Cr,T,A,g),je(),he(h),ye}function d(l,x){var M=l|0,w=x|0||M;if(M===C.width&&w===C.height)return ye;ye.width=C.width=M,ye.height=C.height=w,mr(C);for(var T=0;C.mipmask>>T;++T){var A=M>>T,g=w>>T;if(!A||!g)break;i.texImage2D(Cr,T,C.format,A,g,0,C.format,C.type,null)}return je(),N.profile&&(C.stats.size=ot(C.internalformat,C.type,M,w,!1,!1)),ye}return ye(y,I),ye.subimage=Ne,ye.resize=d,ye._reglType="texture2d",ye._texture=C,N.profile&&(ye.stats=C.stats),ye.destroy=function(){C.decRef()},ye}function Ue(y,I,C,ye,Ne,d){var l=new Ie(Wt);vr[l.id]=l,D.cubeCount++;var x=new Array(6);function M(A,g,h,_,p,O){var L,k=l.texInfo;for(Ye.call(k),L=0;L<6;++L)x[L]=ze();if(typeof A=="number"||!A){var X=A|0||1;for(L=0;L<6;++L)De(x[L],X,X)}else if(typeof A=="object")if(g)Be(x[0],A),Be(x[1],g),Be(x[2],h),Be(x[3],_),Be(x[4],p),Be(x[5],O);else if(sr(k,A),_e(l,A),"faces"in A){var ie=A.faces;for(v(Array.isArray(ie)&&ie.length===6,"cube faces must be a length 6 array"),L=0;L<6;++L)v(typeof ie[L]=="object"&&!!ie[L],"invalid input for cube map face"),z(x[L],l),Be(x[L],ie[L])}else for(L=0;L<6;++L)Be(x[L],A);else v.raise("invalid arguments to cube map");for(z(l,x[0]),v.optional(function(){b.npotTextureCube||v(Ai(l.width)&&Ai(l.height),"your browser does not support non power or two texture dimensions")}),k.genMipmaps?l.mipmask=(x[0].width<<1)-1:l.mipmask=x[0].mipmask,v.textureCube(l,k,x,b),l.internalformat=x[0].internalformat,M.width=x[0].width,M.height=x[0].height,mr(l),L=0;L<6;++L)Je(x[L],at+L);for(lr(k,Wt),je(),N.profile&&(l.stats.size=ot(l.internalformat,l.type,M.width,M.height,k.genMipmaps,!0)),M.format=ee[l.internalformat],M.type=me[l.type],M.mag=W[k.magFilter],M.min=de[k.minFilter],M.wrapS=ue[k.wrapS],M.wrapT=ue[k.wrapT],L=0;L<6;++L)cr(x[L]);return M}function w(A,g,h,_,p){v(!!g,"must specify image data"),v(typeof A=="number"&&A===(A|0)&&A>=0&&A<6,"invalid face");var O=h|0,L=_|0,k=p|0,X=ve();return z(X,l),X.width=0,X.height=0,le(X,g),X.width=X.width||(l.width>>k)-O,X.height=X.height||(l.height>>k)-L,v(l.type===X.type&&l.format===X.format&&l.internalformat===X.internalformat,"incompatible format for texture.subimage"),v(O>=0&&L>=0&&O+X.width<=l.width&&L+X.height<=l.height,"texture.subimage write out of bounds"),v(l.mipmask&1<<k,"missing mipmap data"),v(X.data||X.element||X.needsCopy,"missing image data"),mr(l),Fe(X,at+A,O,L,k),je(),he(X),M}function T(A){var g=A|0;if(g!==l.width){M.width=l.width=g,M.height=l.height=g,mr(l);for(var h=0;h<6;++h)for(var _=0;l.mipmask>>_;++_)i.texImage2D(at+h,_,l.format,g>>_,g>>_,0,l.format,l.type,null);return je(),N.profile&&(l.stats.size=ot(l.internalformat,l.type,M.width,M.height,!1,!0)),M}}return M(y,I,C,ye,Ne,d),M.subimage=w,M.resize=T,M._reglType="textureCube",M._texture=l,N.profile&&(M.stats=l.stats),M.destroy=function(){l.decRef()},M}function ar(){for(var y=0;y<hr;++y)i.activeTexture(Pn+y),i.bindTexture(Cr,null),tr[y]=null;gr(vr).forEach(Te),D.cubeCount=0,D.textureCount=0}N.profile&&(D.getTotalTextureSize=function(){var y=0;return Object.keys(vr).forEach(function(I){y+=vr[I].stats.size}),y});function Fr(){for(var y=0;y<hr;++y){var I=tr[y];I&&(I.bindCount=0,I.unit=-1,tr[y]=null)}gr(vr).forEach(function(C){C.texture=i.createTexture(),i.bindTexture(C.target,C.texture);for(var ye=0;ye<32;++ye)if(C.mipmask&1<<ye)if(C.target===Cr)i.texImage2D(Cr,ye,C.internalformat,C.width>>ye,C.height>>ye,0,C.internalformat,C.type,null);else for(var Ne=0;Ne<6;++Ne)i.texImage2D(at+Ne,ye,C.internalformat,C.width>>ye,C.height>>ye,0,C.internalformat,C.type,null);lr(C.texInfo,C.target)})}function ln(){for(var y=0;y<hr;++y){var I=tr[y];I&&(I.bindCount=0,I.unit=-1,tr[y]=null),i.activeTexture(Pn+y),i.bindTexture(Cr,null),i.bindTexture(Wt,null)}}return{create2D:ke,createCube:Ue,clear:ar,getTexture:function(y){return null},restore:Fr,refresh:ln}}var Ur=36161,ut=32854,Yi=32855,Qi=36194,Ki=33189,Zi=36168,Ji=34041,ef=35907,rf=34836,nf=34842,tf=34843,Rr=[];Rr[ut]=2,Rr[Yi]=2,Rr[Qi]=2,Rr[Ki]=2,Rr[Zi]=1,Rr[Ji]=4,Rr[ef]=4,Rr[rf]=16,Rr[nf]=8,Rr[tf]=6;function af(i,u,b){return Rr[i]*u*b}var Do=function(i,u,b,P,U){var D={rgba4:ut,rgb565:Qi,"rgb5 a1":Yi,depth:Ki,stencil:Zi,"depth stencil":Ji};u.ext_srgb&&(D.srgba=ef),u.ext_color_buffer_half_float&&(D.rgba16f=nf,D.rgb16f=tf),u.webgl_color_buffer_float&&(D.rgba32f=rf);var N=[];Object.keys(D).forEach(function(Z){var re=D[Z];N[re]=Z});var Q=0,Y={};function ne(Z){this.id=Q++,this.refCount=1,this.renderbuffer=Z,this.format=ut,this.width=0,this.height=0,U.profile&&(this.stats={size:0})}ne.prototype.decRef=function(){--this.refCount<=0&&ae(this)};function ae(Z){var re=Z.renderbuffer;v(re,"must not double destroy renderbuffer"),i.bindRenderbuffer(Ur,null),i.deleteRenderbuffer(re),Z.renderbuffer=null,Z.refCount=0,delete Y[Z.id],P.renderbufferCount--}function te(Z,re){var S=new ne(i.createRenderbuffer());Y[S.id]=S,P.renderbufferCount++;function $(me,W){var de=0,ue=0,Ae=ut;if(typeof me=="object"&&me){var q=me;if("shape"in q){var z=q.shape;v(Array.isArray(z)&&z.length>=2,"invalid renderbuffer shape"),de=z[0]|0,ue=z[1]|0}else"radius"in q&&(de=ue=q.radius|0),"width"in q&&(de=q.width|0),"height"in q&&(ue=q.height|0);"format"in q&&(v.parameter(q.format,D,"invalid renderbuffer format"),Ae=D[q.format])}else typeof me=="number"?(de=me|0,typeof W=="number"?ue=W|0:ue=de):me?v.raise("invalid arguments to renderbuffer constructor"):de=ue=1;if(v(de>0&&ue>0&&de<=b.maxRenderbufferSize&&ue<=b.maxRenderbufferSize,"invalid renderbuffer size"),!(de===S.width&&ue===S.height&&Ae===S.format))return $.width=S.width=de,$.height=S.height=ue,S.format=Ae,i.bindRenderbuffer(Ur,S.renderbuffer),i.renderbufferStorage(Ur,Ae,de,ue),v(i.getError()===0,"invalid render buffer format"),U.profile&&(S.stats.size=af(S.format,S.width,S.height)),$.format=N[S.format],$}function ee(me,W){var de=me|0,ue=W|0||de;return de===S.width&&ue===S.height||(v(de>0&&ue>0&&de<=b.maxRenderbufferSize&&ue<=b.maxRenderbufferSize,"invalid renderbuffer size"),$.width=S.width=de,$.height=S.height=ue,i.bindRenderbuffer(Ur,S.renderbuffer),i.renderbufferStorage(Ur,S.format,de,ue),v(i.getError()===0,"invalid render buffer format"),U.profile&&(S.stats.size=af(S.format,S.width,S.height))),$}return $(Z,re),$.resize=ee,$._reglType="renderbuffer",$._renderbuffer=S,U.profile&&($.stats=S.stats),$.destroy=function(){S.decRef()},$}U.profile&&(P.getTotalRenderbufferSize=function(){var Z=0;return Object.keys(Y).forEach(function(re){Z+=Y[re].stats.size}),Z});function se(){gr(Y).forEach(function(Z){Z.renderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(Ur,Z.renderbuffer),i.renderbufferStorage(Ur,Z.format,Z.width,Z.height)}),i.bindRenderbuffer(Ur,null)}return{create:te,clear:function(){gr(Y).forEach(ae)},restore:se}},Pr=36160,ua=36161,nn=3553,vt=34069,ff=36064,sf=36096,cf=36128,lf=33306,of=36053,Po=36054,Io=36055,$o=36057,No=36061,Bo=36193,ko=5121,zo=5126,uf=6407,vf=6408,Uo=6402,Vo=[uf,vf],va=[];va[vf]=4,va[uf]=3;var dt=[];dt[ko]=1,dt[zo]=4,dt[Bo]=2;var jo=32854,qo=32855,Xo=36194,Ho=33189,Wo=36168,df=34041,Yo=35907,Qo=34836,Ko=34842,Zo=34843,Jo=[jo,qo,Xo,Yo,Ko,Zo,Qo],xn={};xn[of]="complete",xn[Po]="incomplete attachment",xn[$o]="incomplete dimensions",xn[Io]="incomplete, missing attachment",xn[No]="unsupported";function e0(i,u,b,P,U,D){var N={cur:null,next:null,dirty:!1,setFBO:null},Q=["rgba"],Y=["rgba4","rgb565","rgb5 a1"];u.ext_srgb&&Y.push("srgba"),u.ext_color_buffer_half_float&&Y.push("rgba16f","rgb16f"),u.webgl_color_buffer_float&&Y.push("rgba32f");var ne=["uint8"];u.oes_texture_half_float&&ne.push("half float","float16"),u.oes_texture_float&&ne.push("float","float32");function ae(J,le,oe){this.target=J,this.texture=le,this.renderbuffer=oe;var Fe=0,Le=0;le?(Fe=le.width,Le=le.height):oe&&(Fe=oe.width,Le=oe.height),this.width=Fe,this.height=Le}function te(J){J&&(J.texture&&J.texture._texture.decRef(),J.renderbuffer&&J.renderbuffer._renderbuffer.decRef())}function se(J,le,oe){if(J)if(J.texture){var Fe=J.texture._texture,Le=Math.max(1,Fe.width),ve=Math.max(1,Fe.height);v(Le===le&&ve===oe,"inconsistent width/height for supplied texture"),Fe.refCount+=1}else{var he=J.renderbuffer._renderbuffer;v(he.width===le&&he.height===oe,"inconsistent width/height for renderbuffer"),he.refCount+=1}}function Z(J,le){le&&(le.texture?i.framebufferTexture2D(Pr,J,le.target,le.texture._texture.texture,0):i.framebufferRenderbuffer(Pr,J,ua,le.renderbuffer._renderbuffer.renderbuffer))}function re(J){var le=nn,oe=null,Fe=null,Le=J;typeof J=="object"&&(Le=J.data,"target"in J&&(le=J.target|0)),v.type(Le,"function","invalid attachment data");var ve=Le._reglType;return ve==="texture2d"?(oe=Le,v(le===nn)):ve==="textureCube"?(oe=Le,v(le>=vt&&le<vt+6,"invalid cube map target")):ve==="renderbuffer"?(Fe=Le,le=ua):v.raise("invalid regl object for attachment"),new ae(le,oe,Fe)}function S(J,le,oe,Fe,Le){if(oe){var ve=P.create2D({width:J,height:le,format:Fe,type:Le});return ve._texture.refCount=0,new ae(nn,ve,null)}else{var he=U.create({width:J,height:le,format:Fe});return he._renderbuffer.refCount=0,new ae(ua,null,he)}}function $(J){return J&&(J.texture||J.renderbuffer)}function ee(J,le,oe){J&&(J.texture?J.texture.resize(le,oe):J.renderbuffer&&J.renderbuffer.resize(le,oe),J.width=le,J.height=oe)}var me=0,W={};function de(){this.id=me++,W[this.id]=this,this.framebuffer=i.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function ue(J){J.colorAttachments.forEach(te),te(J.depthAttachment),te(J.stencilAttachment),te(J.depthStencilAttachment)}function Ae(J){var le=J.framebuffer;v(le,"must not double destroy framebuffer"),i.deleteFramebuffer(le),J.framebuffer=null,D.framebufferCount--,delete W[J.id]}function q(J){var le;i.bindFramebuffer(Pr,J.framebuffer);var oe=J.colorAttachments;for(le=0;le<oe.length;++le)Z(ff+le,oe[le]);for(le=oe.length;le<b.maxColorAttachments;++le)i.framebufferTexture2D(Pr,ff+le,nn,null,0);i.framebufferTexture2D(Pr,lf,nn,null,0),i.framebufferTexture2D(Pr,sf,nn,null,0),i.framebufferTexture2D(Pr,cf,nn,null,0),Z(sf,J.depthAttachment),Z(cf,J.stencilAttachment),Z(lf,J.depthStencilAttachment);var Fe=i.checkFramebufferStatus(Pr);!i.isContextLost()&&Fe!==of&&v.raise("framebuffer configuration not supported, status = "+xn[Fe]),i.bindFramebuffer(Pr,N.next?N.next.framebuffer:null),N.cur=N.next,i.getError()}function z(J,le){var oe=new de;D.framebufferCount++;function Fe(ve,he){var Me;v(N.next!==oe,"can not update framebuffer which is currently in use");var De=0,Be=0,Je=!0,nr=!0,ze=null,cr=!0,Ye="rgba",sr="uint8",lr=1,or=null,vr=null,hr=null,tr=!1;if(typeof ve=="number")De=ve|0,Be=he|0||De;else if(!ve)De=Be=1;else{v.type(ve,"object","invalid arguments for framebuffer");var Ie=ve;if("shape"in Ie){var mr=Ie.shape;v(Array.isArray(mr)&&mr.length>=2,"invalid shape for framebuffer"),De=mr[0],Be=mr[1]}else"radius"in Ie&&(De=Be=Ie.radius),"width"in Ie&&(De=Ie.width),"height"in Ie&&(Be=Ie.height);("color"in Ie||"colors"in Ie)&&(ze=Ie.color||Ie.colors,Array.isArray(ze)&&v(ze.length===1||u.webgl_draw_buffers,"multiple render targets not supported")),ze||("colorCount"in Ie&&(lr=Ie.colorCount|0,v(lr>0,"invalid color buffer count")),"colorTexture"in Ie&&(cr=!!Ie.colorTexture,Ye="rgba4"),"colorType"in Ie&&(sr=Ie.colorType,cr?(v(u.oes_texture_float||!(sr==="float"||sr==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),v(u.oes_texture_half_float||!(sr==="half float"||sr==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):sr==="half float"||sr==="float16"?(v(u.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ye="rgba16f"):(sr==="float"||sr==="float32")&&(v(u.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ye="rgba32f"),v.oneOf(sr,ne,"invalid color type")),"colorFormat"in Ie&&(Ye=Ie.colorFormat,Q.indexOf(Ye)>=0?cr=!0:Y.indexOf(Ye)>=0?cr=!1:v.optional(function(){cr?v.oneOf(Ie.colorFormat,Q,"invalid color format for texture"):v.oneOf(Ie.colorFormat,Y,"invalid color format for renderbuffer")}))),("depthTexture"in Ie||"depthStencilTexture"in Ie)&&(tr=!!(Ie.depthTexture||Ie.depthStencilTexture),v(!tr||u.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Ie&&(typeof Ie.depth=="boolean"?Je=Ie.depth:(or=Ie.depth,nr=!1)),"stencil"in Ie&&(typeof Ie.stencil=="boolean"?nr=Ie.stencil:(vr=Ie.stencil,Je=!1)),"depthStencil"in Ie&&(typeof Ie.depthStencil=="boolean"?Je=nr=Ie.depthStencil:(hr=Ie.depthStencil,Je=!1,nr=!1))}var je=null,Te=null,ke=null,Ue=null;if(Array.isArray(ze))je=ze.map(re);else if(ze)je=[re(ze)];else for(je=new Array(lr),Me=0;Me<lr;++Me)je[Me]=S(De,Be,cr,Ye,sr);v(u.webgl_draw_buffers||je.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),v(je.length<=b.maxColorAttachments,"too many color attachments, not supported"),De=De||je[0].width,Be=Be||je[0].height,or?Te=re(or):Je&&!nr&&(Te=S(De,Be,tr,"depth","uint32")),vr?ke=re(vr):nr&&!Je&&(ke=S(De,Be,!1,"stencil","uint8")),hr?Ue=re(hr):!or&&!vr&&nr&&Je&&(Ue=S(De,Be,tr,"depth stencil","depth stencil")),v(!!or+!!vr+!!hr<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var ar=null;for(Me=0;Me<je.length;++Me)if(se(je[Me],De,Be),v(!je[Me]||je[Me].texture&&Vo.indexOf(je[Me].texture._texture.format)>=0||je[Me].renderbuffer&&Jo.indexOf(je[Me].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Me+" is invalid"),je[Me]&&je[Me].texture){var Fr=va[je[Me].texture._texture.format]*dt[je[Me].texture._texture.type];ar===null?ar=Fr:v(ar===Fr,"all color attachments much have the same number of bits per pixel.")}return se(Te,De,Be),v(!Te||Te.texture&&Te.texture._texture.format===Uo||Te.renderbuffer&&Te.renderbuffer._renderbuffer.format===Ho,"invalid depth attachment for framebuffer object"),se(ke,De,Be),v(!ke||ke.renderbuffer&&ke.renderbuffer._renderbuffer.format===Wo,"invalid stencil attachment for framebuffer object"),se(Ue,De,Be),v(!Ue||Ue.texture&&Ue.texture._texture.format===df||Ue.renderbuffer&&Ue.renderbuffer._renderbuffer.format===df,"invalid depth-stencil attachment for framebuffer object"),ue(oe),oe.width=De,oe.height=Be,oe.colorAttachments=je,oe.depthAttachment=Te,oe.stencilAttachment=ke,oe.depthStencilAttachment=Ue,Fe.color=je.map($),Fe.depth=$(Te),Fe.stencil=$(ke),Fe.depthStencil=$(Ue),Fe.width=oe.width,Fe.height=oe.height,q(oe),Fe}function Le(ve,he){v(N.next!==oe,"can not resize a framebuffer which is currently in use");var Me=Math.max(ve|0,1),De=Math.max(he|0||Me,1);if(Me===oe.width&&De===oe.height)return Fe;for(var Be=oe.colorAttachments,Je=0;Je<Be.length;++Je)ee(Be[Je],Me,De);return ee(oe.depthAttachment,Me,De),ee(oe.stencilAttachment,Me,De),ee(oe.depthStencilAttachment,Me,De),oe.width=Fe.width=Me,oe.height=Fe.height=De,q(oe),Fe}return Fe(J,le),t(Fe,{resize:Le,_reglType:"framebuffer",_framebuffer:oe,destroy:function(){Ae(oe),ue(oe)},use:function(ve){N.setFBO({framebuffer:Fe},ve)}})}function _e(J){var le=Array(6);function oe(Le){var ve;v(le.indexOf(N.next)<0,"can not update framebuffer which is currently in use");var he={color:null},Me=0,De=null,Be="rgba",Je="uint8",nr=1;if(typeof Le=="number")Me=Le|0;else if(!Le)Me=1;else{v.type(Le,"object","invalid arguments for framebuffer");var ze=Le;if("shape"in ze){var cr=ze.shape;v(Array.isArray(cr)&&cr.length>=2,"invalid shape for framebuffer"),v(cr[0]===cr[1],"cube framebuffer must be square"),Me=cr[0]}else"radius"in ze&&(Me=ze.radius|0),"width"in ze?(Me=ze.width|0,"height"in ze&&v(ze.height===Me,"must be square")):"height"in ze&&(Me=ze.height|0);("color"in ze||"colors"in ze)&&(De=ze.color||ze.colors,Array.isArray(De)&&v(De.length===1||u.webgl_draw_buffers,"multiple render targets not supported")),De||("colorCount"in ze&&(nr=ze.colorCount|0,v(nr>0,"invalid color buffer count")),"colorType"in ze&&(v.oneOf(ze.colorType,ne,"invalid color type"),Je=ze.colorType),"colorFormat"in ze&&(Be=ze.colorFormat,v.oneOf(ze.colorFormat,Q,"invalid color format for texture"))),"depth"in ze&&(he.depth=ze.depth),"stencil"in ze&&(he.stencil=ze.stencil),"depthStencil"in ze&&(he.depthStencil=ze.depthStencil)}var Ye;if(De)if(Array.isArray(De))for(Ye=[],ve=0;ve<De.length;++ve)Ye[ve]=De[ve];else Ye=[De];else{Ye=Array(nr);var sr={radius:Me,format:Be,type:Je};for(ve=0;ve<nr;++ve)Ye[ve]=P.createCube(sr)}for(he.color=Array(Ye.length),ve=0;ve<Ye.length;++ve){var lr=Ye[ve];v(typeof lr=="function"&&lr._reglType==="textureCube","invalid cube map"),Me=Me||lr.width,v(lr.width===Me&&lr.height===Me,"invalid cube map shape"),he.color[ve]={target:vt,data:Ye[ve]}}for(ve=0;ve<6;++ve){for(var or=0;or<Ye.length;++or)he.color[or].target=vt+ve;ve>0&&(he.depth=le[0].depth,he.stencil=le[0].stencil,he.depthStencil=le[0].depthStencil),le[ve]?le[ve](he):le[ve]=z(he)}return t(oe,{width:Me,height:Me,color:Ye})}function Fe(Le){var ve,he=Le|0;if(v(he>0&&he<=b.maxCubeMapSize,"invalid radius for cube fbo"),he===oe.width)return oe;var Me=oe.color;for(ve=0;ve<Me.length;++ve)Me[ve].resize(he);for(ve=0;ve<6;++ve)le[ve].resize(he);return oe.width=oe.height=he,oe}return oe(J),t(oe,{faces:le,resize:Fe,_reglType:"framebufferCube",destroy:function(){le.forEach(function(Le){Le.destroy()})}})}function ce(){N.cur=null,N.next=null,N.dirty=!0,gr(W).forEach(function(J){J.framebuffer=i.createFramebuffer(),q(J)})}return t(N,{getFramebuffer:function(J){if(typeof J=="function"&&J._reglType==="framebuffer"){var le=J._framebuffer;if(le instanceof de)return le}return null},create:z,createCube:_e,clear:function(){gr(W).forEach(Ae)},restore:ce})}var r0=5126,hf=34962,ht=34963,mf=["attributes","elements","offset","count","primitive","instances"];function da(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=r0,this.offset=0,this.stride=0,this.divisor=0}function n0(i,u,b,P,U,D,N){for(var Q=b.maxAttributes,Y=new Array(Q),ne=0;ne<Q;++ne)Y[ne]=new da;var ae=0,te={},se={Record:da,scope:{},state:Y,currentVAO:null,targetVAO:null,restore:re()?ue:function(){},createVAO:Ae,getVAO:$,destroyBuffer:Z,setVAO:re()?ee:me,clear:re()?W:function(){}};function Z(q){for(var z=0;z<Y.length;++z){var _e=Y[z];_e.buffer===q&&(i.disableVertexAttribArray(z),_e.buffer=null)}}function re(){return u.oes_vertex_array_object}function S(){return u.angle_instanced_arrays}function $(q){return typeof q=="function"&&q._vao?q._vao:null}function ee(q){if(q!==se.currentVAO){var z=re();q?z.bindVertexArrayOES(q.vao):z.bindVertexArrayOES(null),se.currentVAO=q}}function me(q){if(q!==se.currentVAO){if(q)q.bindAttrs();else{for(var z=S(),_e=0;_e<Y.length;++_e){var ce=Y[_e];ce.buffer?(i.enableVertexAttribArray(_e),ce.buffer.bind(),i.vertexAttribPointer(_e,ce.size,ce.type,ce.normalized,ce.stride,ce.offfset),z&&ce.divisor&&z.vertexAttribDivisorANGLE(_e,ce.divisor)):(i.disableVertexAttribArray(_e),i.vertexAttrib4f(_e,ce.x,ce.y,ce.z,ce.w))}N.elements?i.bindBuffer(ht,N.elements.buffer.buffer):i.bindBuffer(ht,null)}se.currentVAO=q}}function W(){gr(te).forEach(function(q){q.destroy()})}function de(){this.id=++ae,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var q=re();q?this.vao=q.createVertexArrayOES():this.vao=null,te[this.id]=this,this.buffers=[]}de.prototype.bindAttrs=function(){for(var q=S(),z=this.attributes,_e=0;_e<z.length;++_e){var ce=z[_e];ce.buffer?(i.enableVertexAttribArray(_e),i.bindBuffer(hf,ce.buffer.buffer),i.vertexAttribPointer(_e,ce.size,ce.type,ce.normalized,ce.stride,ce.offset),q&&ce.divisor&&q.vertexAttribDivisorANGLE(_e,ce.divisor)):(i.disableVertexAttribArray(_e),i.vertexAttrib4f(_e,ce.x,ce.y,ce.z,ce.w))}for(var J=z.length;J<Q;++J)i.disableVertexAttribArray(J);var le=D.getElements(this.elements);le?i.bindBuffer(ht,le.buffer.buffer):i.bindBuffer(ht,null)},de.prototype.refresh=function(){var q=re();q&&(q.bindVertexArrayOES(this.vao),this.bindAttrs(),se.currentVAO=null,q.bindVertexArrayOES(null))},de.prototype.destroy=function(){if(this.vao){var q=re();this===se.currentVAO&&(se.currentVAO=null,q.bindVertexArrayOES(null)),q.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),te[this.id]&&(delete te[this.id],P.vaoCount-=1)};function ue(){var q=re();q&&gr(te).forEach(function(z){z.refresh()})}function Ae(q){var z=new de;P.vaoCount+=1;function _e(ce){var J;if(Array.isArray(ce))J=ce,z.elements&&z.ownsElements&&z.elements.destroy(),z.elements=null,z.ownsElements=!1,z.offset=0,z.count=0,z.instances=-1,z.primitive=4;else{if(v(typeof ce=="object","invalid arguments for create vao"),v("attributes"in ce,"must specify attributes for vao"),ce.elements){var le=ce.elements;z.ownsElements?typeof le=="function"&&le._reglType==="elements"?(z.elements.destroy(),z.ownsElements=!1):(z.elements(le),z.ownsElements=!1):D.getElements(ce.elements)?(z.elements=ce.elements,z.ownsElements=!1):(z.elements=D.create(ce.elements),z.ownsElements=!0)}else z.elements=null,z.ownsElements=!1;J=ce.attributes,z.offset=0,z.count=-1,z.instances=-1,z.primitive=4,z.elements&&(z.count=z.elements._elements.vertCount,z.primitive=z.elements._elements.primType),"offset"in ce&&(z.offset=ce.offset|0),"count"in ce&&(z.count=ce.count|0),"instances"in ce&&(z.instances=ce.instances|0),"primitive"in ce&&(v(ce.primitive in zr,"bad primitive type: "+ce.primitive),z.primitive=zr[ce.primitive]),v.optional(()=>{for(var Je=Object.keys(ce),nr=0;nr<Je.length;++nr)v(mf.indexOf(Je[nr])>=0,'invalid option for vao: "'+Je[nr]+'" valid options are '+mf)}),v(Array.isArray(J),"attributes must be an array")}v(J.length<Q,"too many attributes"),v(J.length>0,"must specify at least one attribute");var oe={},Fe=z.attributes;Fe.length=J.length;for(var Le=0;Le<J.length;++Le){var ve=J[Le],he=Fe[Le]=new da,Me=ve.data||ve;if(Array.isArray(Me)||n(Me)||Lr(Me)){var De;z.buffers[Le]&&(De=z.buffers[Le],n(Me)&&De._buffer.byteLength>=Me.byteLength?De.subdata(Me):(De.destroy(),z.buffers[Le]=null)),z.buffers[Le]||(De=z.buffers[Le]=U.create(ve,hf,!1,!0)),he.buffer=U.getBuffer(De),he.size=he.buffer.dimension|0,he.normalized=!1,he.type=he.buffer.dtype,he.offset=0,he.stride=0,he.divisor=0,he.state=1,oe[Le]=1}else U.getBuffer(ve)?(he.buffer=U.getBuffer(ve),he.size=he.buffer.dimension|0,he.normalized=!1,he.type=he.buffer.dtype,he.offset=0,he.stride=0,he.divisor=0,he.state=1):U.getBuffer(ve.buffer)?(he.buffer=U.getBuffer(ve.buffer),he.size=(+ve.size||he.buffer.dimension)|0,he.normalized=!!ve.normalized||!1,"type"in ve?(v.parameter(ve.type,Zr,"invalid buffer type"),he.type=Zr[ve.type]):he.type=he.buffer.dtype,he.offset=(ve.offset||0)|0,he.stride=(ve.stride||0)|0,he.divisor=(ve.divisor||0)|0,he.state=1,v(he.size>=1&&he.size<=4,"size must be between 1 and 4"),v(he.offset>=0,"invalid offset"),v(he.stride>=0&&he.stride<=255,"stride must be between 0 and 255"),v(he.divisor>=0,"divisor must be positive"),v(!he.divisor||!!u.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in ve?(v(Le>0,"first attribute must not be a constant"),he.x=+ve.x||0,he.y=+ve.y||0,he.z=+ve.z||0,he.w=+ve.w||0,he.state=2):v(!1,"invalid attribute spec for location "+Le)}for(var Be=0;Be<z.buffers.length;++Be)!oe[Be]&&z.buffers[Be]&&(z.buffers[Be].destroy(),z.buffers[Be]=null);return z.refresh(),_e}return _e.destroy=function(){for(var ce=0;ce<z.buffers.length;++ce)z.buffers[ce]&&z.buffers[ce].destroy();z.buffers.length=0,z.ownsElements&&(z.elements.destroy(),z.elements=null,z.ownsElements=!1),z.destroy()},_e._vao=z,_e._reglType="vao",_e(q)}return se}var pf=35632,t0=35633,a0=35718,i0=35721;function f0(i,u,b,P){var U={},D={};function N(S,$,ee,me){this.name=S,this.id=$,this.location=ee,this.info=me}function Q(S,$){for(var ee=0;ee<S.length;++ee)if(S[ee].id===$.id){S[ee].location=$.location;return}S.push($)}function Y(S,$,ee){var me=S===pf?U:D,W=me[$];if(!W){var de=u.str($);W=i.createShader(S),i.shaderSource(W,de),i.compileShader(W),v.shaderError(i,W,de,S,ee),me[$]=W}return W}var ne={},ae=[],te=0;function se(S,$){this.id=te++,this.fragId=S,this.vertId=$,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,P.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Z(S,$,ee){var me,W,de=Y(pf,S.fragId),ue=Y(t0,S.vertId),Ae=S.program=i.createProgram();if(i.attachShader(Ae,de),i.attachShader(Ae,ue),ee)for(me=0;me<ee.length;++me){var q=ee[me];i.bindAttribLocation(Ae,q[0],q[1])}i.linkProgram(Ae),v.linkError(i,Ae,u.str(S.fragId),u.str(S.vertId),$);var z=i.getProgramParameter(Ae,a0);P.profile&&(S.stats.uniformsCount=z);var _e=S.uniforms;for(me=0;me<z;++me)if(W=i.getActiveUniform(Ae,me),W){if(W.size>1)for(var ce=0;ce<W.size;++ce){var J=W.name.replace("[0]","["+ce+"]");Q(_e,new N(J,u.id(J),i.getUniformLocation(Ae,J),W))}var le=W.name;W.size>1&&(le=le.replace("[0]","")),Q(_e,new N(le,u.id(le),i.getUniformLocation(Ae,le),W))}var oe=i.getProgramParameter(Ae,i0);P.profile&&(S.stats.attributesCount=oe);var Fe=S.attributes;for(me=0;me<oe;++me)W=i.getActiveAttrib(Ae,me),W&&Q(Fe,new N(W.name,u.id(W.name),i.getAttribLocation(Ae,W.name),W))}P.profile&&(b.getMaxUniformsCount=function(){var S=0;return ae.forEach(function($){$.stats.uniformsCount>S&&(S=$.stats.uniformsCount)}),S},b.getMaxAttributesCount=function(){var S=0;return ae.forEach(function($){$.stats.attributesCount>S&&(S=$.stats.attributesCount)}),S});function re(){U={},D={};for(var S=0;S<ae.length;++S)Z(ae[S],null,ae[S].attributes.map(function($){return[$.location,$.name]}))}return{clear:function(){var S=i.deleteShader.bind(i);gr(U).forEach(S),U={},gr(D).forEach(S),D={},ae.forEach(function($){i.deleteProgram($.program)}),ae.length=0,ne={},b.shaderCount=0},program:function(S,$,ee,me){v.command(S>=0,"missing vertex shader",ee),v.command($>=0,"missing fragment shader",ee);var W=ne[$];W||(W=ne[$]={});var de=W[S];if(de&&(de.refCount++,!me))return de;var ue=new se($,S);return b.shaderCount++,Z(ue,ee,me),de||(W[S]=ue),ae.push(ue),t(ue,{destroy:function(){if(ue.refCount--,ue.refCount<=0){i.deleteProgram(ue.program);var Ae=ae.indexOf(ue);ae.splice(Ae,1),b.shaderCount--}W[ue.vertId].refCount<=0&&(i.deleteShader(D[ue.vertId]),delete D[ue.vertId],delete ne[ue.fragId][ue.vertId]),Object.keys(ne[ue.fragId]).length||(i.deleteShader(U[ue.fragId]),delete U[ue.fragId],delete ne[ue.fragId])}})},restore:re,shader:Y,frag:-1,vert:-1}}var s0=6408,In=5121,c0=3333,mt=5126;function l0(i,u,b,P,U,D,N){function Q(ae){var te;u.next===null?(v(U.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),te=In):(v(u.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),te=u.next.colorAttachments[0].texture._texture.type,v.optional(function(){D.oes_texture_float?(v(te===In||te===mt,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),te===mt&&v(N.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):v(te===In,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var se=0,Z=0,re=P.framebufferWidth,S=P.framebufferHeight,$=null;n(ae)?$=ae:ae&&(v.type(ae,"object","invalid arguments to regl.read()"),se=ae.x|0,Z=ae.y|0,v(se>=0&&se<P.framebufferWidth,"invalid x offset for regl.read"),v(Z>=0&&Z<P.framebufferHeight,"invalid y offset for regl.read"),re=(ae.width||P.framebufferWidth-se)|0,S=(ae.height||P.framebufferHeight-Z)|0,$=ae.data||null),$&&(te===In?v($ instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):te===mt&&v($ instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),v(re>0&&re+se<=P.framebufferWidth,"invalid width for read pixels"),v(S>0&&S+Z<=P.framebufferHeight,"invalid height for read pixels"),b();var ee=re*S*4;return $||(te===In?$=new Uint8Array(ee):te===mt&&($=$||new Float32Array(ee))),v.isTypedArray($,"data buffer for regl.read() must be a typedarray"),v($.byteLength>=ee,"data buffer for regl.read() too small"),i.pixelStorei(c0,4),i.readPixels(se,Z,re,S,s0,te,$),$}function Y(ae){var te;return u.setFBO({framebuffer:ae.framebuffer},function(){te=Q(ae)}),te}function ne(ae){return!ae||!("framebuffer"in ae)?Q(ae):Y(ae)}return ne}function En(i){return Array.prototype.slice.call(i)}function An(i){return En(i).join("")}function o0(){var i=0,u=[],b=[];function P(te){for(var se=0;se<b.length;++se)if(b[se]===te)return u[se];var Z="g"+i++;return u.push(Z),b.push(te),Z}function U(){var te=[];function se(){te.push.apply(te,En(arguments))}var Z=[];function re(){var S="v"+i++;return Z.push(S),arguments.length>0&&(te.push(S,"="),te.push.apply(te,En(arguments)),te.push(";")),S}return t(se,{def:re,toString:function(){return An([Z.length>0?"var "+Z.join(",")+";":"",An(te)])}})}function D(){var te=U(),se=U(),Z=te.toString,re=se.toString;function S($,ee){se($,ee,"=",te.def($,ee),";")}return t(function(){te.apply(te,En(arguments))},{def:te.def,entry:te,exit:se,save:S,set:function($,ee,me){S($,ee),te($,ee,"=",me,";")},toString:function(){return Z()+re()}})}function N(){var te=An(arguments),se=D(),Z=D(),re=se.toString,S=Z.toString;return t(se,{then:function(){return se.apply(se,En(arguments)),this},else:function(){return Z.apply(Z,En(arguments)),this},toString:function(){var $=S();return $&&($="else{"+$+"}"),An(["if(",te,"){",re(),"}",$])}})}var Q=U(),Y={};function ne(te,se){var Z=[];function re(){var W="a"+Z.length;return Z.push(W),W}se=se||0;for(var S=0;S<se;++S)re();var $=D(),ee=$.toString,me=Y[te]=t($,{arg:re,toString:function(){return An(["function(",Z.join(),"){",ee(),"}"])}});return me}function ae(){var te=['"use strict";',Q,"return {"];Object.keys(Y).forEach(function(re){te.push('"',re,'":',Y[re].toString(),",")}),te.push("}");var se=An(te).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Z=Function.apply(null,u.concat(se));return Z.apply(null,b)}return{global:Q,link:P,block:U,proc:ne,scope:D,cond:N,compile:ae}}var Tn="xyzw".split(""),yf=5121,gn=1,ha=2,ma=0,pa=1,ya=2,_a=3,pt=4,_f=5,bf=6,xf="dither",Ef="blend.enable",Af="blend.color",ba="blend.equation",xa="blend.func",Tf="depth.enable",gf="depth.func",Mf="depth.range",Sf="depth.mask",Ea="colorMask",wf="cull.enable",Lf="cull.face",Aa="frontFace",Ta="lineWidth",Rf="polygonOffset.enable",ga="polygonOffset.offset",Of="sample.alpha",Cf="sample.enable",Ma="sample.coverage",Gf="stencil.enable",Ff="stencil.mask",Sa="stencil.func",wa="stencil.opFront",$n="stencil.opBack",Df="scissor.enable",yt="scissor.box",Ir="viewport",Nn="profile",tn="framebuffer",Bn="vert",kn="frag",an="elements",fn="primitive",sn="count",_t="offset",bt="instances",zn="vao",La="Width",Ra="Height",Mn=tn+La,Sn=tn+Ra,u0=Ir+La,v0=Ir+Ra,Pf="drawingBuffer",If=Pf+La,$f=Pf+Ra,d0=[xa,ba,Sa,wa,$n,Ma,Ir,yt,ga],wn=34962,Oa=34963,h0=35632,m0=35633,Nf=3553,p0=34067,y0=2884,_0=3042,b0=3024,x0=2960,E0=2929,A0=3089,T0=32823,g0=32926,M0=32928,Ca=5126,xt=35664,Et=35665,At=35666,Ga=5124,Tt=35667,gt=35668,Mt=35669,Fa=35670,St=35671,wt=35672,Lt=35673,Un=35674,Vn=35675,jn=35676,qn=35678,Xn=35680,Da=4,Hn=1028,cn=1029,Bf=2304,Pa=2305,S0=32775,w0=32776,L0=519,Vr=7680,kf=0,zf=1,Uf=32774,R0=513,Vf=36160,O0=36064,Gr={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},jf=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Ln={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},jr={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},qf={frag:h0,vert:m0},Ia={cw:Bf,ccw:Pa};function Rt(i){return Array.isArray(i)||n(i)||Lr(i)}function Xf(i){return i.sort(function(u,b){return u===Ir?-1:b===Ir?1:u<b?-1:1})}function ur(i,u,b,P){this.thisDep=i,this.contextDep=u,this.propDep=b,this.append=P}function qr(i){return i&&!(i.thisDep||i.contextDep||i.propDep)}function fr(i){return new ur(!1,!1,!1,i)}function _r(i,u){var b=i.type;if(b===ma){var P=i.data.length;return new ur(!0,P>=1,P>=2,u)}else if(b===pt){var U=i.data;return new ur(U.thisDep,U.contextDep,U.propDep,u)}else{if(b===_f)return new ur(!1,!1,!1,u);if(b===bf){for(var D=!1,N=!1,Q=!1,Y=0;Y<i.data.length;++Y){var ne=i.data[Y];if(ne.type===pa)Q=!0;else if(ne.type===ya)N=!0;else if(ne.type===_a)D=!0;else if(ne.type===ma){D=!0;var ae=ne.data;ae>=1&&(N=!0),ae>=2&&(Q=!0)}else ne.type===pt&&(D=D||ne.data.thisDep,N=N||ne.data.contextDep,Q=Q||ne.data.propDep)}return new ur(D,N,Q,u)}else return new ur(b===_a,b===ya,b===pa,u)}}var Hf=new ur(!1,!1,!1,function(){});function C0(i,u,b,P,U,D,N,Q,Y,ne,ae,te,se,Z,re){var S=ne.Record,$={add:32774,subtract:32778,"reverse subtract":32779};b.ext_blend_minmax&&($.min=S0,$.max=w0);var ee=b.angle_instanced_arrays,me=b.webgl_draw_buffers,W=b.oes_vertex_array_object,de={dirty:!0,profile:re.profile},ue={},Ae=[],q={},z={};function _e(d){return d.replace(".","_")}function ce(d,l,x){var M=_e(d);Ae.push(d),ue[M]=de[M]=!!x,q[M]=l}function J(d,l,x){var M=_e(d);Ae.push(d),Array.isArray(x)?(de[M]=x.slice(),ue[M]=x.slice()):de[M]=ue[M]=x,z[M]=l}ce(xf,b0),ce(Ef,_0),J(Af,"blendColor",[0,0,0,0]),J(ba,"blendEquationSeparate",[Uf,Uf]),J(xa,"blendFuncSeparate",[zf,kf,zf,kf]),ce(Tf,E0,!0),J(gf,"depthFunc",R0),J(Mf,"depthRange",[0,1]),J(Sf,"depthMask",!0),J(Ea,Ea,[!0,!0,!0,!0]),ce(wf,y0),J(Lf,"cullFace",cn),J(Aa,Aa,Pa),J(Ta,Ta,1),ce(Rf,T0),J(ga,"polygonOffset",[0,0]),ce(Of,g0),ce(Cf,M0),J(Ma,"sampleCoverage",[1,!1]),ce(Gf,x0),J(Ff,"stencilMask",-1),J(Sa,"stencilFunc",[L0,0,-1]),J(wa,"stencilOpSeparate",[Hn,Vr,Vr,Vr]),J($n,"stencilOpSeparate",[cn,Vr,Vr,Vr]),ce(Df,A0),J(yt,"scissor",[0,0,i.drawingBufferWidth,i.drawingBufferHeight]),J(Ir,Ir,[0,0,i.drawingBufferWidth,i.drawingBufferHeight]);var le={gl:i,context:se,strings:u,next:ue,current:de,draw:te,elements:D,buffer:U,shader:ae,attributes:ne.state,vao:ne,uniforms:Y,framebuffer:Q,extensions:b,timer:Z,isBufferArgs:Rt},oe={primTypes:zr,compareFuncs:Ln,blendFuncs:Gr,blendEquations:$,stencilOps:jr,glTypes:Zr,orientationType:Ia};v.optional(function(){le.isArrayLike=Ze}),me&&(oe.backBuffer=[cn],oe.drawBuffer=Tr(P.maxDrawbuffers,function(d){return d===0?[0]:Tr(d,function(l){return O0+l})}));var Fe=0;function Le(){var d=o0(),l=d.link,x=d.global;d.id=Fe++,d.batchId="0";var M=l(le),w=d.shared={props:"a0"};Object.keys(le).forEach(function(_){w[_]=x.def(M,".",_)}),v.optional(function(){d.CHECK=l(v),d.commandStr=v.guessCommand(),d.command=l(d.commandStr),d.assert=function(_,p,O){_("if(!(",p,"))",this.CHECK,".commandRaise(",l(O),",",this.command,");")},oe.invalidBlendCombinations=jf});var T=d.next={},A=d.current={};Object.keys(z).forEach(function(_){Array.isArray(de[_])&&(T[_]=x.def(w.next,".",_),A[_]=x.def(w.current,".",_))});var g=d.constants={};Object.keys(oe).forEach(function(_){g[_]=x.def(JSON.stringify(oe[_]))}),d.invoke=function(_,p){switch(p.type){case ma:var O=["this",w.context,w.props,d.batchId];return _.def(l(p.data),".call(",O.slice(0,Math.max(p.data.length+1,4)),")");case pa:return _.def(w.props,p.data);case ya:return _.def(w.context,p.data);case _a:return _.def("this",p.data);case pt:return p.data.append(d,_),p.data.ref;case _f:return p.data.toString();case bf:return p.data.map(function(L){return d.invoke(_,L)})}},d.attribCache={};var h={};return d.scopeAttrib=function(_){var p=u.id(_);if(p in h)return h[p];var O=ne.scope[p];O||(O=ne.scope[p]=new S);var L=h[p]=l(O);return L},d}function ve(d){var l=d.static,x=d.dynamic,M;if(Nn in l){var w=!!l[Nn];M=fr(function(A,g){return w}),M.enable=w}else if(Nn in x){var T=x[Nn];M=_r(T,function(A,g){return A.invoke(g,T)})}return M}function he(d,l){var x=d.static,M=d.dynamic;if(tn in x){var w=x[tn];return w?(w=Q.getFramebuffer(w),v.command(w,"invalid framebuffer object"),fr(function(A,g){var h=A.link(w),_=A.shared;g.set(_.framebuffer,".next",h);var p=_.context;return g.set(p,"."+Mn,h+".width"),g.set(p,"."+Sn,h+".height"),h})):fr(function(A,g){var h=A.shared;g.set(h.framebuffer,".next","null");var _=h.context;return g.set(_,"."+Mn,_+"."+If),g.set(_,"."+Sn,_+"."+$f),"null"})}else if(tn in M){var T=M[tn];return _r(T,function(A,g){var h=A.invoke(g,T),_=A.shared,p=_.framebuffer,O=g.def(p,".getFramebuffer(",h,")");v.optional(function(){A.assert(g,"!"+h+"||"+O,"invalid framebuffer object")}),g.set(p,".next",O);var L=_.context;return g.set(L,"."+Mn,O+"?"+O+".width:"+L+"."+If),g.set(L,"."+Sn,O+"?"+O+".height:"+L+"."+$f),O})}else return null}function Me(d,l,x){var M=d.static,w=d.dynamic;function T(h){if(h in M){var _=M[h];v.commandType(_,"object","invalid "+h,x.commandStr);var p=!0,O=_.x|0,L=_.y|0,k,X;return"width"in _?(k=_.width|0,v.command(k>=0,"invalid "+h,x.commandStr)):p=!1,"height"in _?(X=_.height|0,v.command(X>=0,"invalid "+h,x.commandStr)):p=!1,new ur(!p&&l&&l.thisDep,!p&&l&&l.contextDep,!p&&l&&l.propDep,function(Ee,pe){var H=Ee.shared.context,B=k;"width"in _||(B=pe.def(H,".",Mn,"-",O));var xe=X;return"height"in _||(xe=pe.def(H,".",Sn,"-",L)),[O,L,B,xe]})}else if(h in w){var ie=w[h],we=_r(ie,function(Ee,pe){var H=Ee.invoke(pe,ie);v.optional(function(){Ee.assert(pe,H+"&&typeof "+H+'==="object"',"invalid "+h)});var B=Ee.shared.context,xe=pe.def(H,".x|0"),be=pe.def(H,".y|0"),Se=pe.def('"width" in ',H,"?",H,".width|0:","(",B,".",Mn,"-",xe,")"),qe=pe.def('"height" in ',H,"?",H,".height|0:","(",B,".",Sn,"-",be,")");return v.optional(function(){Ee.assert(pe,Se+">=0&&"+qe+">=0","invalid "+h)}),[xe,be,Se,qe]});return l&&(we.thisDep=we.thisDep||l.thisDep,we.contextDep=we.contextDep||l.contextDep,we.propDep=we.propDep||l.propDep),we}else return l?new ur(l.thisDep,l.contextDep,l.propDep,function(Ee,pe){var H=Ee.shared.context;return[0,0,pe.def(H,".",Mn),pe.def(H,".",Sn)]}):null}var A=T(Ir);if(A){var g=A;A=new ur(A.thisDep,A.contextDep,A.propDep,function(h,_){var p=g.append(h,_),O=h.shared.context;return _.set(O,"."+u0,p[2]),_.set(O,"."+v0,p[3]),p})}return{viewport:A,scissor_box:T(yt)}}function De(d,l){var x=d.static,M=typeof x[kn]=="string"&&typeof x[Bn]=="string";if(M){if(Object.keys(l.dynamic).length>0)return null;var w=l.static,T=Object.keys(w);if(T.length>0&&typeof w[T[0]]=="number"){for(var A=[],g=0;g<T.length;++g)v(typeof w[T[g]]=="number","must specify all vertex attribute locations when using vaos"),A.push([w[T[g]]|0,T[g]]);return A}}return null}function Be(d,l,x){var M=d.static,w=d.dynamic;function T(p){if(p in M){var O=u.id(M[p]);v.optional(function(){ae.shader(qf[p],O,v.guessCommand())});var L=fr(function(){return O});return L.id=O,L}else if(p in w){var k=w[p];return _r(k,function(X,ie){var we=X.invoke(ie,k),Ee=ie.def(X.shared.strings,".id(",we,")");return v.optional(function(){ie(X.shared.shader,".shader(",qf[p],",",Ee,",",X.command,");")}),Ee})}return null}var A=T(kn),g=T(Bn),h=null,_;return qr(A)&&qr(g)?(h=ae.program(g.id,A.id,null,x),_=fr(function(p,O){return p.link(h)})):_=new ur(A&&A.thisDep||g&&g.thisDep,A&&A.contextDep||g&&g.contextDep,A&&A.propDep||g&&g.propDep,function(p,O){var L=p.shared.shader,k;A?k=A.append(p,O):k=O.def(L,".",kn);var X;g?X=g.append(p,O):X=O.def(L,".",Bn);var ie=L+".program("+X+","+k;return v.optional(function(){ie+=","+p.command}),O.def(ie+")")}),{frag:A,vert:g,progVar:_,program:h}}function Je(d,l){var x=d.static,M=d.dynamic,w={},T=!1;function A(){if(zn in x){var pe=x[zn];return pe!==null&&ne.getVAO(pe)===null&&(pe=ne.createVAO(pe)),T=!0,w.vao=pe,fr(function(B){var xe=ne.getVAO(pe);return xe?B.link(xe):"null"})}else if(zn in M){T=!0;var H=M[zn];return _r(H,function(B,xe){var be=B.invoke(xe,H);return xe.def(B.shared.vao+".getVAO("+be+")")})}return null}var g=A(),h=!1;function _(){if(an in x){var pe=x[an];if(w.elements=pe,Rt(pe)){var H=w.elements=D.create(pe,!0);pe=D.getElements(H),h=!0}else pe&&(pe=D.getElements(pe),h=!0,v.command(pe,"invalid elements",l.commandStr));var B=fr(function(be,Se){if(pe){var qe=be.link(pe);return be.ELEMENTS=qe,qe}return be.ELEMENTS=null,null});return B.value=pe,B}else if(an in M){h=!0;var xe=M[an];return _r(xe,function(be,Se){var qe=be.shared,pr=qe.isBufferArgs,on=qe.elements,$r=be.invoke(Se,xe),Dr=Se.def("null"),Xr=Se.def(pr,"(",$r,")"),un=be.cond(Xr).then(Dr,"=",on,".createStream(",$r,");").else(Dr,"=",on,".getElements(",$r,");");return v.optional(function(){be.assert(un.else,"!"+$r+"||"+Dr,"invalid elements")}),Se.entry(un),Se.exit(be.cond(Xr).then(on,".destroyStream(",Dr,");")),be.ELEMENTS=Dr,Dr})}else if(T)return new ur(g.thisDep,g.contextDep,g.propDep,function(be,Se){return Se.def(be.shared.vao+".currentVAO?"+be.shared.elements+".getElements("+be.shared.vao+".currentVAO.elements):null")});return null}var p=_();function O(){if(fn in x){var pe=x[fn];return w.primitive=pe,v.commandParameter(pe,zr,"invalid primitve",l.commandStr),fr(function(B,xe){return zr[pe]})}else if(fn in M){var H=M[fn];return _r(H,function(B,xe){var be=B.constants.primTypes,Se=B.invoke(xe,H);return v.optional(function(){B.assert(xe,Se+" in "+be,"invalid primitive, must be one of "+Object.keys(zr))}),xe.def(be,"[",Se,"]")})}else{if(h)return qr(p)?p.value?fr(function(B,xe){return xe.def(B.ELEMENTS,".primType")}):fr(function(){return Da}):new ur(p.thisDep,p.contextDep,p.propDep,function(B,xe){var be=B.ELEMENTS;return xe.def(be,"?",be,".primType:",Da)});if(T)return new ur(g.thisDep,g.contextDep,g.propDep,function(B,xe){return xe.def(B.shared.vao+".currentVAO?"+B.shared.vao+".currentVAO.primitive:"+Da)})}return null}function L(pe,H){if(pe in x){var B=x[pe]|0;return H?w.offset=B:w.instances=B,v.command(!H||B>=0,"invalid "+pe,l.commandStr),fr(function(be,Se){return H&&(be.OFFSET=B),B})}else if(pe in M){var xe=M[pe];return _r(xe,function(be,Se){var qe=be.invoke(Se,xe);return H&&(be.OFFSET=qe,v.optional(function(){be.assert(Se,qe+">=0","invalid "+pe)})),qe})}else if(H){if(h)return fr(function(be,Se){return be.OFFSET=0,0});if(T)return new ur(g.thisDep,g.contextDep,g.propDep,function(be,Se){return Se.def(be.shared.vao+".currentVAO?"+be.shared.vao+".currentVAO.offset:0")})}else if(T)return new ur(g.thisDep,g.contextDep,g.propDep,function(be,Se){return Se.def(be.shared.vao+".currentVAO?"+be.shared.vao+".currentVAO.instances:-1")});return null}var k=L(_t,!0);function X(){if(sn in x){var pe=x[sn]|0;return w.count=pe,v.command(typeof pe=="number"&&pe>=0,"invalid vertex count",l.commandStr),fr(function(){return pe})}else if(sn in M){var H=M[sn];return _r(H,function(Se,qe){var pr=Se.invoke(qe,H);return v.optional(function(){Se.assert(qe,"typeof "+pr+'==="number"&&'+pr+">=0&&"+pr+"===("+pr+"|0)","invalid vertex count")}),pr})}else if(h)if(qr(p)){if(p)return k?new ur(k.thisDep,k.contextDep,k.propDep,function(Se,qe){var pr=qe.def(Se.ELEMENTS,".vertCount-",Se.OFFSET);return v.optional(function(){Se.assert(qe,pr+">=0","invalid vertex offset/element buffer too small")}),pr}):fr(function(Se,qe){return qe.def(Se.ELEMENTS,".vertCount")});var B=fr(function(){return-1});return v.optional(function(){B.MISSING=!0}),B}else{var xe=new ur(p.thisDep||k.thisDep,p.contextDep||k.contextDep,p.propDep||k.propDep,function(Se,qe){var pr=Se.ELEMENTS;return Se.OFFSET?qe.def(pr,"?",pr,".vertCount-",Se.OFFSET,":-1"):qe.def(pr,"?",pr,".vertCount:-1")});return v.optional(function(){xe.DYNAMIC=!0}),xe}else if(T){var be=new ur(g.thisDep,g.contextDep,g.propDep,function(Se,qe){return qe.def(Se.shared.vao,".currentVAO?",Se.shared.vao,".currentVAO.count:-1")});return be}return null}var ie=O(),we=X(),Ee=L(bt,!1);return{elements:p,primitive:ie,count:we,instances:Ee,offset:k,vao:g,vaoActive:T,elementsActive:h,static:w}}function nr(d,l){var x=d.static,M=d.dynamic,w={};return Ae.forEach(function(T){var A=_e(T);function g(h,_){if(T in x){var p=h(x[T]);w[A]=fr(function(){return p})}else if(T in M){var O=M[T];w[A]=_r(O,function(L,k){return _(L,k,L.invoke(k,O))})}}switch(T){case wf:case Ef:case xf:case Gf:case Tf:case Df:case Rf:case Of:case Cf:case Sf:return g(function(h){return v.commandType(h,"boolean",T,l.commandStr),h},function(h,_,p){return v.optional(function(){h.assert(_,"typeof "+p+'==="boolean"',"invalid flag "+T,h.commandStr)}),p});case gf:return g(function(h){return v.commandParameter(h,Ln,"invalid "+T,l.commandStr),Ln[h]},function(h,_,p){var O=h.constants.compareFuncs;return v.optional(function(){h.assert(_,p+" in "+O,"invalid "+T+", must be one of "+Object.keys(Ln))}),_.def(O,"[",p,"]")});case Mf:return g(function(h){return v.command(Ze(h)&&h.length===2&&typeof h[0]=="number"&&typeof h[1]=="number"&&h[0]<=h[1],"depth range is 2d array",l.commandStr),h},function(h,_,p){v.optional(function(){h.assert(_,h.shared.isArrayLike+"("+p+")&&"+p+".length===2&&typeof "+p+'[0]==="number"&&typeof '+p+'[1]==="number"&&'+p+"[0]<="+p+"[1]","depth range must be a 2d array")});var O=_.def("+",p,"[0]"),L=_.def("+",p,"[1]");return[O,L]});case xa:return g(function(h){v.commandType(h,"object","blend.func",l.commandStr);var _="srcRGB"in h?h.srcRGB:h.src,p="srcAlpha"in h?h.srcAlpha:h.src,O="dstRGB"in h?h.dstRGB:h.dst,L="dstAlpha"in h?h.dstAlpha:h.dst;return v.commandParameter(_,Gr,A+".srcRGB",l.commandStr),v.commandParameter(p,Gr,A+".srcAlpha",l.commandStr),v.commandParameter(O,Gr,A+".dstRGB",l.commandStr),v.commandParameter(L,Gr,A+".dstAlpha",l.commandStr),v.command(jf.indexOf(_+", "+O)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+_+", "+O+")",l.commandStr),[Gr[_],Gr[O],Gr[p],Gr[L]]},function(h,_,p){var O=h.constants.blendFuncs;v.optional(function(){h.assert(_,p+"&&typeof "+p+'==="object"',"invalid blend func, must be an object")});function L(H,B){var xe=_.def('"',H,B,'" in ',p,"?",p,".",H,B,":",p,".",H);return v.optional(function(){h.assert(_,xe+" in "+O,"invalid "+T+"."+H+B+", must be one of "+Object.keys(Gr))}),xe}var k=L("src","RGB"),X=L("dst","RGB");v.optional(function(){var H=h.constants.invalidBlendCombinations;h.assert(_,H+".indexOf("+k+'+", "+'+X+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ie=_.def(O,"[",k,"]"),we=_.def(O,"[",L("src","Alpha"),"]"),Ee=_.def(O,"[",X,"]"),pe=_.def(O,"[",L("dst","Alpha"),"]");return[ie,Ee,we,pe]});case ba:return g(function(h){if(typeof h=="string")return v.commandParameter(h,$,"invalid "+T,l.commandStr),[$[h],$[h]];if(typeof h=="object")return v.commandParameter(h.rgb,$,T+".rgb",l.commandStr),v.commandParameter(h.alpha,$,T+".alpha",l.commandStr),[$[h.rgb],$[h.alpha]];v.commandRaise("invalid blend.equation",l.commandStr)},function(h,_,p){var O=h.constants.blendEquations,L=_.def(),k=_.def(),X=h.cond("typeof ",p,'==="string"');return v.optional(function(){function ie(we,Ee,pe){h.assert(we,pe+" in "+O,"invalid "+Ee+", must be one of "+Object.keys($))}ie(X.then,T,p),h.assert(X.else,p+"&&typeof "+p+'==="object"',"invalid "+T),ie(X.else,T+".rgb",p+".rgb"),ie(X.else,T+".alpha",p+".alpha")}),X.then(L,"=",k,"=",O,"[",p,"];"),X.else(L,"=",O,"[",p,".rgb];",k,"=",O,"[",p,".alpha];"),_(X),[L,k]});case Af:return g(function(h){return v.command(Ze(h)&&h.length===4,"blend.color must be a 4d array",l.commandStr),Tr(4,function(_){return+h[_]})},function(h,_,p){return v.optional(function(){h.assert(_,h.shared.isArrayLike+"("+p+")&&"+p+".length===4","blend.color must be a 4d array")}),Tr(4,function(O){return _.def("+",p,"[",O,"]")})});case Ff:return g(function(h){return v.commandType(h,"number",A,l.commandStr),h|0},function(h,_,p){return v.optional(function(){h.assert(_,"typeof "+p+'==="number"',"invalid stencil.mask")}),_.def(p,"|0")});case Sa:return g(function(h){v.commandType(h,"object",A,l.commandStr);var _=h.cmp||"keep",p=h.ref||0,O="mask"in h?h.mask:-1;return v.commandParameter(_,Ln,T+".cmp",l.commandStr),v.commandType(p,"number",T+".ref",l.commandStr),v.commandType(O,"number",T+".mask",l.commandStr),[Ln[_],p,O]},function(h,_,p){var O=h.constants.compareFuncs;v.optional(function(){function ie(){h.assert(_,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ie(p+"&&typeof ",p,'==="object"'),ie('!("cmp" in ',p,")||(",p,".cmp in ",O,")")});var L=_.def('"cmp" in ',p,"?",O,"[",p,".cmp]",":",Vr),k=_.def(p,".ref|0"),X=_.def('"mask" in ',p,"?",p,".mask|0:-1");return[L,k,X]});case wa:case $n:return g(function(h){v.commandType(h,"object",A,l.commandStr);var _=h.fail||"keep",p=h.zfail||"keep",O=h.zpass||"keep";return v.commandParameter(_,jr,T+".fail",l.commandStr),v.commandParameter(p,jr,T+".zfail",l.commandStr),v.commandParameter(O,jr,T+".zpass",l.commandStr),[T===$n?cn:Hn,jr[_],jr[p],jr[O]]},function(h,_,p){var O=h.constants.stencilOps;v.optional(function(){h.assert(_,p+"&&typeof "+p+'==="object"',"invalid "+T)});function L(k){return v.optional(function(){h.assert(_,'!("'+k+'" in '+p+")||("+p+"."+k+" in "+O+")","invalid "+T+"."+k+", must be one of "+Object.keys(jr))}),_.def('"',k,'" in ',p,"?",O,"[",p,".",k,"]:",Vr)}return[T===$n?cn:Hn,L("fail"),L("zfail"),L("zpass")]});case ga:return g(function(h){v.commandType(h,"object",A,l.commandStr);var _=h.factor|0,p=h.units|0;return v.commandType(_,"number",A+".factor",l.commandStr),v.commandType(p,"number",A+".units",l.commandStr),[_,p]},function(h,_,p){v.optional(function(){h.assert(_,p+"&&typeof "+p+'==="object"',"invalid "+T)});var O=_.def(p,".factor|0"),L=_.def(p,".units|0");return[O,L]});case Lf:return g(function(h){var _=0;return h==="front"?_=Hn:h==="back"&&(_=cn),v.command(!!_,A,l.commandStr),_},function(h,_,p){return v.optional(function(){h.assert(_,p+'==="front"||'+p+'==="back"',"invalid cull.face")}),_.def(p,'==="front"?',Hn,":",cn)});case Ta:return g(function(h){return v.command(typeof h=="number"&&h>=P.lineWidthDims[0]&&h<=P.lineWidthDims[1],"invalid line width, must be a positive number between "+P.lineWidthDims[0]+" and "+P.lineWidthDims[1],l.commandStr),h},function(h,_,p){return v.optional(function(){h.assert(_,"typeof "+p+'==="number"&&'+p+">="+P.lineWidthDims[0]+"&&"+p+"<="+P.lineWidthDims[1],"invalid line width")}),p});case Aa:return g(function(h){return v.commandParameter(h,Ia,A,l.commandStr),Ia[h]},function(h,_,p){return v.optional(function(){h.assert(_,p+'==="cw"||'+p+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),_.def(p+'==="cw"?'+Bf+":"+Pa)});case Ea:return g(function(h){return v.command(Ze(h)&&h.length===4,"color.mask must be length 4 array",l.commandStr),h.map(function(_){return!!_})},function(h,_,p){return v.optional(function(){h.assert(_,h.shared.isArrayLike+"("+p+")&&"+p+".length===4","invalid color.mask")}),Tr(4,function(O){return"!!"+p+"["+O+"]"})});case Ma:return g(function(h){v.command(typeof h=="object"&&h,A,l.commandStr);var _="value"in h?h.value:1,p=!!h.invert;return v.command(typeof _=="number"&&_>=0&&_<=1,"sample.coverage.value must be a number between 0 and 1",l.commandStr),[_,p]},function(h,_,p){v.optional(function(){h.assert(_,p+"&&typeof "+p+'==="object"',"invalid sample.coverage")});var O=_.def('"value" in ',p,"?+",p,".value:1"),L=_.def("!!",p,".invert");return[O,L]})}}),w}function ze(d,l){var x=d.static,M=d.dynamic,w={};return Object.keys(x).forEach(function(T){var A=x[T],g;if(typeof A=="number"||typeof A=="boolean")g=fr(function(){return A});else if(typeof A=="function"){var h=A._reglType;h==="texture2d"||h==="textureCube"?g=fr(function(_){return _.link(A)}):h==="framebuffer"||h==="framebufferCube"?(v.command(A.color.length>0,'missing color attachment for framebuffer sent to uniform "'+T+'"',l.commandStr),g=fr(function(_){return _.link(A.color[0])})):v.commandRaise('invalid data for uniform "'+T+'"',l.commandStr)}else Ze(A)?g=fr(function(_){var p=_.global.def("[",Tr(A.length,function(O){return v.command(typeof A[O]=="number"||typeof A[O]=="boolean","invalid uniform "+T,_.commandStr),A[O]}),"]");return p}):v.commandRaise('invalid or missing data for uniform "'+T+'"',l.commandStr);g.value=A,w[T]=g}),Object.keys(M).forEach(function(T){var A=M[T];w[T]=_r(A,function(g,h){return g.invoke(h,A)})}),w}function cr(d,l){var x=d.static,M=d.dynamic,w={};return Object.keys(x).forEach(function(T){var A=x[T],g=u.id(T),h=new S;if(Rt(A))h.state=gn,h.buffer=U.getBuffer(U.create(A,wn,!1,!0)),h.type=0;else{var _=U.getBuffer(A);if(_)h.state=gn,h.buffer=_,h.type=0;else if(v.command(typeof A=="object"&&A,"invalid data for attribute "+T,l.commandStr),"constant"in A){var p=A.constant;h.buffer="null",h.state=ha,typeof p=="number"?h.x=p:(v.command(Ze(p)&&p.length>0&&p.length<=4,"invalid constant for attribute "+T,l.commandStr),Tn.forEach(function(Ee,pe){pe<p.length&&(h[Ee]=p[pe])}))}else{Rt(A.buffer)?_=U.getBuffer(U.create(A.buffer,wn,!1,!0)):_=U.getBuffer(A.buffer),v.command(!!_,'missing buffer for attribute "'+T+'"',l.commandStr);var O=A.offset|0;v.command(O>=0,'invalid offset for attribute "'+T+'"',l.commandStr);var L=A.stride|0;v.command(L>=0&&L<256,'invalid stride for attribute "'+T+'", must be integer betweeen [0, 255]',l.commandStr);var k=A.size|0;v.command(!("size"in A)||k>0&&k<=4,'invalid size for attribute "'+T+'", must be 1,2,3,4',l.commandStr);var X=!!A.normalized,ie=0;"type"in A&&(v.commandParameter(A.type,Zr,"invalid type for attribute "+T,l.commandStr),ie=Zr[A.type]);var we=A.divisor|0;v.optional(function(){"divisor"in A&&(v.command(we===0||ee,'cannot specify divisor for attribute "'+T+'", instancing not supported',l.commandStr),v.command(we>=0,'invalid divisor for attribute "'+T+'"',l.commandStr));var Ee=l.commandStr,pe=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(A).forEach(function(H){v.command(pe.indexOf(H)>=0,'unknown parameter "'+H+'" for attribute pointer "'+T+'" (valid parameters are '+pe+")",Ee)})}),h.buffer=_,h.state=gn,h.size=k,h.normalized=X,h.type=ie||_.dtype,h.offset=O,h.stride=L,h.divisor=we}}w[T]=fr(function(Ee,pe){var H=Ee.attribCache;if(g in H)return H[g];var B={isStream:!1};return Object.keys(h).forEach(function(xe){B[xe]=h[xe]}),h.buffer&&(B.buffer=Ee.link(h.buffer),B.type=B.type||B.buffer+".dtype"),H[g]=B,B})}),Object.keys(M).forEach(function(T){var A=M[T];function g(h,_){var p=h.invoke(_,A),O=h.shared,L=h.constants,k=O.isBufferArgs,X=O.buffer;v.optional(function(){h.assert(_,p+"&&(typeof "+p+'==="object"||typeof '+p+'==="function")&&('+k+"("+p+")||"+X+".getBuffer("+p+")||"+X+".getBuffer("+p+".buffer)||"+k+"("+p+'.buffer)||("constant" in '+p+"&&(typeof "+p+'.constant==="number"||'+O.isArrayLike+"("+p+".constant))))",'invalid dynamic attribute "'+T+'"')});var ie={isStream:_.def(!1)},we=new S;we.state=gn,Object.keys(we).forEach(function(B){ie[B]=_.def(""+we[B])});var Ee=ie.buffer,pe=ie.type;_("if(",k,"(",p,")){",ie.isStream,"=true;",Ee,"=",X,".createStream(",wn,",",p,");",pe,"=",Ee,".dtype;","}else{",Ee,"=",X,".getBuffer(",p,");","if(",Ee,"){",pe,"=",Ee,".dtype;",'}else if("constant" in ',p,"){",ie.state,"=",ha,";","if(typeof "+p+'.constant === "number"){',ie[Tn[0]],"=",p,".constant;",Tn.slice(1).map(function(B){return ie[B]}).join("="),"=0;","}else{",Tn.map(function(B,xe){return ie[B]+"="+p+".constant.length>"+xe+"?"+p+".constant["+xe+"]:0;"}).join(""),"}}else{","if(",k,"(",p,".buffer)){",Ee,"=",X,".createStream(",wn,",",p,".buffer);","}else{",Ee,"=",X,".getBuffer(",p,".buffer);","}",pe,'="type" in ',p,"?",L.glTypes,"[",p,".type]:",Ee,".dtype;",ie.normalized,"=!!",p,".normalized;");function H(B){_(ie[B],"=",p,".",B,"|0;")}return H("size"),H("offset"),H("stride"),H("divisor"),_("}}"),_.exit("if(",ie.isStream,"){",X,".destroyStream(",Ee,");","}"),ie}w[T]=_r(A,g)}),w}function Ye(d){var l=d.static,x=d.dynamic,M={};return Object.keys(l).forEach(function(w){var T=l[w];M[w]=fr(function(A,g){return typeof T=="number"||typeof T=="boolean"?""+T:A.link(T)})}),Object.keys(x).forEach(function(w){var T=x[w];M[w]=_r(T,function(A,g){return A.invoke(g,T)})}),M}function sr(d,l,x,M,w){var T=d.static,A=d.dynamic;v.optional(function(){var H=[tn,Bn,kn,an,fn,_t,sn,bt,Nn,zn].concat(Ae);function B(xe){Object.keys(xe).forEach(function(be){v.command(H.indexOf(be)>=0,'unknown parameter "'+be+'"',w.commandStr)})}B(T),B(A)});var g=De(d,l),h=he(d),_=Me(d,h,w),p=Je(d,w),O=nr(d,w),L=Be(d,w,g);function k(H){var B=_[H];B&&(O[H]=B)}k(Ir),k(_e(yt));var X=Object.keys(O).length>0,ie={framebuffer:h,draw:p,shader:L,state:O,dirty:X,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ie.profile=ve(d),ie.uniforms=ze(x,w),ie.drawVAO=ie.scopeVAO=p.vao,!ie.drawVAO&&L.program&&!g&&b.angle_instanced_arrays&&p.static.elements){var we=!0,Ee=L.program.attributes.map(function(H){var B=l.static[H];return we=we&&!!B,B});if(we&&Ee.length>0){var pe=ne.getVAO(ne.createVAO({attributes:Ee,elements:p.static.elements}));ie.drawVAO=new ur(null,null,null,function(H,B){return H.link(pe)}),ie.useVAO=!0}}return g?ie.useVAO=!0:ie.attributes=cr(l,w),ie.context=Ye(M),ie}function lr(d,l,x){var M=d.shared,w=M.context,T=d.scope();Object.keys(x).forEach(function(A){l.save(w,"."+A);var g=x[A],h=g.append(d,l);Array.isArray(h)?T(w,".",A,"=[",h.join(),"];"):T(w,".",A,"=",h,";")}),l(T)}function or(d,l,x,M){var w=d.shared,T=w.gl,A=w.framebuffer,g;me&&(g=l.def(w.extensions,".webgl_draw_buffers"));var h=d.constants,_=h.drawBuffer,p=h.backBuffer,O;x?O=x.append(d,l):O=l.def(A,".next"),M||l("if(",O,"!==",A,".cur){"),l("if(",O,"){",T,".bindFramebuffer(",Vf,",",O,".framebuffer);"),me&&l(g,".drawBuffersWEBGL(",_,"[",O,".colorAttachments.length]);"),l("}else{",T,".bindFramebuffer(",Vf,",null);"),me&&l(g,".drawBuffersWEBGL(",p,");"),l("}",A,".cur=",O,";"),M||l("}")}function vr(d,l,x){var M=d.shared,w=M.gl,T=d.current,A=d.next,g=M.current,h=M.next,_=d.cond(g,".dirty");Ae.forEach(function(p){var O=_e(p);if(!(O in x.state)){var L,k;if(O in A){L=A[O],k=T[O];var X=Tr(de[O].length,function(we){return _.def(L,"[",we,"]")});_(d.cond(X.map(function(we,Ee){return we+"!=="+k+"["+Ee+"]"}).join("||")).then(w,".",z[O],"(",X,");",X.map(function(we,Ee){return k+"["+Ee+"]="+we}).join(";"),";"))}else{L=_.def(h,".",O);var ie=d.cond(L,"!==",g,".",O);_(ie),O in q?ie(d.cond(L).then(w,".enable(",q[O],");").else(w,".disable(",q[O],");"),g,".",O,"=",L,";"):ie(w,".",z[O],"(",L,");",g,".",O,"=",L,";")}}}),Object.keys(x.state).length===0&&_(g,".dirty=false;"),l(_)}function hr(d,l,x,M){var w=d.shared,T=d.current,A=w.current,g=w.gl;Xf(Object.keys(x)).forEach(function(h){var _=x[h];if(!(M&&!M(_))){var p=_.append(d,l);if(q[h]){var O=q[h];qr(_)?p?l(g,".enable(",O,");"):l(g,".disable(",O,");"):l(d.cond(p).then(g,".enable(",O,");").else(g,".disable(",O,");")),l(A,".",h,"=",p,";")}else if(Ze(p)){var L=T[h];l(g,".",z[h],"(",p,");",p.map(function(k,X){return L+"["+X+"]="+k}).join(";"),";")}else l(g,".",z[h],"(",p,");",A,".",h,"=",p,";")}})}function tr(d,l){ee&&(d.instancing=l.def(d.shared.extensions,".angle_instanced_arrays"))}function Ie(d,l,x,M,w){var T=d.shared,A=d.stats,g=T.current,h=T.timer,_=x.profile;function p(){return typeof performance>"u"?"Date.now()":"performance.now()"}var O,L;function k(H){O=l.def(),H(O,"=",p(),";"),typeof w=="string"?H(A,".count+=",w,";"):H(A,".count++;"),Z&&(M?(L=l.def(),H(L,"=",h,".getNumPendingQueries();")):H(h,".beginQuery(",A,");"))}function X(H){H(A,".cpuTime+=",p(),"-",O,";"),Z&&(M?H(h,".pushScopeStats(",L,",",h,".getNumPendingQueries(),",A,");"):H(h,".endQuery();"))}function ie(H){var B=l.def(g,".profile");l(g,".profile=",H,";"),l.exit(g,".profile=",B,";")}var we;if(_){if(qr(_)){_.enable?(k(l),X(l.exit),ie("true")):ie("false");return}we=_.append(d,l),ie(we)}else we=l.def(g,".profile");var Ee=d.block();k(Ee),l("if(",we,"){",Ee,"}");var pe=d.block();X(pe),l.exit("if(",we,"){",pe,"}")}function mr(d,l,x,M,w){var T=d.shared;function A(h){switch(h){case xt:case Tt:case St:return 2;case Et:case gt:case wt:return 3;case At:case Mt:case Lt:return 4;default:return 1}}function g(h,_,p){var O=T.gl,L=l.def(h,".location"),k=l.def(T.attributes,"[",L,"]"),X=p.state,ie=p.buffer,we=[p.x,p.y,p.z,p.w],Ee=["buffer","normalized","offset","stride"];function pe(){l("if(!",k,".buffer){",O,".enableVertexAttribArray(",L,");}");var B=p.type,xe;if(p.size?xe=l.def(p.size,"||",_):xe=_,l("if(",k,".type!==",B,"||",k,".size!==",xe,"||",Ee.map(function(Se){return k+"."+Se+"!=="+p[Se]}).join("||"),"){",O,".bindBuffer(",wn,",",ie,".buffer);",O,".vertexAttribPointer(",[L,xe,B,p.normalized,p.stride,p.offset],");",k,".type=",B,";",k,".size=",xe,";",Ee.map(function(Se){return k+"."+Se+"="+p[Se]+";"}).join(""),"}"),ee){var be=p.divisor;l("if(",k,".divisor!==",be,"){",d.instancing,".vertexAttribDivisorANGLE(",[L,be],");",k,".divisor=",be,";}")}}function H(){l("if(",k,".buffer){",O,".disableVertexAttribArray(",L,");",k,".buffer=null;","}if(",Tn.map(function(B,xe){return k+"."+B+"!=="+we[xe]}).join("||"),"){",O,".vertexAttrib4f(",L,",",we,");",Tn.map(function(B,xe){return k+"."+B+"="+we[xe]+";"}).join(""),"}")}X===gn?pe():X===ha?H():(l("if(",X,"===",gn,"){"),pe(),l("}else{"),H(),l("}"))}M.forEach(function(h){var _=h.name,p=x.attributes[_],O;if(p){if(!w(p))return;O=p.append(d,l)}else{if(!w(Hf))return;var L=d.scopeAttrib(_);v.optional(function(){d.assert(l,L+".state","missing attribute "+_)}),O={},Object.keys(new S).forEach(function(k){O[k]=l.def(L,".",k)})}g(d.link(h),A(h.info.type),O)})}function je(d,l,x,M,w,T){for(var A=d.shared,g=A.gl,h={},_,p=0;p<M.length;++p){var O=M[p],L=O.name,k=O.info.type,X=O.info.size,ie=x.uniforms[L];if(X>1){if(!ie)continue;var we=L.replace("[0]","");if(h[we])continue;h[we]=1}var Ee=d.link(O),pe=Ee+".location",H;if(ie){if(!w(ie))continue;if(qr(ie)){var B=ie.value;if(v.command(B!==null&&typeof B<"u",'missing uniform "'+L+'"',d.commandStr),k===qn||k===Xn){v.command(typeof B=="function"&&(k===qn&&(B._reglType==="texture2d"||B._reglType==="framebuffer")||k===Xn&&(B._reglType==="textureCube"||B._reglType==="framebufferCube")),"invalid texture for uniform "+L,d.commandStr);var xe=d.link(B._texture||B.color[0]._texture);l(g,".uniform1i(",pe,",",xe+".bind());"),l.exit(xe,".unbind();")}else if(k===Un||k===Vn||k===jn){v.optional(function(){v.command(Ze(B),"invalid matrix for uniform "+L,d.commandStr),v.command(k===Un&&B.length===4||k===Vn&&B.length===9||k===jn&&B.length===16,"invalid length for matrix uniform "+L,d.commandStr)});var be=d.global.def("new Float32Array(["+Array.prototype.slice.call(B)+"])"),Se=2;k===Vn?Se=3:k===jn&&(Se=4),l(g,".uniformMatrix",Se,"fv(",pe,",false,",be,");")}else{switch(k){case Ca:X===1?v.commandType(B,"number","uniform "+L,d.commandStr):v.command(Ze(B)&&B.length===X,"uniform "+L,d.commandStr),_="1f";break;case xt:v.command(Ze(B)&&B.length&&B.length%2===0&&B.length<=X*2,"uniform "+L,d.commandStr),_="2f";break;case Et:v.command(Ze(B)&&B.length&&B.length%3===0&&B.length<=X*3,"uniform "+L,d.commandStr),_="3f";break;case At:v.command(Ze(B)&&B.length&&B.length%4===0&&B.length<=X*4,"uniform "+L,d.commandStr),_="4f";break;case Fa:X===1?v.commandType(B,"boolean","uniform "+L,d.commandStr):v.command(Ze(B)&&B.length===X,"uniform "+L,d.commandStr),_="1i";break;case Ga:X===1?v.commandType(B,"number","uniform "+L,d.commandStr):v.command(Ze(B)&&B.length===X,"uniform "+L,d.commandStr),_="1i";break;case St:v.command(Ze(B)&&B.length&&B.length%2===0&&B.length<=X*2,"uniform "+L,d.commandStr),_="2i";break;case Tt:v.command(Ze(B)&&B.length&&B.length%2===0&&B.length<=X*2,"uniform "+L,d.commandStr),_="2i";break;case wt:v.command(Ze(B)&&B.length&&B.length%3===0&&B.length<=X*3,"uniform "+L,d.commandStr),_="3i";break;case gt:v.command(Ze(B)&&B.length&&B.length%3===0&&B.length<=X*3,"uniform "+L,d.commandStr),_="3i";break;case Lt:v.command(Ze(B)&&B.length&&B.length%4===0&&B.length<=X*4,"uniform "+L,d.commandStr),_="4i";break;case Mt:v.command(Ze(B)&&B.length&&B.length%4===0&&B.length<=X*4,"uniform "+L,d.commandStr),_="4i";break}X>1?(_+="v",B=d.global.def("["+Array.prototype.slice.call(B)+"]")):B=Ze(B)?Array.prototype.slice.call(B):B,l(g,".uniform",_,"(",pe,",",B,");")}continue}else H=ie.append(d,l)}else{if(!w(Hf))continue;H=l.def(A.uniforms,"[",u.id(L),"]")}k===qn?(v(!Array.isArray(H),"must specify a scalar prop for textures"),l("if(",H,"&&",H,'._reglType==="framebuffer"){',H,"=",H,".color[0];","}")):k===Xn&&(v(!Array.isArray(H),"must specify a scalar prop for cube maps"),l("if(",H,"&&",H,'._reglType==="framebufferCube"){',H,"=",H,".color[0];","}")),v.optional(function(){function Mr(br,Ot){d.assert(l,br,'bad data or missing for uniform "'+L+'".  '+Ot)}function vn(br,Ot){Ot===1&&v(!Array.isArray(H),"must not specify an array type for uniform"),Mr("Array.isArray("+H+") && typeof "+H+'[0]===" '+br+'" || typeof '+H+'==="'+br+'"',"invalid type, expected "+br)}function wr(br,Ot,Ct){Array.isArray(H)?v(H.length&&H.length%br===0&&H.length<=br*Ct,"must have length of "+(Ct===1?"":"n * ")+br):Mr(A.isArrayLike+"("+H+")&&"+H+".length && "+H+".length % "+br+" === 0 && "+H+".length<="+br*Ct,"invalid vector, should have length of "+(Ct===1?"":"n * ")+br,d.commandStr)}function es(br){v(!Array.isArray(H),"must not specify a value type"),Mr("typeof "+H+'==="function"&&'+H+'._reglType==="texture'+(br===Nf?"2d":"Cube")+'"',"invalid texture type",d.commandStr)}switch(k){case Ga:vn("number",X);break;case Tt:wr(2,"number",X);break;case gt:wr(3,"number",X);break;case Mt:wr(4,"number",X);break;case Ca:vn("number",X);break;case xt:wr(2,"number",X);break;case Et:wr(3,"number",X);break;case At:wr(4,"number",X);break;case Fa:vn("boolean",X);break;case St:wr(2,"boolean",X);break;case wt:wr(3,"boolean",X);break;case Lt:wr(4,"boolean",X);break;case Un:wr(4,"number",X);break;case Vn:wr(9,"number",X);break;case jn:wr(16,"number",X);break;case qn:es(Nf);break;case Xn:es(p0);break}});var qe=1;switch(k){case qn:case Xn:var pr=l.def(H,"._texture");l(g,".uniform1i(",pe,",",pr,".bind());"),l.exit(pr,".unbind();");continue;case Ga:case Fa:_="1i";break;case Tt:case St:_="2i",qe=2;break;case gt:case wt:_="3i",qe=3;break;case Mt:case Lt:_="4i",qe=4;break;case Ca:_="1f";break;case xt:_="2f",qe=2;break;case Et:_="3f",qe=3;break;case At:_="4f",qe=4;break;case Un:_="Matrix2fv";break;case Vn:_="Matrix3fv";break;case jn:_="Matrix4fv";break}if(_.indexOf("Matrix")===-1&&X>1&&(_+="v",qe=1),_.charAt(0)==="M"){l(g,".uniform",_,"(",pe,",");var on=Math.pow(k-Un+2,2),$r=d.global.def("new Float32Array(",on,")");Array.isArray(H)?l("false,(",Tr(on,function(Mr){return $r+"["+Mr+"]="+H[Mr]}),",",$r,")"):l("false,(Array.isArray(",H,")||",H," instanceof Float32Array)?",H,":(",Tr(on,function(Mr){return $r+"["+Mr+"]="+H+"["+Mr+"]"}),",",$r,")"),l(");")}else if(qe>1){for(var Dr=[],Xr=[],un=0;un<qe;++un)Array.isArray(H)?Xr.push(H[un]):Xr.push(l.def(H+"["+un+"]")),T&&Dr.push(l.def());T&&l("if(!",d.batchId,"||",Dr.map(function(Mr,vn){return Mr+"!=="+Xr[vn]}).join("||"),"){",Dr.map(function(Mr,vn){return Mr+"="+Xr[vn]+";"}).join("")),l(g,".uniform",_,"(",pe,",",Xr.join(","),");"),T&&l("}")}else{if(v(!Array.isArray(H),"uniform value must not be an array"),T){var Jf=l.def();l("if(!",d.batchId,"||",Jf,"!==",H,"){",Jf,"=",H,";")}l(g,".uniform",_,"(",pe,",",H,");"),T&&l("}")}}}function Te(d,l,x,M){var w=d.shared,T=w.gl,A=w.draw,g=M.draw;function h(){var xe=g.elements,be,Se=l;return xe?((xe.contextDep&&M.contextDynamic||xe.propDep)&&(Se=x),be=xe.append(d,Se),g.elementsActive&&Se("if("+be+")"+T+".bindBuffer("+Oa+","+be+".buffer.buffer);")):(be=Se.def(),Se(be,"=",A,".",an,";","if(",be,"){",T,".bindBuffer(",Oa,",",be,".buffer.buffer);}","else if(",w.vao,".currentVAO){",be,"=",d.shared.elements+".getElements("+w.vao,".currentVAO.elements);",W?"":"if("+be+")"+T+".bindBuffer("+Oa+","+be+".buffer.buffer);","}")),be}function _(){var xe=g.count,be,Se=l;return xe?((xe.contextDep&&M.contextDynamic||xe.propDep)&&(Se=x),be=xe.append(d,Se),v.optional(function(){xe.MISSING&&d.assert(l,"false","missing vertex count"),xe.DYNAMIC&&d.assert(Se,be+">=0","missing vertex count")})):(be=Se.def(A,".",sn),v.optional(function(){d.assert(Se,be+">=0","missing vertex count")})),be}var p=h();function O(xe){var be=g[xe];return be?be.contextDep&&M.contextDynamic||be.propDep?be.append(d,x):be.append(d,l):l.def(A,".",xe)}var L=O(fn),k=O(_t),X=_();if(typeof X=="number"){if(X===0)return}else x("if(",X,"){"),x.exit("}");var ie,we;ee&&(ie=O(bt),we=d.instancing);var Ee=p+".type",pe=g.elements&&qr(g.elements)&&!g.vaoActive;function H(){function xe(){x(we,".drawElementsInstancedANGLE(",[L,X,Ee,k+"<<(("+Ee+"-"+yf+")>>1)",ie],");")}function be(){x(we,".drawArraysInstancedANGLE(",[L,k,X,ie],");")}p&&p!=="null"?pe?xe():(x("if(",p,"){"),xe(),x("}else{"),be(),x("}")):be()}function B(){function xe(){x(T+".drawElements("+[L,X,Ee,k+"<<(("+Ee+"-"+yf+")>>1)"]+");")}function be(){x(T+".drawArrays("+[L,k,X]+");")}p&&p!=="null"?pe?xe():(x("if(",p,"){"),xe(),x("}else{"),be(),x("}")):be()}ee&&(typeof ie!="number"||ie>=0)?typeof ie=="string"?(x("if(",ie,">0){"),H(),x("}else if(",ie,"<0){"),B(),x("}")):H():B()}function ke(d,l,x,M,w){var T=Le(),A=T.proc("body",w);return v.optional(function(){T.commandStr=l.commandStr,T.command=T.link(l.commandStr)}),ee&&(T.instancing=A.def(T.shared.extensions,".angle_instanced_arrays")),d(T,A,x,M),T.compile().body}function Ue(d,l,x,M){tr(d,l),x.useVAO?x.drawVAO?l(d.shared.vao,".setVAO(",x.drawVAO.append(d,l),");"):l(d.shared.vao,".setVAO(",d.shared.vao,".targetVAO);"):(l(d.shared.vao,".setVAO(null);"),mr(d,l,x,M.attributes,function(){return!0})),je(d,l,x,M.uniforms,function(){return!0},!1),Te(d,l,l,x)}function ar(d,l){var x=d.proc("draw",1);tr(d,x),lr(d,x,l.context),or(d,x,l.framebuffer),vr(d,x,l),hr(d,x,l.state),Ie(d,x,l,!1,!0);var M=l.shader.progVar.append(d,x);if(x(d.shared.gl,".useProgram(",M,".program);"),l.shader.program)Ue(d,x,l,l.shader.program);else{x(d.shared.vao,".setVAO(null);");var w=d.global.def("{}"),T=x.def(M,".id"),A=x.def(w,"[",T,"]");x(d.cond(A).then(A,".call(this,a0);").else(A,"=",w,"[",T,"]=",d.link(function(g){return ke(Ue,d,l,g,1)}),"(",M,");",A,".call(this,a0);"))}Object.keys(l.state).length>0&&x(d.shared.current,".dirty=true;"),d.shared.vao&&x(d.shared.vao,".setVAO(null);")}function Fr(d,l,x,M){d.batchId="a1",tr(d,l);function w(){return!0}mr(d,l,x,M.attributes,w),je(d,l,x,M.uniforms,w,!1),Te(d,l,l,x)}function ln(d,l,x,M){tr(d,l);var w=x.contextDep,T=l.def(),A="a0",g="a1",h=l.def();d.shared.props=h,d.batchId=T;var _=d.scope(),p=d.scope();l(_.entry,"for(",T,"=0;",T,"<",g,";++",T,"){",h,"=",A,"[",T,"];",p,"}",_.exit);function O(Ee){return Ee.contextDep&&w||Ee.propDep}function L(Ee){return!O(Ee)}if(x.needsContext&&lr(d,p,x.context),x.needsFramebuffer&&or(d,p,x.framebuffer),hr(d,p,x.state,O),x.profile&&O(x.profile)&&Ie(d,p,x,!1,!0),M)x.useVAO?x.drawVAO?O(x.drawVAO)?p(d.shared.vao,".setVAO(",x.drawVAO.append(d,p),");"):_(d.shared.vao,".setVAO(",x.drawVAO.append(d,_),");"):_(d.shared.vao,".setVAO(",d.shared.vao,".targetVAO);"):(_(d.shared.vao,".setVAO(null);"),mr(d,_,x,M.attributes,L),mr(d,p,x,M.attributes,O)),je(d,_,x,M.uniforms,L,!1),je(d,p,x,M.uniforms,O,!0),Te(d,_,p,x);else{var k=d.global.def("{}"),X=x.shader.progVar.append(d,p),ie=p.def(X,".id"),we=p.def(k,"[",ie,"]");p(d.shared.gl,".useProgram(",X,".program);","if(!",we,"){",we,"=",k,"[",ie,"]=",d.link(function(Ee){return ke(Fr,d,x,Ee,2)}),"(",X,");}",we,".call(this,a0[",T,"],",T,");")}}function y(d,l){var x=d.proc("batch",2);d.batchId="0",tr(d,x);var M=!1,w=!0;Object.keys(l.context).forEach(function(k){M=M||l.context[k].propDep}),M||(lr(d,x,l.context),w=!1);var T=l.framebuffer,A=!1;T?(T.propDep?M=A=!0:T.contextDep&&M&&(A=!0),A||or(d,x,T)):or(d,x,null),l.state.viewport&&l.state.viewport.propDep&&(M=!0);function g(k){return k.contextDep&&M||k.propDep}vr(d,x,l),hr(d,x,l.state,function(k){return!g(k)}),(!l.profile||!g(l.profile))&&Ie(d,x,l,!1,"a1"),l.contextDep=M,l.needsContext=w,l.needsFramebuffer=A;var h=l.shader.progVar;if(h.contextDep&&M||h.propDep)ln(d,x,l,null);else{var _=h.append(d,x);if(x(d.shared.gl,".useProgram(",_,".program);"),l.shader.program)ln(d,x,l,l.shader.program);else{x(d.shared.vao,".setVAO(null);");var p=d.global.def("{}"),O=x.def(_,".id"),L=x.def(p,"[",O,"]");x(d.cond(L).then(L,".call(this,a0,a1);").else(L,"=",p,"[",O,"]=",d.link(function(k){return ke(ln,d,l,k,2)}),"(",_,");",L,".call(this,a0,a1);"))}}Object.keys(l.state).length>0&&x(d.shared.current,".dirty=true;"),d.shared.vao&&x(d.shared.vao,".setVAO(null);")}function I(d,l){var x=d.proc("scope",3);d.batchId="a2";var M=d.shared,w=M.current;lr(d,x,l.context),l.framebuffer&&l.framebuffer.append(d,x),Xf(Object.keys(l.state)).forEach(function(A){var g=l.state[A],h=g.append(d,x);Ze(h)?h.forEach(function(_,p){x.set(d.next[A],"["+p+"]",_)}):x.set(M.next,"."+A,h)}),Ie(d,x,l,!0,!0),[an,_t,sn,bt,fn].forEach(function(A){var g=l.draw[A];g&&x.set(M.draw,"."+A,""+g.append(d,x))}),Object.keys(l.uniforms).forEach(function(A){var g=l.uniforms[A].append(d,x);Array.isArray(g)&&(g="["+g.join()+"]"),x.set(M.uniforms,"["+u.id(A)+"]",g)}),Object.keys(l.attributes).forEach(function(A){var g=l.attributes[A].append(d,x),h=d.scopeAttrib(A);Object.keys(new S).forEach(function(_){x.set(h,"."+_,g[_])})}),l.scopeVAO&&x.set(M.vao,".targetVAO",l.scopeVAO.append(d,x));function T(A){var g=l.shader[A];g&&x.set(M.shader,"."+A,g.append(d,x))}T(Bn),T(kn),Object.keys(l.state).length>0&&(x(w,".dirty=true;"),x.exit(w,".dirty=true;")),x("a1(",d.shared.context,",a0,",d.batchId,");")}function C(d){if(!(typeof d!="object"||Ze(d))){for(var l=Object.keys(d),x=0;x<l.length;++x)if(Ar.isDynamic(d[l[x]]))return!0;return!1}}function ye(d,l,x){var M=l.static[x];if(!M||!C(M))return;var w=d.global,T=Object.keys(M),A=!1,g=!1,h=!1,_=d.global.def("{}");T.forEach(function(O){var L=M[O];if(Ar.isDynamic(L)){typeof L=="function"&&(L=M[O]=Ar.unbox(L));var k=_r(L,null);A=A||k.thisDep,h=h||k.propDep,g=g||k.contextDep}else{switch(w(_,".",O,"="),typeof L){case"number":w(L);break;case"string":w('"',L,'"');break;case"object":Array.isArray(L)&&w("[",L.join(),"]");break;default:w(d.link(L));break}w(";")}});function p(O,L){T.forEach(function(k){var X=M[k];if(Ar.isDynamic(X)){var ie=O.invoke(L,X);L(_,".",k,"=",ie,";")}})}l.dynamic[x]=new Ar.DynamicVariable(pt,{thisDep:A,contextDep:g,propDep:h,ref:_,append:p}),delete l.static[x]}function Ne(d,l,x,M,w){var T=Le();T.stats=T.link(w),Object.keys(l.static).forEach(function(g){ye(T,l,g)}),d0.forEach(function(g){ye(T,d,g)});var A=sr(d,l,x,M,T);return ar(T,A),I(T,A),y(T,A),t(T.compile(),{destroy:function(){A.shader.program.destroy()}})}return{next:ue,current:de,procs:function(){var d=Le(),l=d.proc("poll"),x=d.proc("refresh"),M=d.block();l(M),x(M);var w=d.shared,T=w.gl,A=w.next,g=w.current;M(g,".dirty=false;"),or(d,l),or(d,x,null,!0);var h;ee&&(h=d.link(ee)),b.oes_vertex_array_object&&x(d.link(b.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var _=0;_<P.maxAttributes;++_){var p=x.def(w.attributes,"[",_,"]"),O=d.cond(p,".buffer");O.then(T,".enableVertexAttribArray(",_,");",T,".bindBuffer(",wn,",",p,".buffer.buffer);",T,".vertexAttribPointer(",_,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(T,".disableVertexAttribArray(",_,");",T,".vertexAttrib4f(",_,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),x(O),ee&&x(h,".vertexAttribDivisorANGLE(",_,",",p,".divisor);")}return x(d.shared.vao,".currentVAO=null;",d.shared.vao,".setVAO(",d.shared.vao,".targetVAO);"),Object.keys(q).forEach(function(L){var k=q[L],X=M.def(A,".",L),ie=d.block();ie("if(",X,"){",T,".enable(",k,")}else{",T,".disable(",k,")}",g,".",L,"=",X,";"),x(ie),l("if(",X,"!==",g,".",L,"){",ie,"}")}),Object.keys(z).forEach(function(L){var k=z[L],X=de[L],ie,we,Ee=d.block();if(Ee(T,".",k,"("),Ze(X)){var pe=X.length;ie=d.global.def(A,".",L),we=d.global.def(g,".",L),Ee(Tr(pe,function(H){return ie+"["+H+"]"}),");",Tr(pe,function(H){return we+"["+H+"]="+ie+"["+H+"];"}).join("")),l("if(",Tr(pe,function(H){return ie+"["+H+"]!=="+we+"["+H+"]"}).join("||"),"){",Ee,"}")}else ie=M.def(A,".",L),we=M.def(g,".",L),Ee(ie,");",g,".",L,"=",ie,";"),l("if(",ie,"!==",we,"){",Ee,"}");x(Ee)}),d.compile()}(),compile:Ne}}function G0(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var F0=34918,D0=34919,Wf=35007,P0=function(i,u){if(!u.ext_disjoint_timer_query)return null;var b=[];function P(){return b.pop()||u.ext_disjoint_timer_query.createQueryEXT()}function U(ee){b.push(ee)}var D=[];function N(ee){var me=P();u.ext_disjoint_timer_query.beginQueryEXT(Wf,me),D.push(me),Z(D.length-1,D.length,ee)}function Q(){u.ext_disjoint_timer_query.endQueryEXT(Wf)}function Y(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var ne=[];function ae(){return ne.pop()||new Y}function te(ee){ne.push(ee)}var se=[];function Z(ee,me,W){var de=ae();de.startQueryIndex=ee,de.endQueryIndex=me,de.sum=0,de.stats=W,se.push(de)}var re=[],S=[];function $(){var ee,me,W=D.length;if(W!==0){S.length=Math.max(S.length,W+1),re.length=Math.max(re.length,W+1),re[0]=0,S[0]=0;var de=0;for(ee=0,me=0;me<D.length;++me){var ue=D[me];u.ext_disjoint_timer_query.getQueryObjectEXT(ue,D0)?(de+=u.ext_disjoint_timer_query.getQueryObjectEXT(ue,F0),U(ue)):D[ee++]=ue,re[me+1]=de,S[me+1]=ee}for(D.length=ee,ee=0,me=0;me<se.length;++me){var Ae=se[me],q=Ae.startQueryIndex,z=Ae.endQueryIndex;Ae.sum+=re[z]-re[q];var _e=S[q],ce=S[z];ce===_e?(Ae.stats.gpuTime+=Ae.sum/1e6,te(Ae)):(Ae.startQueryIndex=_e,Ae.endQueryIndex=ce,se[ee++]=Ae)}se.length=ee}}return{beginQuery:N,endQuery:Q,pushScopeStats:Z,update:$,getNumPendingQueries:function(){return D.length},clear:function(){b.push.apply(b,D);for(var ee=0;ee<b.length;ee++)u.ext_disjoint_timer_query.deleteQueryEXT(b[ee]);D.length=0,b.length=0},restore:function(){D.length=0,b.length=0}}},I0=16384,$0=256,N0=1024,B0=34962,Yf="webglcontextlost",Qf="webglcontextrestored",Kf=1,k0=2,z0=3;function Zf(i,u){for(var b=0;b<i.length;++b)if(i[b]===u)return b;return-1}function U0(i){var u=Bc(i);if(!u)return null;var b=u.gl,P=b.getContextAttributes(),U=b.isContextLost(),D=kc(b,u);if(!D)return null;var N=Dc(),Q=G0(),Y=D.extensions,ne=P0(b,Y),ae=ii(),te=b.drawingBufferWidth,se=b.drawingBufferHeight,Z={tick:0,time:0,viewportWidth:te,viewportHeight:se,framebufferWidth:te,framebufferHeight:se,drawingBufferWidth:te,drawingBufferHeight:se,pixelRatio:u.pixelRatio},re={},S={elements:null,primitive:4,count:-1,offset:0,instances:-1},$=wl(b,Y),ee=Vl(b,Q,u,de),me=ro(b,Y,ee,Q),W=n0(b,Y,$,Q,ee,me,S);function de(Te){return W.destroyBuffer(Te)}var ue=f0(b,N,Q,u),Ae=Fo(b,Y,$,function(){_e.procs.poll()},Z,Q,u),q=Do(b,Y,$,Q,u),z=e0(b,Y,$,Ae,q,Q),_e=C0(b,N,Y,$,ee,me,Ae,z,re,W,ue,S,Z,ne,u),ce=l0(b,z,_e.procs.poll,Z,P,Y,$),J=_e.next,le=b.canvas,oe=[],Fe=[],Le=[],ve=[u.onDestroy],he=null;function Me(){if(oe.length===0){ne&&ne.update(),he=null;return}he=kt.next(Me),hr();for(var Te=oe.length-1;Te>=0;--Te){var ke=oe[Te];ke&&ke(Z,null,0)}b.flush(),ne&&ne.update()}function De(){!he&&oe.length>0&&(he=kt.next(Me))}function Be(){he&&(kt.cancel(Me),he=null)}function Je(Te){Te.preventDefault(),U=!0,Be(),Fe.forEach(function(ke){ke()})}function nr(Te){b.getError(),U=!1,D.restore(),ue.restore(),ee.restore(),Ae.restore(),q.restore(),z.restore(),W.restore(),ne&&ne.restore(),_e.procs.refresh(),De(),Le.forEach(function(ke){ke()})}le&&(le.addEventListener(Yf,Je,!1),le.addEventListener(Qf,nr,!1));function ze(){oe.length=0,Be(),le&&(le.removeEventListener(Yf,Je),le.removeEventListener(Qf,nr)),ue.clear(),z.clear(),q.clear(),W.clear(),Ae.clear(),me.clear(),ee.clear(),ne&&ne.clear(),ve.forEach(function(Te){Te()})}function cr(Te){v(!!Te,"invalid args to regl({...})"),v.type(Te,"object","invalid args to regl({...})");function ke(w){var T=t({},w);delete T.uniforms,delete T.attributes,delete T.context,delete T.vao,"stencil"in T&&T.stencil.op&&(T.stencil.opBack=T.stencil.opFront=T.stencil.op,delete T.stencil.op);function A(g){if(g in T){var h=T[g];delete T[g],Object.keys(h).forEach(function(_){T[g+"."+_]=h[_]})}}return A("blend"),A("depth"),A("cull"),A("stencil"),A("polygonOffset"),A("scissor"),A("sample"),"vao"in w&&(T.vao=w.vao),T}function Ue(w,T){var A={},g={};return Object.keys(w).forEach(function(h){var _=w[h];if(Ar.isDynamic(_)){g[h]=Ar.unbox(_,h);return}else if(T&&Array.isArray(_)){for(var p=0;p<_.length;++p)if(Ar.isDynamic(_[p])){g[h]=Ar.unbox(_,h);return}}A[h]=_}),{dynamic:g,static:A}}var ar=Ue(Te.context||{},!0),Fr=Ue(Te.uniforms||{},!0),ln=Ue(Te.attributes||{},!1),y=Ue(ke(Te),!1),I={gpuTime:0,cpuTime:0,count:0},C=_e.compile(y,ln,Fr,ar,I),ye=C.draw,Ne=C.batch,d=C.scope,l=[];function x(w){for(;l.length<w;)l.push(null);return l}function M(w,T){var A;if(U&&v.raise("context lost"),typeof w=="function")return d.call(this,null,w,0);if(typeof T=="function")if(typeof w=="number")for(A=0;A<w;++A)d.call(this,null,T,A);else if(Array.isArray(w))for(A=0;A<w.length;++A)d.call(this,w[A],T,A);else return d.call(this,w,T,0);else if(typeof w=="number"){if(w>0)return Ne.call(this,x(w|0),w|0)}else if(Array.isArray(w)){if(w.length)return Ne.call(this,w,w.length)}else return ye.call(this,w)}return t(M,{stats:I,destroy:function(){C.destroy()}})}var Ye=z.setFBO=cr({framebuffer:Ar.define.call(null,Kf,"framebuffer")});function sr(Te,ke){var Ue=0;_e.procs.poll();var ar=ke.color;ar&&(b.clearColor(+ar[0]||0,+ar[1]||0,+ar[2]||0,+ar[3]||0),Ue|=I0),"depth"in ke&&(b.clearDepth(+ke.depth),Ue|=$0),"stencil"in ke&&(b.clearStencil(ke.stencil|0),Ue|=N0),v(!!Ue,"called regl.clear with no buffer specified"),b.clear(Ue)}function lr(Te){if(v(typeof Te=="object"&&Te,"regl.clear() takes an object as input"),"framebuffer"in Te)if(Te.framebuffer&&Te.framebuffer_reglType==="framebufferCube")for(var ke=0;ke<6;++ke)Ye(t({framebuffer:Te.framebuffer.faces[ke]},Te),sr);else Ye(Te,sr);else sr(null,Te)}function or(Te){v.type(Te,"function","regl.frame() callback must be a function"),oe.push(Te);function ke(){var Ue=Zf(oe,Te);v(Ue>=0,"cannot cancel a frame twice");function ar(){var Fr=Zf(oe,ar);oe[Fr]=oe[oe.length-1],oe.length-=1,oe.length<=0&&Be()}oe[Ue]=ar}return De(),{cancel:ke}}function vr(){var Te=J.viewport,ke=J.scissor_box;Te[0]=Te[1]=ke[0]=ke[1]=0,Z.viewportWidth=Z.framebufferWidth=Z.drawingBufferWidth=Te[2]=ke[2]=b.drawingBufferWidth,Z.viewportHeight=Z.framebufferHeight=Z.drawingBufferHeight=Te[3]=ke[3]=b.drawingBufferHeight}function hr(){Z.tick+=1,Z.time=Ie(),vr(),_e.procs.poll()}function tr(){Ae.refresh(),vr(),_e.procs.refresh(),ne&&ne.update()}function Ie(){return(ii()-ae)/1e3}tr();function mr(Te,ke){v.type(ke,"function","listener callback must be a function");var Ue;switch(Te){case"frame":return or(ke);case"lost":Ue=Fe;break;case"restore":Ue=Le;break;case"destroy":Ue=ve;break;default:v.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ue.push(ke),{cancel:function(){for(var ar=0;ar<Ue.length;++ar)if(Ue[ar]===ke){Ue[ar]=Ue[Ue.length-1],Ue.pop();return}}}}var je=t(cr,{clear:lr,prop:Ar.define.bind(null,Kf),context:Ar.define.bind(null,k0),this:Ar.define.bind(null,z0),draw:cr({}),buffer:function(Te){return ee.create(Te,B0,!1,!1)},elements:function(Te){return me.create(Te,!1)},texture:Ae.create2D,cube:Ae.createCube,renderbuffer:q.create,framebuffer:z.create,framebufferCube:z.createCube,vao:W.createVAO,attributes:P,frame:or,on:mr,limits:$,hasExtension:function(Te){return $.extensions.indexOf(Te.toLowerCase())>=0},read:ce,destroy:ze,_gl:b,_refresh:tr,poll:function(){hr(),ne&&ne.update()},now:Ie,stats:Q});return u.onDone(null,je),je}return U0})})(ts);var Y0=ts.exports;const Q0=ns(Y0);var ge=1e-6,Ve=typeof Float32Array<"u"?Float32Array:Array,Or=Math.random;function K0(e){Ve=e}var Z0=Math.PI/180;function J0(e){return e*Z0}function eu(e,r){return Math.abs(e-r)<=ge*Math.max(1,Math.abs(e),Math.abs(r))}const ru=Object.freeze(Object.defineProperty({__proto__:null,get ARRAY_TYPE(){return Ve},EPSILON:ge,RANDOM:Or,equals:eu,setMatrixArrayType:K0,toRadian:J0},Symbol.toStringTag,{value:"Module"}));function nu(){var e=new Ve(4);return Ve!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function tu(e){var r=new Ve(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function au(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function iu(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function fu(e,r,n,t){var a=new Ve(4);return a[0]=e,a[1]=r,a[2]=n,a[3]=t,a}function su(e,r,n,t,a){return e[0]=r,e[1]=n,e[2]=t,e[3]=a,e}function cu(e,r){if(e===r){var n=r[1];e[1]=r[2],e[2]=n}else e[0]=r[0],e[1]=r[2],e[2]=r[1],e[3]=r[3];return e}function lu(e,r){var n=r[0],t=r[1],a=r[2],f=r[3],s=n*f-a*t;return s?(s=1/s,e[0]=f*s,e[1]=-t*s,e[2]=-a*s,e[3]=n*s,e):null}function ou(e,r){var n=r[0];return e[0]=r[3],e[1]=-r[1],e[2]=-r[2],e[3]=n,e}function uu(e){return e[0]*e[3]-e[2]*e[1]}function as(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=n[0],o=n[1],m=n[2],E=n[3];return e[0]=t*c+f*o,e[1]=a*c+s*o,e[2]=t*m+f*E,e[3]=a*m+s*E,e}function vu(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=Math.sin(n),o=Math.cos(n);return e[0]=t*o+f*c,e[1]=a*o+s*c,e[2]=t*-c+f*o,e[3]=a*-c+s*o,e}function du(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=n[0],o=n[1];return e[0]=t*c,e[1]=a*c,e[2]=f*o,e[3]=s*o,e}function hu(e,r){var n=Math.sin(r),t=Math.cos(r);return e[0]=t,e[1]=n,e[2]=-n,e[3]=t,e}function mu(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=r[1],e}function pu(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function yu(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))}function _u(e,r,n,t){return e[2]=t[2]/t[0],n[0]=t[0],n[1]=t[1],n[3]=t[3]-e[2]*n[1],[e,r,n]}function bu(e,r,n){return e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e[3]=r[3]+n[3],e}function is(e,r,n){return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e[2]=r[2]-n[2],e[3]=r[3]-n[3],e}function xu(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}function Eu(e,r){var n=e[0],t=e[1],a=e[2],f=e[3],s=r[0],c=r[1],o=r[2],m=r[3];return Math.abs(n-s)<=ge*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(t-c)<=ge*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(a-o)<=ge*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(f-m)<=ge*Math.max(1,Math.abs(f),Math.abs(m))}function Au(e,r,n){return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e}function Tu(e,r,n,t){return e[0]=r[0]+n[0]*t,e[1]=r[1]+n[1]*t,e[2]=r[2]+n[2]*t,e[3]=r[3]+n[3]*t,e}var gu=as,Mu=is;const Su=Object.freeze(Object.defineProperty({__proto__:null,LDU:_u,add:bu,adjoint:ou,clone:tu,copy:au,create:nu,determinant:uu,equals:Eu,exactEquals:xu,frob:yu,fromRotation:hu,fromScaling:mu,fromValues:fu,identity:iu,invert:lu,mul:gu,multiply:as,multiplyScalar:Au,multiplyScalarAndAdd:Tu,rotate:vu,scale:du,set:su,str:pu,sub:Mu,subtract:is,transpose:cu},Symbol.toStringTag,{value:"Module"}));function wu(){var e=new Ve(6);return Ve!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function Lu(e){var r=new Ve(6);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r}function Ru(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e}function Ou(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function Cu(e,r,n,t,a,f){var s=new Ve(6);return s[0]=e,s[1]=r,s[2]=n,s[3]=t,s[4]=a,s[5]=f,s}function Gu(e,r,n,t,a,f,s){return e[0]=r,e[1]=n,e[2]=t,e[3]=a,e[4]=f,e[5]=s,e}function Fu(e,r){var n=r[0],t=r[1],a=r[2],f=r[3],s=r[4],c=r[5],o=n*f-t*a;return o?(o=1/o,e[0]=f*o,e[1]=-t*o,e[2]=-a*o,e[3]=n*o,e[4]=(a*c-f*s)*o,e[5]=(t*s-n*c)*o,e):null}function Du(e){return e[0]*e[3]-e[1]*e[2]}function fs(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=r[4],o=r[5],m=n[0],E=n[1],R=n[2],G=n[3],F=n[4],V=n[5];return e[0]=t*m+f*E,e[1]=a*m+s*E,e[2]=t*R+f*G,e[3]=a*R+s*G,e[4]=t*F+f*V+c,e[5]=a*F+s*V+o,e}function Pu(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=r[4],o=r[5],m=Math.sin(n),E=Math.cos(n);return e[0]=t*E+f*m,e[1]=a*E+s*m,e[2]=t*-m+f*E,e[3]=a*-m+s*E,e[4]=c,e[5]=o,e}function Iu(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=r[4],o=r[5],m=n[0],E=n[1];return e[0]=t*m,e[1]=a*m,e[2]=f*E,e[3]=s*E,e[4]=c,e[5]=o,e}function $u(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=r[4],o=r[5],m=n[0],E=n[1];return e[0]=t,e[1]=a,e[2]=f,e[3]=s,e[4]=t*m+f*E+c,e[5]=a*m+s*E+o,e}function Nu(e,r){var n=Math.sin(r),t=Math.cos(r);return e[0]=t,e[1]=n,e[2]=-n,e[3]=t,e[4]=0,e[5]=0,e}function Bu(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=r[1],e[4]=0,e[5]=0,e}function ku(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=r[0],e[5]=r[1],e}function zu(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function Uu(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)}function Vu(e,r,n){return e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e[3]=r[3]+n[3],e[4]=r[4]+n[4],e[5]=r[5]+n[5],e}function ss(e,r,n){return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e[2]=r[2]-n[2],e[3]=r[3]-n[3],e[4]=r[4]-n[4],e[5]=r[5]-n[5],e}function ju(e,r,n){return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*n,e[5]=r[5]*n,e}function qu(e,r,n,t){return e[0]=r[0]+n[0]*t,e[1]=r[1]+n[1]*t,e[2]=r[2]+n[2]*t,e[3]=r[3]+n[3]*t,e[4]=r[4]+n[4]*t,e[5]=r[5]+n[5]*t,e}function Xu(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]}function Hu(e,r){var n=e[0],t=e[1],a=e[2],f=e[3],s=e[4],c=e[5],o=r[0],m=r[1],E=r[2],R=r[3],G=r[4],F=r[5];return Math.abs(n-o)<=ge*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(t-m)<=ge*Math.max(1,Math.abs(t),Math.abs(m))&&Math.abs(a-E)<=ge*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(f-R)<=ge*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(s-G)<=ge*Math.max(1,Math.abs(s),Math.abs(G))&&Math.abs(c-F)<=ge*Math.max(1,Math.abs(c),Math.abs(F))}var Wu=fs,Yu=ss;const Qu=Object.freeze(Object.defineProperty({__proto__:null,add:Vu,clone:Lu,copy:Ru,create:wu,determinant:Du,equals:Hu,exactEquals:Xu,frob:Uu,fromRotation:Nu,fromScaling:Bu,fromTranslation:ku,fromValues:Cu,identity:Ou,invert:Fu,mul:Wu,multiply:fs,multiplyScalar:ju,multiplyScalarAndAdd:qu,rotate:Pu,scale:Iu,set:Gu,str:zu,sub:Yu,subtract:ss,translate:$u},Symbol.toStringTag,{value:"Module"}));function cs(){var e=new Ve(9);return Ve!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Ku(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[4],e[4]=r[5],e[5]=r[6],e[6]=r[8],e[7]=r[9],e[8]=r[10],e}function Zu(e){var r=new Ve(9);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function Ju(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function e1(e,r,n,t,a,f,s,c,o){var m=new Ve(9);return m[0]=e,m[1]=r,m[2]=n,m[3]=t,m[4]=a,m[5]=f,m[6]=s,m[7]=c,m[8]=o,m}function r1(e,r,n,t,a,f,s,c,o,m){return e[0]=r,e[1]=n,e[2]=t,e[3]=a,e[4]=f,e[5]=s,e[6]=c,e[7]=o,e[8]=m,e}function n1(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function t1(e,r){if(e===r){var n=r[1],t=r[2],a=r[5];e[1]=r[3],e[2]=r[6],e[3]=n,e[5]=r[7],e[6]=t,e[7]=a}else e[0]=r[0],e[1]=r[3],e[2]=r[6],e[3]=r[1],e[4]=r[4],e[5]=r[7],e[6]=r[2],e[7]=r[5],e[8]=r[8];return e}function a1(e,r){var n=r[0],t=r[1],a=r[2],f=r[3],s=r[4],c=r[5],o=r[6],m=r[7],E=r[8],R=E*s-c*m,G=-E*f+c*o,F=m*f-s*o,V=n*R+t*G+a*F;return V?(V=1/V,e[0]=R*V,e[1]=(-E*t+a*m)*V,e[2]=(c*t-a*s)*V,e[3]=G*V,e[4]=(E*n-a*o)*V,e[5]=(-c*n+a*f)*V,e[6]=F*V,e[7]=(-m*n+t*o)*V,e[8]=(s*n-t*f)*V,e):null}function i1(e,r){var n=r[0],t=r[1],a=r[2],f=r[3],s=r[4],c=r[5],o=r[6],m=r[7],E=r[8];return e[0]=s*E-c*m,e[1]=a*m-t*E,e[2]=t*c-a*s,e[3]=c*o-f*E,e[4]=n*E-a*o,e[5]=a*f-n*c,e[6]=f*m-s*o,e[7]=t*o-n*m,e[8]=n*s-t*f,e}function f1(e){var r=e[0],n=e[1],t=e[2],a=e[3],f=e[4],s=e[5],c=e[6],o=e[7],m=e[8];return r*(m*f-s*o)+n*(-m*a+s*c)+t*(o*a-f*c)}function ls(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=r[4],o=r[5],m=r[6],E=r[7],R=r[8],G=n[0],F=n[1],V=n[2],K=n[3],j=n[4],fe=n[5],Ge=n[6],Re=n[7],Ce=n[8];return e[0]=G*t+F*s+V*m,e[1]=G*a+F*c+V*E,e[2]=G*f+F*o+V*R,e[3]=K*t+j*s+fe*m,e[4]=K*a+j*c+fe*E,e[5]=K*f+j*o+fe*R,e[6]=Ge*t+Re*s+Ce*m,e[7]=Ge*a+Re*c+Ce*E,e[8]=Ge*f+Re*o+Ce*R,e}function s1(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=r[4],o=r[5],m=r[6],E=r[7],R=r[8],G=n[0],F=n[1];return e[0]=t,e[1]=a,e[2]=f,e[3]=s,e[4]=c,e[5]=o,e[6]=G*t+F*s+m,e[7]=G*a+F*c+E,e[8]=G*f+F*o+R,e}function c1(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=r[4],o=r[5],m=r[6],E=r[7],R=r[8],G=Math.sin(n),F=Math.cos(n);return e[0]=F*t+G*s,e[1]=F*a+G*c,e[2]=F*f+G*o,e[3]=F*s-G*t,e[4]=F*c-G*a,e[5]=F*o-G*f,e[6]=m,e[7]=E,e[8]=R,e}function l1(e,r,n){var t=n[0],a=n[1];return e[0]=t*r[0],e[1]=t*r[1],e[2]=t*r[2],e[3]=a*r[3],e[4]=a*r[4],e[5]=a*r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function o1(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=r[0],e[7]=r[1],e[8]=1,e}function u1(e,r){var n=Math.sin(r),t=Math.cos(r);return e[0]=t,e[1]=n,e[2]=0,e[3]=-n,e[4]=t,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function v1(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=r[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function d1(e,r){return e[0]=r[0],e[1]=r[1],e[2]=0,e[3]=r[2],e[4]=r[3],e[5]=0,e[6]=r[4],e[7]=r[5],e[8]=1,e}function h1(e,r){var n=r[0],t=r[1],a=r[2],f=r[3],s=n+n,c=t+t,o=a+a,m=n*s,E=t*s,R=t*c,G=a*s,F=a*c,V=a*o,K=f*s,j=f*c,fe=f*o;return e[0]=1-R-V,e[3]=E-fe,e[6]=G+j,e[1]=E+fe,e[4]=1-m-V,e[7]=F-K,e[2]=G-j,e[5]=F+K,e[8]=1-m-R,e}function m1(e,r){var n=r[0],t=r[1],a=r[2],f=r[3],s=r[4],c=r[5],o=r[6],m=r[7],E=r[8],R=r[9],G=r[10],F=r[11],V=r[12],K=r[13],j=r[14],fe=r[15],Ge=n*c-t*s,Re=n*o-a*s,Ce=n*m-f*s,Oe=t*o-a*c,Pe=t*m-f*c,He=a*m-f*o,Qe=E*K-R*V,Ke=E*j-G*V,Xe=E*fe-F*V,er=R*j-G*K,We=R*fe-F*K,rr=G*fe-F*j,$e=Ge*rr-Re*We+Ce*er+Oe*Xe-Pe*Ke+He*Qe;return $e?($e=1/$e,e[0]=(c*rr-o*We+m*er)*$e,e[1]=(o*Xe-s*rr-m*Ke)*$e,e[2]=(s*We-c*Xe+m*Qe)*$e,e[3]=(a*We-t*rr-f*er)*$e,e[4]=(n*rr-a*Xe+f*Ke)*$e,e[5]=(t*Xe-n*We-f*Qe)*$e,e[6]=(K*He-j*Pe+fe*Oe)*$e,e[7]=(j*Ce-V*He-fe*Re)*$e,e[8]=(V*Pe-K*Ce+fe*Ge)*$e,e):null}function p1(e,r,n){return e[0]=2/r,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function y1(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function _1(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}function b1(e,r,n){return e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e[3]=r[3]+n[3],e[4]=r[4]+n[4],e[5]=r[5]+n[5],e[6]=r[6]+n[6],e[7]=r[7]+n[7],e[8]=r[8]+n[8],e}function os(e,r,n){return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e[2]=r[2]-n[2],e[3]=r[3]-n[3],e[4]=r[4]-n[4],e[5]=r[5]-n[5],e[6]=r[6]-n[6],e[7]=r[7]-n[7],e[8]=r[8]-n[8],e}function x1(e,r,n){return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*n,e[5]=r[5]*n,e[6]=r[6]*n,e[7]=r[7]*n,e[8]=r[8]*n,e}function E1(e,r,n,t){return e[0]=r[0]+n[0]*t,e[1]=r[1]+n[1]*t,e[2]=r[2]+n[2]*t,e[3]=r[3]+n[3]*t,e[4]=r[4]+n[4]*t,e[5]=r[5]+n[5]*t,e[6]=r[6]+n[6]*t,e[7]=r[7]+n[7]*t,e[8]=r[8]+n[8]*t,e}function A1(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]}function T1(e,r){var n=e[0],t=e[1],a=e[2],f=e[3],s=e[4],c=e[5],o=e[6],m=e[7],E=e[8],R=r[0],G=r[1],F=r[2],V=r[3],K=r[4],j=r[5],fe=r[6],Ge=r[7],Re=r[8];return Math.abs(n-R)<=ge*Math.max(1,Math.abs(n),Math.abs(R))&&Math.abs(t-G)<=ge*Math.max(1,Math.abs(t),Math.abs(G))&&Math.abs(a-F)<=ge*Math.max(1,Math.abs(a),Math.abs(F))&&Math.abs(f-V)<=ge*Math.max(1,Math.abs(f),Math.abs(V))&&Math.abs(s-K)<=ge*Math.max(1,Math.abs(s),Math.abs(K))&&Math.abs(c-j)<=ge*Math.max(1,Math.abs(c),Math.abs(j))&&Math.abs(o-fe)<=ge*Math.max(1,Math.abs(o),Math.abs(fe))&&Math.abs(m-Ge)<=ge*Math.max(1,Math.abs(m),Math.abs(Ge))&&Math.abs(E-Re)<=ge*Math.max(1,Math.abs(E),Math.abs(Re))}var g1=ls,M1=os;const S1=Object.freeze(Object.defineProperty({__proto__:null,add:b1,adjoint:i1,clone:Zu,copy:Ju,create:cs,determinant:f1,equals:T1,exactEquals:A1,frob:_1,fromMat2d:d1,fromMat4:Ku,fromQuat:h1,fromRotation:u1,fromScaling:v1,fromTranslation:o1,fromValues:e1,identity:n1,invert:a1,mul:g1,multiply:ls,multiplyScalar:x1,multiplyScalarAndAdd:E1,normalFromMat4:m1,projection:p1,rotate:c1,scale:l1,set:r1,str:y1,sub:M1,subtract:os,translate:s1,transpose:t1},Symbol.toStringTag,{value:"Module"}));function w1(){var e=new Ve(16);return Ve!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function L1(e){var r=new Ve(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function R1(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function O1(e,r,n,t,a,f,s,c,o,m,E,R,G,F,V,K){var j=new Ve(16);return j[0]=e,j[1]=r,j[2]=n,j[3]=t,j[4]=a,j[5]=f,j[6]=s,j[7]=c,j[8]=o,j[9]=m,j[10]=E,j[11]=R,j[12]=G,j[13]=F,j[14]=V,j[15]=K,j}function C1(e,r,n,t,a,f,s,c,o,m,E,R,G,F,V,K,j){return e[0]=r,e[1]=n,e[2]=t,e[3]=a,e[4]=f,e[5]=s,e[6]=c,e[7]=o,e[8]=m,e[9]=E,e[10]=R,e[11]=G,e[12]=F,e[13]=V,e[14]=K,e[15]=j,e}function us(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function G1(e,r){if(e===r){var n=r[1],t=r[2],a=r[3],f=r[6],s=r[7],c=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=n,e[6]=r[9],e[7]=r[13],e[8]=t,e[9]=f,e[11]=r[14],e[12]=a,e[13]=s,e[14]=c}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function F1(e,r){var n=r[0],t=r[1],a=r[2],f=r[3],s=r[4],c=r[5],o=r[6],m=r[7],E=r[8],R=r[9],G=r[10],F=r[11],V=r[12],K=r[13],j=r[14],fe=r[15],Ge=n*c-t*s,Re=n*o-a*s,Ce=n*m-f*s,Oe=t*o-a*c,Pe=t*m-f*c,He=a*m-f*o,Qe=E*K-R*V,Ke=E*j-G*V,Xe=E*fe-F*V,er=R*j-G*K,We=R*fe-F*K,rr=G*fe-F*j,$e=Ge*rr-Re*We+Ce*er+Oe*Xe-Pe*Ke+He*Qe;return $e?($e=1/$e,e[0]=(c*rr-o*We+m*er)*$e,e[1]=(a*We-t*rr-f*er)*$e,e[2]=(K*He-j*Pe+fe*Oe)*$e,e[3]=(G*Pe-R*He-F*Oe)*$e,e[4]=(o*Xe-s*rr-m*Ke)*$e,e[5]=(n*rr-a*Xe+f*Ke)*$e,e[6]=(j*Ce-V*He-fe*Re)*$e,e[7]=(E*He-G*Ce+F*Re)*$e,e[8]=(s*We-c*Xe+m*Qe)*$e,e[9]=(t*Xe-n*We-f*Qe)*$e,e[10]=(V*Pe-K*Ce+fe*Ge)*$e,e[11]=(R*Ce-E*Pe-F*Ge)*$e,e[12]=(c*Ke-s*er-o*Qe)*$e,e[13]=(n*er-t*Ke+a*Qe)*$e,e[14]=(K*Re-V*Oe-j*Ge)*$e,e[15]=(E*Oe-R*Re+G*Ge)*$e,e):null}function D1(e,r){var n=r[0],t=r[1],a=r[2],f=r[3],s=r[4],c=r[5],o=r[6],m=r[7],E=r[8],R=r[9],G=r[10],F=r[11],V=r[12],K=r[13],j=r[14],fe=r[15];return e[0]=c*(G*fe-F*j)-R*(o*fe-m*j)+K*(o*F-m*G),e[1]=-(t*(G*fe-F*j)-R*(a*fe-f*j)+K*(a*F-f*G)),e[2]=t*(o*fe-m*j)-c*(a*fe-f*j)+K*(a*m-f*o),e[3]=-(t*(o*F-m*G)-c*(a*F-f*G)+R*(a*m-f*o)),e[4]=-(s*(G*fe-F*j)-E*(o*fe-m*j)+V*(o*F-m*G)),e[5]=n*(G*fe-F*j)-E*(a*fe-f*j)+V*(a*F-f*G),e[6]=-(n*(o*fe-m*j)-s*(a*fe-f*j)+V*(a*m-f*o)),e[7]=n*(o*F-m*G)-s*(a*F-f*G)+E*(a*m-f*o),e[8]=s*(R*fe-F*K)-E*(c*fe-m*K)+V*(c*F-m*R),e[9]=-(n*(R*fe-F*K)-E*(t*fe-f*K)+V*(t*F-f*R)),e[10]=n*(c*fe-m*K)-s*(t*fe-f*K)+V*(t*m-f*c),e[11]=-(n*(c*F-m*R)-s*(t*F-f*R)+E*(t*m-f*c)),e[12]=-(s*(R*j-G*K)-E*(c*j-o*K)+V*(c*G-o*R)),e[13]=n*(R*j-G*K)-E*(t*j-a*K)+V*(t*G-a*R),e[14]=-(n*(c*j-o*K)-s*(t*j-a*K)+V*(t*o-a*c)),e[15]=n*(c*G-o*R)-s*(t*G-a*R)+E*(t*o-a*c),e}function P1(e){var r=e[0],n=e[1],t=e[2],a=e[3],f=e[4],s=e[5],c=e[6],o=e[7],m=e[8],E=e[9],R=e[10],G=e[11],F=e[12],V=e[13],K=e[14],j=e[15],fe=r*s-n*f,Ge=r*c-t*f,Re=r*o-a*f,Ce=n*c-t*s,Oe=n*o-a*s,Pe=t*o-a*c,He=m*V-E*F,Qe=m*K-R*F,Ke=m*j-G*F,Xe=E*K-R*V,er=E*j-G*V,We=R*j-G*K;return fe*We-Ge*er+Re*Xe+Ce*Ke-Oe*Qe+Pe*He}function vs(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=r[4],o=r[5],m=r[6],E=r[7],R=r[8],G=r[9],F=r[10],V=r[11],K=r[12],j=r[13],fe=r[14],Ge=r[15],Re=n[0],Ce=n[1],Oe=n[2],Pe=n[3];return e[0]=Re*t+Ce*c+Oe*R+Pe*K,e[1]=Re*a+Ce*o+Oe*G+Pe*j,e[2]=Re*f+Ce*m+Oe*F+Pe*fe,e[3]=Re*s+Ce*E+Oe*V+Pe*Ge,Re=n[4],Ce=n[5],Oe=n[6],Pe=n[7],e[4]=Re*t+Ce*c+Oe*R+Pe*K,e[5]=Re*a+Ce*o+Oe*G+Pe*j,e[6]=Re*f+Ce*m+Oe*F+Pe*fe,e[7]=Re*s+Ce*E+Oe*V+Pe*Ge,Re=n[8],Ce=n[9],Oe=n[10],Pe=n[11],e[8]=Re*t+Ce*c+Oe*R+Pe*K,e[9]=Re*a+Ce*o+Oe*G+Pe*j,e[10]=Re*f+Ce*m+Oe*F+Pe*fe,e[11]=Re*s+Ce*E+Oe*V+Pe*Ge,Re=n[12],Ce=n[13],Oe=n[14],Pe=n[15],e[12]=Re*t+Ce*c+Oe*R+Pe*K,e[13]=Re*a+Ce*o+Oe*G+Pe*j,e[14]=Re*f+Ce*m+Oe*F+Pe*fe,e[15]=Re*s+Ce*E+Oe*V+Pe*Ge,e}function I1(e,r,n){var t=n[0],a=n[1],f=n[2],s=void 0,c=void 0,o=void 0,m=void 0,E=void 0,R=void 0,G=void 0,F=void 0,V=void 0,K=void 0,j=void 0,fe=void 0;return r===e?(e[12]=r[0]*t+r[4]*a+r[8]*f+r[12],e[13]=r[1]*t+r[5]*a+r[9]*f+r[13],e[14]=r[2]*t+r[6]*a+r[10]*f+r[14],e[15]=r[3]*t+r[7]*a+r[11]*f+r[15]):(s=r[0],c=r[1],o=r[2],m=r[3],E=r[4],R=r[5],G=r[6],F=r[7],V=r[8],K=r[9],j=r[10],fe=r[11],e[0]=s,e[1]=c,e[2]=o,e[3]=m,e[4]=E,e[5]=R,e[6]=G,e[7]=F,e[8]=V,e[9]=K,e[10]=j,e[11]=fe,e[12]=s*t+E*a+V*f+r[12],e[13]=c*t+R*a+K*f+r[13],e[14]=o*t+G*a+j*f+r[14],e[15]=m*t+F*a+fe*f+r[15]),e}function $1(e,r,n){var t=n[0],a=n[1],f=n[2];return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*a,e[5]=r[5]*a,e[6]=r[6]*a,e[7]=r[7]*a,e[8]=r[8]*f,e[9]=r[9]*f,e[10]=r[10]*f,e[11]=r[11]*f,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function N1(e,r,n,t){var a=t[0],f=t[1],s=t[2],c=Math.sqrt(a*a+f*f+s*s),o=void 0,m=void 0,E=void 0,R=void 0,G=void 0,F=void 0,V=void 0,K=void 0,j=void 0,fe=void 0,Ge=void 0,Re=void 0,Ce=void 0,Oe=void 0,Pe=void 0,He=void 0,Qe=void 0,Ke=void 0,Xe=void 0,er=void 0,We=void 0,rr=void 0,$e=void 0,xr=void 0;return c<ge?null:(c=1/c,a*=c,f*=c,s*=c,o=Math.sin(n),m=Math.cos(n),E=1-m,R=r[0],G=r[1],F=r[2],V=r[3],K=r[4],j=r[5],fe=r[6],Ge=r[7],Re=r[8],Ce=r[9],Oe=r[10],Pe=r[11],He=a*a*E+m,Qe=f*a*E+s*o,Ke=s*a*E-f*o,Xe=a*f*E-s*o,er=f*f*E+m,We=s*f*E+a*o,rr=a*s*E+f*o,$e=f*s*E-a*o,xr=s*s*E+m,e[0]=R*He+K*Qe+Re*Ke,e[1]=G*He+j*Qe+Ce*Ke,e[2]=F*He+fe*Qe+Oe*Ke,e[3]=V*He+Ge*Qe+Pe*Ke,e[4]=R*Xe+K*er+Re*We,e[5]=G*Xe+j*er+Ce*We,e[6]=F*Xe+fe*er+Oe*We,e[7]=V*Xe+Ge*er+Pe*We,e[8]=R*rr+K*$e+Re*xr,e[9]=G*rr+j*$e+Ce*xr,e[10]=F*rr+fe*$e+Oe*xr,e[11]=V*rr+Ge*$e+Pe*xr,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function B1(e,r,n){var t=Math.sin(n),a=Math.cos(n),f=r[4],s=r[5],c=r[6],o=r[7],m=r[8],E=r[9],R=r[10],G=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=f*a+m*t,e[5]=s*a+E*t,e[6]=c*a+R*t,e[7]=o*a+G*t,e[8]=m*a-f*t,e[9]=E*a-s*t,e[10]=R*a-c*t,e[11]=G*a-o*t,e}function k1(e,r,n){var t=Math.sin(n),a=Math.cos(n),f=r[0],s=r[1],c=r[2],o=r[3],m=r[8],E=r[9],R=r[10],G=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=f*a-m*t,e[1]=s*a-E*t,e[2]=c*a-R*t,e[3]=o*a-G*t,e[8]=f*t+m*a,e[9]=s*t+E*a,e[10]=c*t+R*a,e[11]=o*t+G*a,e}function z1(e,r,n){var t=Math.sin(n),a=Math.cos(n),f=r[0],s=r[1],c=r[2],o=r[3],m=r[4],E=r[5],R=r[6],G=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=f*a+m*t,e[1]=s*a+E*t,e[2]=c*a+R*t,e[3]=o*a+G*t,e[4]=m*a-f*t,e[5]=E*a-s*t,e[6]=R*a-c*t,e[7]=G*a-o*t,e}function U1(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function V1(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=r[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function j1(e,r,n){var t=n[0],a=n[1],f=n[2],s=Math.sqrt(t*t+a*a+f*f),c=void 0,o=void 0,m=void 0;return s<ge?null:(s=1/s,t*=s,a*=s,f*=s,c=Math.sin(r),o=Math.cos(r),m=1-o,e[0]=t*t*m+o,e[1]=a*t*m+f*c,e[2]=f*t*m-a*c,e[3]=0,e[4]=t*a*m-f*c,e[5]=a*a*m+o,e[6]=f*a*m+t*c,e[7]=0,e[8]=t*f*m+a*c,e[9]=a*f*m-t*c,e[10]=f*f*m+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function q1(e,r){var n=Math.sin(r),t=Math.cos(r);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function X1(e,r){var n=Math.sin(r),t=Math.cos(r);return e[0]=t,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function H1(e,r){var n=Math.sin(r),t=Math.cos(r);return e[0]=t,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ds(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=t+t,o=a+a,m=f+f,E=t*c,R=t*o,G=t*m,F=a*o,V=a*m,K=f*m,j=s*c,fe=s*o,Ge=s*m;return e[0]=1-(F+K),e[1]=R+Ge,e[2]=G-fe,e[3]=0,e[4]=R-Ge,e[5]=1-(E+K),e[6]=V+j,e[7]=0,e[8]=G+fe,e[9]=V-j,e[10]=1-(E+F),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function W1(e,r){var n=new Ve(3),t=-r[0],a=-r[1],f=-r[2],s=r[3],c=r[4],o=r[5],m=r[6],E=r[7],R=t*t+a*a+f*f+s*s;return R>0?(n[0]=(c*s+E*t+o*f-m*a)*2/R,n[1]=(o*s+E*a+m*t-c*f)*2/R,n[2]=(m*s+E*f+c*a-o*t)*2/R):(n[0]=(c*s+E*t+o*f-m*a)*2,n[1]=(o*s+E*a+m*t-c*f)*2,n[2]=(m*s+E*f+c*a-o*t)*2),ds(e,r,n),e}function hs(e,r){return e[0]=r[12],e[1]=r[13],e[2]=r[14],e}function Y1(e,r){var n=r[0],t=r[1],a=r[2],f=r[4],s=r[5],c=r[6],o=r[8],m=r[9],E=r[10];return e[0]=Math.sqrt(n*n+t*t+a*a),e[1]=Math.sqrt(f*f+s*s+c*c),e[2]=Math.sqrt(o*o+m*m+E*E),e}function ms(e,r){var n=r[0]+r[5]+r[10],t=0;return n>0?(t=Math.sqrt(n+1)*2,e[3]=.25*t,e[0]=(r[6]-r[9])/t,e[1]=(r[8]-r[2])/t,e[2]=(r[1]-r[4])/t):r[0]>r[5]&&r[0]>r[10]?(t=Math.sqrt(1+r[0]-r[5]-r[10])*2,e[3]=(r[6]-r[9])/t,e[0]=.25*t,e[1]=(r[1]+r[4])/t,e[2]=(r[8]+r[2])/t):r[5]>r[10]?(t=Math.sqrt(1+r[5]-r[0]-r[10])*2,e[3]=(r[8]-r[2])/t,e[0]=(r[1]+r[4])/t,e[1]=.25*t,e[2]=(r[6]+r[9])/t):(t=Math.sqrt(1+r[10]-r[0]-r[5])*2,e[3]=(r[1]-r[4])/t,e[0]=(r[8]+r[2])/t,e[1]=(r[6]+r[9])/t,e[2]=.25*t),e}function Q1(e,r,n,t){var a=r[0],f=r[1],s=r[2],c=r[3],o=a+a,m=f+f,E=s+s,R=a*o,G=a*m,F=a*E,V=f*m,K=f*E,j=s*E,fe=c*o,Ge=c*m,Re=c*E,Ce=t[0],Oe=t[1],Pe=t[2];return e[0]=(1-(V+j))*Ce,e[1]=(G+Re)*Ce,e[2]=(F-Ge)*Ce,e[3]=0,e[4]=(G-Re)*Oe,e[5]=(1-(R+j))*Oe,e[6]=(K+fe)*Oe,e[7]=0,e[8]=(F+Ge)*Pe,e[9]=(K-fe)*Pe,e[10]=(1-(R+V))*Pe,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function K1(e,r,n,t,a){var f=r[0],s=r[1],c=r[2],o=r[3],m=f+f,E=s+s,R=c+c,G=f*m,F=f*E,V=f*R,K=s*E,j=s*R,fe=c*R,Ge=o*m,Re=o*E,Ce=o*R,Oe=t[0],Pe=t[1],He=t[2],Qe=a[0],Ke=a[1],Xe=a[2],er=(1-(K+fe))*Oe,We=(F+Ce)*Oe,rr=(V-Re)*Oe,$e=(F-Ce)*Pe,xr=(1-(G+fe))*Pe,Qr=(j+Ge)*Pe,Br=(V+Re)*He,Qn=(j-Ge)*He,Kn=(1-(G+K))*He;return e[0]=er,e[1]=We,e[2]=rr,e[3]=0,e[4]=$e,e[5]=xr,e[6]=Qr,e[7]=0,e[8]=Br,e[9]=Qn,e[10]=Kn,e[11]=0,e[12]=n[0]+Qe-(er*Qe+$e*Ke+Br*Xe),e[13]=n[1]+Ke-(We*Qe+xr*Ke+Qn*Xe),e[14]=n[2]+Xe-(rr*Qe+Qr*Ke+Kn*Xe),e[15]=1,e}function Z1(e,r){var n=r[0],t=r[1],a=r[2],f=r[3],s=n+n,c=t+t,o=a+a,m=n*s,E=t*s,R=t*c,G=a*s,F=a*c,V=a*o,K=f*s,j=f*c,fe=f*o;return e[0]=1-R-V,e[1]=E+fe,e[2]=G-j,e[3]=0,e[4]=E-fe,e[5]=1-m-V,e[6]=F+K,e[7]=0,e[8]=G+j,e[9]=F-K,e[10]=1-m-R,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function J1(e,r,n,t,a,f,s){var c=1/(n-r),o=1/(a-t),m=1/(f-s);return e[0]=f*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f*2*o,e[6]=0,e[7]=0,e[8]=(n+r)*c,e[9]=(a+t)*o,e[10]=(s+f)*m,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*f*2*m,e[15]=0,e}function ev(e,r,n,t,a){var f=1/Math.tan(r/2),s=void 0;return e[0]=f/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(s=1/(t-a),e[10]=(a+t)*s,e[14]=2*a*t*s):(e[10]=-1,e[14]=-2*t),e}function rv(e,r,n,t){var a=Math.tan(r.upDegrees*Math.PI/180),f=Math.tan(r.downDegrees*Math.PI/180),s=Math.tan(r.leftDegrees*Math.PI/180),c=Math.tan(r.rightDegrees*Math.PI/180),o=2/(s+c),m=2/(a+f);return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=m,e[6]=0,e[7]=0,e[8]=-((s-c)*o*.5),e[9]=(a-f)*m*.5,e[10]=t/(n-t),e[11]=-1,e[12]=0,e[13]=0,e[14]=t*n/(n-t),e[15]=0,e}function nv(e,r,n,t,a,f,s){var c=1/(r-n),o=1/(t-a),m=1/(f-s);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*m,e[11]=0,e[12]=(r+n)*c,e[13]=(a+t)*o,e[14]=(s+f)*m,e[15]=1,e}function tv(e,r,n,t){var a=void 0,f=void 0,s=void 0,c=void 0,o=void 0,m=void 0,E=void 0,R=void 0,G=void 0,F=void 0,V=r[0],K=r[1],j=r[2],fe=t[0],Ge=t[1],Re=t[2],Ce=n[0],Oe=n[1],Pe=n[2];return Math.abs(V-Ce)<ge&&Math.abs(K-Oe)<ge&&Math.abs(j-Pe)<ge?us(e):(E=V-Ce,R=K-Oe,G=j-Pe,F=1/Math.sqrt(E*E+R*R+G*G),E*=F,R*=F,G*=F,a=Ge*G-Re*R,f=Re*E-fe*G,s=fe*R-Ge*E,F=Math.sqrt(a*a+f*f+s*s),F?(F=1/F,a*=F,f*=F,s*=F):(a=0,f=0,s=0),c=R*s-G*f,o=G*a-E*s,m=E*f-R*a,F=Math.sqrt(c*c+o*o+m*m),F?(F=1/F,c*=F,o*=F,m*=F):(c=0,o=0,m=0),e[0]=a,e[1]=c,e[2]=E,e[3]=0,e[4]=f,e[5]=o,e[6]=R,e[7]=0,e[8]=s,e[9]=m,e[10]=G,e[11]=0,e[12]=-(a*V+f*K+s*j),e[13]=-(c*V+o*K+m*j),e[14]=-(E*V+R*K+G*j),e[15]=1,e)}function av(e,r,n,t){var a=r[0],f=r[1],s=r[2],c=t[0],o=t[1],m=t[2],E=a-n[0],R=f-n[1],G=s-n[2],F=E*E+R*R+G*G;F>0&&(F=1/Math.sqrt(F),E*=F,R*=F,G*=F);var V=o*G-m*R,K=m*E-c*G,j=c*R-o*E;return F=V*V+K*K+j*j,F>0&&(F=1/Math.sqrt(F),V*=F,K*=F,j*=F),e[0]=V,e[1]=K,e[2]=j,e[3]=0,e[4]=R*j-G*K,e[5]=G*V-E*j,e[6]=E*K-R*V,e[7]=0,e[8]=E,e[9]=R,e[10]=G,e[11]=0,e[12]=a,e[13]=f,e[14]=s,e[15]=1,e}function iv(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function fv(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}function sv(e,r,n){return e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e[3]=r[3]+n[3],e[4]=r[4]+n[4],e[5]=r[5]+n[5],e[6]=r[6]+n[6],e[7]=r[7]+n[7],e[8]=r[8]+n[8],e[9]=r[9]+n[9],e[10]=r[10]+n[10],e[11]=r[11]+n[11],e[12]=r[12]+n[12],e[13]=r[13]+n[13],e[14]=r[14]+n[14],e[15]=r[15]+n[15],e}function ps(e,r,n){return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e[2]=r[2]-n[2],e[3]=r[3]-n[3],e[4]=r[4]-n[4],e[5]=r[5]-n[5],e[6]=r[6]-n[6],e[7]=r[7]-n[7],e[8]=r[8]-n[8],e[9]=r[9]-n[9],e[10]=r[10]-n[10],e[11]=r[11]-n[11],e[12]=r[12]-n[12],e[13]=r[13]-n[13],e[14]=r[14]-n[14],e[15]=r[15]-n[15],e}function cv(e,r,n){return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*n,e[5]=r[5]*n,e[6]=r[6]*n,e[7]=r[7]*n,e[8]=r[8]*n,e[9]=r[9]*n,e[10]=r[10]*n,e[11]=r[11]*n,e[12]=r[12]*n,e[13]=r[13]*n,e[14]=r[14]*n,e[15]=r[15]*n,e}function lv(e,r,n,t){return e[0]=r[0]+n[0]*t,e[1]=r[1]+n[1]*t,e[2]=r[2]+n[2]*t,e[3]=r[3]+n[3]*t,e[4]=r[4]+n[4]*t,e[5]=r[5]+n[5]*t,e[6]=r[6]+n[6]*t,e[7]=r[7]+n[7]*t,e[8]=r[8]+n[8]*t,e[9]=r[9]+n[9]*t,e[10]=r[10]+n[10]*t,e[11]=r[11]+n[11]*t,e[12]=r[12]+n[12]*t,e[13]=r[13]+n[13]*t,e[14]=r[14]+n[14]*t,e[15]=r[15]+n[15]*t,e}function ov(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]&&e[9]===r[9]&&e[10]===r[10]&&e[11]===r[11]&&e[12]===r[12]&&e[13]===r[13]&&e[14]===r[14]&&e[15]===r[15]}function uv(e,r){var n=e[0],t=e[1],a=e[2],f=e[3],s=e[4],c=e[5],o=e[6],m=e[7],E=e[8],R=e[9],G=e[10],F=e[11],V=e[12],K=e[13],j=e[14],fe=e[15],Ge=r[0],Re=r[1],Ce=r[2],Oe=r[3],Pe=r[4],He=r[5],Qe=r[6],Ke=r[7],Xe=r[8],er=r[9],We=r[10],rr=r[11],$e=r[12],xr=r[13],Qr=r[14],Br=r[15];return Math.abs(n-Ge)<=ge*Math.max(1,Math.abs(n),Math.abs(Ge))&&Math.abs(t-Re)<=ge*Math.max(1,Math.abs(t),Math.abs(Re))&&Math.abs(a-Ce)<=ge*Math.max(1,Math.abs(a),Math.abs(Ce))&&Math.abs(f-Oe)<=ge*Math.max(1,Math.abs(f),Math.abs(Oe))&&Math.abs(s-Pe)<=ge*Math.max(1,Math.abs(s),Math.abs(Pe))&&Math.abs(c-He)<=ge*Math.max(1,Math.abs(c),Math.abs(He))&&Math.abs(o-Qe)<=ge*Math.max(1,Math.abs(o),Math.abs(Qe))&&Math.abs(m-Ke)<=ge*Math.max(1,Math.abs(m),Math.abs(Ke))&&Math.abs(E-Xe)<=ge*Math.max(1,Math.abs(E),Math.abs(Xe))&&Math.abs(R-er)<=ge*Math.max(1,Math.abs(R),Math.abs(er))&&Math.abs(G-We)<=ge*Math.max(1,Math.abs(G),Math.abs(We))&&Math.abs(F-rr)<=ge*Math.max(1,Math.abs(F),Math.abs(rr))&&Math.abs(V-$e)<=ge*Math.max(1,Math.abs(V),Math.abs($e))&&Math.abs(K-xr)<=ge*Math.max(1,Math.abs(K),Math.abs(xr))&&Math.abs(j-Qr)<=ge*Math.max(1,Math.abs(j),Math.abs(Qr))&&Math.abs(fe-Br)<=ge*Math.max(1,Math.abs(fe),Math.abs(Br))}var vv=vs,dv=ps;const hv=Object.freeze(Object.defineProperty({__proto__:null,add:sv,adjoint:D1,clone:L1,copy:R1,create:w1,determinant:P1,equals:uv,exactEquals:ov,frob:fv,fromQuat:Z1,fromQuat2:W1,fromRotation:j1,fromRotationTranslation:ds,fromRotationTranslationScale:Q1,fromRotationTranslationScaleOrigin:K1,fromScaling:V1,fromTranslation:U1,fromValues:O1,fromXRotation:q1,fromYRotation:X1,fromZRotation:H1,frustum:J1,getRotation:ms,getScaling:Y1,getTranslation:hs,identity:us,invert:F1,lookAt:tv,mul:vv,multiply:vs,multiplyScalar:cv,multiplyScalarAndAdd:lv,ortho:nv,perspective:ev,perspectiveFromFieldOfView:rv,rotate:N1,rotateX:B1,rotateY:k1,rotateZ:z1,scale:$1,set:C1,str:iv,sub:dv,subtract:ps,targetTo:av,translate:I1,transpose:G1},Symbol.toStringTag,{value:"Module"}));function za(){var e=new Ve(3);return Ve!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function mv(e){var r=new Ve(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function ys(e){var r=e[0],n=e[1],t=e[2];return Math.sqrt(r*r+n*n+t*t)}function Wn(e,r,n){var t=new Ve(3);return t[0]=e,t[1]=r,t[2]=n,t}function pv(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function yv(e,r,n,t){return e[0]=r,e[1]=n,e[2]=t,e}function _v(e,r,n){return e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}function _s(e,r,n){return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e[2]=r[2]-n[2],e}function bs(e,r,n){return e[0]=r[0]*n[0],e[1]=r[1]*n[1],e[2]=r[2]*n[2],e}function xs(e,r,n){return e[0]=r[0]/n[0],e[1]=r[1]/n[1],e[2]=r[2]/n[2],e}function bv(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e}function xv(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e}function Ev(e,r,n){return e[0]=Math.min(r[0],n[0]),e[1]=Math.min(r[1],n[1]),e[2]=Math.min(r[2],n[2]),e}function Av(e,r,n){return e[0]=Math.max(r[0],n[0]),e[1]=Math.max(r[1],n[1]),e[2]=Math.max(r[2],n[2]),e}function Tv(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e}function gv(e,r,n){return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e}function Mv(e,r,n,t){return e[0]=r[0]+n[0]*t,e[1]=r[1]+n[1]*t,e[2]=r[2]+n[2]*t,e}function Es(e,r){var n=r[0]-e[0],t=r[1]-e[1],a=r[2]-e[2];return Math.sqrt(n*n+t*t+a*a)}function As(e,r){var n=r[0]-e[0],t=r[1]-e[1],a=r[2]-e[2];return n*n+t*t+a*a}function Ts(e){var r=e[0],n=e[1],t=e[2];return r*r+n*n+t*t}function Sv(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e}function wv(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e}function It(e,r){var n=r[0],t=r[1],a=r[2],f=n*n+t*t+a*a;return f>0&&(f=1/Math.sqrt(f),e[0]=r[0]*f,e[1]=r[1]*f,e[2]=r[2]*f),e}function Ua(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function Ft(e,r,n){var t=r[0],a=r[1],f=r[2],s=n[0],c=n[1],o=n[2];return e[0]=a*o-f*c,e[1]=f*s-t*o,e[2]=t*c-a*s,e}function Lv(e,r,n,t){var a=r[0],f=r[1],s=r[2];return e[0]=a+t*(n[0]-a),e[1]=f+t*(n[1]-f),e[2]=s+t*(n[2]-s),e}function Rv(e,r,n,t,a,f){var s=f*f,c=s*(2*f-3)+1,o=s*(f-2)+f,m=s*(f-1),E=s*(3-2*f);return e[0]=r[0]*c+n[0]*o+t[0]*m+a[0]*E,e[1]=r[1]*c+n[1]*o+t[1]*m+a[1]*E,e[2]=r[2]*c+n[2]*o+t[2]*m+a[2]*E,e}function Ov(e,r,n,t,a,f){var s=1-f,c=s*s,o=f*f,m=c*s,E=3*f*c,R=3*o*s,G=o*f;return e[0]=r[0]*m+n[0]*E+t[0]*R+a[0]*G,e[1]=r[1]*m+n[1]*E+t[1]*R+a[1]*G,e[2]=r[2]*m+n[2]*E+t[2]*R+a[2]*G,e}function Cv(e,r){r=r||1;var n=Or()*2*Math.PI,t=Or()*2-1,a=Math.sqrt(1-t*t)*r;return e[0]=Math.cos(n)*a,e[1]=Math.sin(n)*a,e[2]=t*r,e}function Gv(e,r,n){var t=r[0],a=r[1],f=r[2],s=n[3]*t+n[7]*a+n[11]*f+n[15];return s=s||1,e[0]=(n[0]*t+n[4]*a+n[8]*f+n[12])/s,e[1]=(n[1]*t+n[5]*a+n[9]*f+n[13])/s,e[2]=(n[2]*t+n[6]*a+n[10]*f+n[14])/s,e}function Fv(e,r,n){var t=r[0],a=r[1],f=r[2];return e[0]=t*n[0]+a*n[3]+f*n[6],e[1]=t*n[1]+a*n[4]+f*n[7],e[2]=t*n[2]+a*n[5]+f*n[8],e}function Dv(e,r,n){var t=n[0],a=n[1],f=n[2],s=n[3],c=r[0],o=r[1],m=r[2],E=a*m-f*o,R=f*c-t*m,G=t*o-a*c,F=a*G-f*R,V=f*E-t*G,K=t*R-a*E,j=s*2;return E*=j,R*=j,G*=j,F*=2,V*=2,K*=2,e[0]=c+E+F,e[1]=o+R+V,e[2]=m+G+K,e}function Pv(e,r,n,t){var a=[],f=[];return a[0]=r[0]-n[0],a[1]=r[1]-n[1],a[2]=r[2]-n[2],f[0]=a[0],f[1]=a[1]*Math.cos(t)-a[2]*Math.sin(t),f[2]=a[1]*Math.sin(t)+a[2]*Math.cos(t),e[0]=f[0]+n[0],e[1]=f[1]+n[1],e[2]=f[2]+n[2],e}function Iv(e,r,n,t){var a=[],f=[];return a[0]=r[0]-n[0],a[1]=r[1]-n[1],a[2]=r[2]-n[2],f[0]=a[2]*Math.sin(t)+a[0]*Math.cos(t),f[1]=a[1],f[2]=a[2]*Math.cos(t)-a[0]*Math.sin(t),e[0]=f[0]+n[0],e[1]=f[1]+n[1],e[2]=f[2]+n[2],e}function $v(e,r,n,t){var a=[],f=[];return a[0]=r[0]-n[0],a[1]=r[1]-n[1],a[2]=r[2]-n[2],f[0]=a[0]*Math.cos(t)-a[1]*Math.sin(t),f[1]=a[0]*Math.sin(t)+a[1]*Math.cos(t),f[2]=a[2],e[0]=f[0]+n[0],e[1]=f[1]+n[1],e[2]=f[2]+n[2],e}function Nv(e,r){var n=Wn(e[0],e[1],e[2]),t=Wn(r[0],r[1],r[2]);It(n,n),It(t,t);var a=Ua(n,t);return a>1?0:a<-1?Math.PI:Math.acos(a)}function Bv(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function kv(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]}function zv(e,r){var n=e[0],t=e[1],a=e[2],f=r[0],s=r[1],c=r[2];return Math.abs(n-f)<=ge*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(t-s)<=ge*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(a-c)<=ge*Math.max(1,Math.abs(a),Math.abs(c))}var Uv=_s,Vv=bs,jv=xs,qv=Es,Xv=As,gs=ys,Hv=Ts,Wv=function(){var e=za();return function(r,n,t,a,f,s){var c=void 0,o=void 0;for(n||(n=3),t||(t=0),a?o=Math.min(a*n+t,r.length):o=r.length,c=t;c<o;c+=n)e[0]=r[c],e[1]=r[c+1],e[2]=r[c+2],f(e,e,s),r[c]=e[0],r[c+1]=e[1],r[c+2]=e[2];return r}}();const Yv=Object.freeze(Object.defineProperty({__proto__:null,add:_v,angle:Nv,bezier:Ov,ceil:bv,clone:mv,copy:pv,create:za,cross:Ft,dist:qv,distance:Es,div:jv,divide:xs,dot:Ua,equals:zv,exactEquals:kv,floor:xv,forEach:Wv,fromValues:Wn,hermite:Rv,inverse:wv,len:gs,length:ys,lerp:Lv,max:Av,min:Ev,mul:Vv,multiply:bs,negate:Sv,normalize:It,random:Cv,rotateX:Pv,rotateY:Iv,rotateZ:$v,round:Tv,scale:gv,scaleAndAdd:Mv,set:yv,sqrDist:Xv,sqrLen:Hv,squaredDistance:As,squaredLength:Ts,str:Bv,sub:Uv,subtract:_s,transformMat3:Fv,transformMat4:Gv,transformQuat:Dv},Symbol.toStringTag,{value:"Module"}));function Ms(){var e=new Ve(4);return Ve!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Ss(e){var r=new Ve(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function ws(e,r,n,t){var a=new Ve(4);return a[0]=e,a[1]=r,a[2]=n,a[3]=t,a}function Ls(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function Rs(e,r,n,t,a){return e[0]=r,e[1]=n,e[2]=t,e[3]=a,e}function Os(e,r,n){return e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e[3]=r[3]+n[3],e}function Cs(e,r,n){return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e[2]=r[2]-n[2],e[3]=r[3]-n[3],e}function Gs(e,r,n){return e[0]=r[0]*n[0],e[1]=r[1]*n[1],e[2]=r[2]*n[2],e[3]=r[3]*n[3],e}function Fs(e,r,n){return e[0]=r[0]/n[0],e[1]=r[1]/n[1],e[2]=r[2]/n[2],e[3]=r[3]/n[3],e}function Qv(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e[3]=Math.ceil(r[3]),e}function Kv(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e[3]=Math.floor(r[3]),e}function Zv(e,r,n){return e[0]=Math.min(r[0],n[0]),e[1]=Math.min(r[1],n[1]),e[2]=Math.min(r[2],n[2]),e[3]=Math.min(r[3],n[3]),e}function Jv(e,r,n){return e[0]=Math.max(r[0],n[0]),e[1]=Math.max(r[1],n[1]),e[2]=Math.max(r[2],n[2]),e[3]=Math.max(r[3],n[3]),e}function ed(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e[3]=Math.round(r[3]),e}function Ds(e,r,n){return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e}function rd(e,r,n,t){return e[0]=r[0]+n[0]*t,e[1]=r[1]+n[1]*t,e[2]=r[2]+n[2]*t,e[3]=r[3]+n[3]*t,e}function Ps(e,r){var n=r[0]-e[0],t=r[1]-e[1],a=r[2]-e[2],f=r[3]-e[3];return Math.sqrt(n*n+t*t+a*a+f*f)}function Is(e,r){var n=r[0]-e[0],t=r[1]-e[1],a=r[2]-e[2],f=r[3]-e[3];return n*n+t*t+a*a+f*f}function Va(e){var r=e[0],n=e[1],t=e[2],a=e[3];return Math.sqrt(r*r+n*n+t*t+a*a)}function ja(e){var r=e[0],n=e[1],t=e[2],a=e[3];return r*r+n*n+t*t+a*a}function nd(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=-r[3],e}function td(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e[3]=1/r[3],e}function $s(e,r){var n=r[0],t=r[1],a=r[2],f=r[3],s=n*n+t*t+a*a+f*f;return s>0&&(s=1/Math.sqrt(s),e[0]=n*s,e[1]=t*s,e[2]=a*s,e[3]=f*s),e}function Ns(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]}function Bs(e,r,n,t){var a=r[0],f=r[1],s=r[2],c=r[3];return e[0]=a+t*(n[0]-a),e[1]=f+t*(n[1]-f),e[2]=s+t*(n[2]-s),e[3]=c+t*(n[3]-c),e}function ad(e,r){r=r||1;var n,t,a,f,s,c;do n=Or()*2-1,t=Or()*2-1,s=n*n+t*t;while(s>=1);do a=Or()*2-1,f=Or()*2-1,c=a*a+f*f;while(c>=1);var o=Math.sqrt((1-s)/c);return e[0]=r*n,e[1]=r*t,e[2]=r*a*o,e[3]=r*f*o,e}function id(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3];return e[0]=n[0]*t+n[4]*a+n[8]*f+n[12]*s,e[1]=n[1]*t+n[5]*a+n[9]*f+n[13]*s,e[2]=n[2]*t+n[6]*a+n[10]*f+n[14]*s,e[3]=n[3]*t+n[7]*a+n[11]*f+n[15]*s,e}function fd(e,r,n){var t=r[0],a=r[1],f=r[2],s=n[0],c=n[1],o=n[2],m=n[3],E=m*t+c*f-o*a,R=m*a+o*t-s*f,G=m*f+s*a-c*t,F=-s*t-c*a-o*f;return e[0]=E*m+F*-s+R*-o-G*-c,e[1]=R*m+F*-c+G*-s-E*-o,e[2]=G*m+F*-o+E*-c-R*-s,e[3]=r[3],e}function sd(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function ks(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}function zs(e,r){var n=e[0],t=e[1],a=e[2],f=e[3],s=r[0],c=r[1],o=r[2],m=r[3];return Math.abs(n-s)<=ge*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(t-c)<=ge*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(a-o)<=ge*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(f-m)<=ge*Math.max(1,Math.abs(f),Math.abs(m))}var cd=Cs,ld=Gs,od=Fs,ud=Ps,vd=Is,dd=Va,hd=ja,md=function(){var e=Ms();return function(r,n,t,a,f,s){var c=void 0,o=void 0;for(n||(n=4),t||(t=0),a?o=Math.min(a*n+t,r.length):o=r.length,c=t;c<o;c+=n)e[0]=r[c],e[1]=r[c+1],e[2]=r[c+2],e[3]=r[c+3],f(e,e,s),r[c]=e[0],r[c+1]=e[1],r[c+2]=e[2],r[c+3]=e[3];return r}}();const pd=Object.freeze(Object.defineProperty({__proto__:null,add:Os,ceil:Qv,clone:Ss,copy:Ls,create:Ms,dist:ud,distance:Ps,div:od,divide:Fs,dot:Ns,equals:zs,exactEquals:ks,floor:Kv,forEach:md,fromValues:ws,inverse:td,len:dd,length:Va,lerp:Bs,max:Jv,min:Zv,mul:ld,multiply:Gs,negate:nd,normalize:$s,random:ad,round:ed,scale:Ds,scaleAndAdd:rd,set:Rs,sqrDist:vd,sqrLen:hd,squaredDistance:Is,squaredLength:ja,str:sd,sub:cd,subtract:Cs,transformMat4:id,transformQuat:fd},Symbol.toStringTag,{value:"Module"}));function $t(){var e=new Ve(4);return Ve!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function yd(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Us(e,r,n){n=n*.5;var t=Math.sin(n);return e[0]=t*r[0],e[1]=t*r[1],e[2]=t*r[2],e[3]=Math.cos(n),e}function _d(e,r){var n=Math.acos(r[3])*2,t=Math.sin(n/2);return t>ge?(e[0]=r[0]/t,e[1]=r[1]/t,e[2]=r[2]/t):(e[0]=1,e[1]=0,e[2]=0),n}function Vs(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=n[0],o=n[1],m=n[2],E=n[3];return e[0]=t*E+s*c+a*m-f*o,e[1]=a*E+s*o+f*c-t*m,e[2]=f*E+s*m+t*o-a*c,e[3]=s*E-t*c-a*o-f*m,e}function js(e,r,n){n*=.5;var t=r[0],a=r[1],f=r[2],s=r[3],c=Math.sin(n),o=Math.cos(n);return e[0]=t*o+s*c,e[1]=a*o+f*c,e[2]=f*o-a*c,e[3]=s*o-t*c,e}function qs(e,r,n){n*=.5;var t=r[0],a=r[1],f=r[2],s=r[3],c=Math.sin(n),o=Math.cos(n);return e[0]=t*o-f*c,e[1]=a*o+s*c,e[2]=f*o+t*c,e[3]=s*o-a*c,e}function Xs(e,r,n){n*=.5;var t=r[0],a=r[1],f=r[2],s=r[3],c=Math.sin(n),o=Math.cos(n);return e[0]=t*o+a*c,e[1]=a*o-t*c,e[2]=f*o+s*c,e[3]=s*o-f*c,e}function bd(e,r){var n=r[0],t=r[1],a=r[2];return e[0]=n,e[1]=t,e[2]=a,e[3]=Math.sqrt(Math.abs(1-n*n-t*t-a*a)),e}function Dt(e,r,n,t){var a=r[0],f=r[1],s=r[2],c=r[3],o=n[0],m=n[1],E=n[2],R=n[3],G=void 0,F=void 0,V=void 0,K=void 0,j=void 0;return F=a*o+f*m+s*E+c*R,F<0&&(F=-F,o=-o,m=-m,E=-E,R=-R),1-F>ge?(G=Math.acos(F),V=Math.sin(G),K=Math.sin((1-t)*G)/V,j=Math.sin(t*G)/V):(K=1-t,j=t),e[0]=K*a+j*o,e[1]=K*f+j*m,e[2]=K*s+j*E,e[3]=K*c+j*R,e}function xd(e){var r=Or(),n=Or(),t=Or(),a=Math.sqrt(1-r),f=Math.sqrt(r);return e[0]=a*Math.sin(2*Math.PI*n),e[1]=a*Math.cos(2*Math.PI*n),e[2]=f*Math.sin(2*Math.PI*t),e[3]=f*Math.cos(2*Math.PI*t),e}function Ed(e,r){var n=r[0],t=r[1],a=r[2],f=r[3],s=n*n+t*t+a*a+f*f,c=s?1/s:0;return e[0]=-n*c,e[1]=-t*c,e[2]=-a*c,e[3]=f*c,e}function Ad(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=r[3],e}function Hs(e,r){var n=r[0]+r[4]+r[8],t=void 0;if(n>0)t=Math.sqrt(n+1),e[3]=.5*t,t=.5/t,e[0]=(r[5]-r[7])*t,e[1]=(r[6]-r[2])*t,e[2]=(r[1]-r[3])*t;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[a*3+a]&&(a=2);var f=(a+1)%3,s=(a+2)%3;t=Math.sqrt(r[a*3+a]-r[f*3+f]-r[s*3+s]+1),e[a]=.5*t,t=.5/t,e[3]=(r[f*3+s]-r[s*3+f])*t,e[f]=(r[f*3+a]+r[a*3+f])*t,e[s]=(r[s*3+a]+r[a*3+s])*t}return e}function Td(e,r,n,t){var a=.5*Math.PI/180;r*=a,n*=a,t*=a;var f=Math.sin(r),s=Math.cos(r),c=Math.sin(n),o=Math.cos(n),m=Math.sin(t),E=Math.cos(t);return e[0]=f*o*E-s*c*m,e[1]=s*c*E+f*o*m,e[2]=s*o*m-f*c*E,e[3]=s*o*E+f*c*m,e}function gd(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Md=Ss,Sd=ws,qa=Ls,wd=Rs,Ld=Os,Rd=Vs,Od=Ds,Ws=Ns,Cd=Bs,Xa=Va,Gd=Xa,Ha=ja,Fd=Ha,Wa=$s,Dd=ks,Pd=zs,Id=function(){var e=za(),r=Wn(1,0,0),n=Wn(0,1,0);return function(t,a,f){var s=Ua(a,f);return s<-.999999?(Ft(e,r,a),gs(e)<1e-6&&Ft(e,n,a),It(e,e),Us(t,e,Math.PI),t):s>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Ft(e,a,f),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=1+s,Wa(t,t))}}(),$d=function(){var e=$t(),r=$t();return function(n,t,a,f,s,c){return Dt(e,t,s,c),Dt(r,a,f,c),Dt(n,e,r,2*c*(1-c)),n}}(),Nd=function(){var e=cs();return function(r,n,t,a){return e[0]=t[0],e[3]=t[1],e[6]=t[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Wa(r,Hs(r,e))}}();const Bd=Object.freeze(Object.defineProperty({__proto__:null,add:Ld,calculateW:bd,clone:Md,conjugate:Ad,copy:qa,create:$t,dot:Ws,equals:Pd,exactEquals:Dd,fromEuler:Td,fromMat3:Hs,fromValues:Sd,getAxisAngle:_d,identity:yd,invert:Ed,len:Gd,length:Xa,lerp:Cd,mul:Rd,multiply:Vs,normalize:Wa,random:xd,rotateX:js,rotateY:qs,rotateZ:Xs,rotationTo:Id,scale:Od,set:wd,setAxes:Nd,setAxisAngle:Us,slerp:Dt,sqlerp:$d,sqrLen:Fd,squaredLength:Ha,str:gd},Symbol.toStringTag,{value:"Module"}));function kd(){var e=new Ve(8);return Ve!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function zd(e){var r=new Ve(8);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r}function Ud(e,r,n,t,a,f,s,c){var o=new Ve(8);return o[0]=e,o[1]=r,o[2]=n,o[3]=t,o[4]=a,o[5]=f,o[6]=s,o[7]=c,o}function Vd(e,r,n,t,a,f,s){var c=new Ve(8);c[0]=e,c[1]=r,c[2]=n,c[3]=t;var o=a*.5,m=f*.5,E=s*.5;return c[4]=o*t+m*n-E*r,c[5]=m*t+E*e-o*n,c[6]=E*t+o*r-m*e,c[7]=-o*e-m*r-E*n,c}function Ys(e,r,n){var t=n[0]*.5,a=n[1]*.5,f=n[2]*.5,s=r[0],c=r[1],o=r[2],m=r[3];return e[0]=s,e[1]=c,e[2]=o,e[3]=m,e[4]=t*m+a*o-f*c,e[5]=a*m+f*s-t*o,e[6]=f*m+t*c-a*s,e[7]=-t*s-a*c-f*o,e}function jd(e,r){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=r[0]*.5,e[5]=r[1]*.5,e[6]=r[2]*.5,e[7]=0,e}function qd(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Xd(e,r){var n=$t();ms(n,r);var t=new Ve(3);return hs(t,r),Ys(e,n,t),e}function Qs(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e}function Hd(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Wd(e,r,n,t,a,f,s,c,o){return e[0]=r,e[1]=n,e[2]=t,e[3]=a,e[4]=f,e[5]=s,e[6]=c,e[7]=o,e}var Yd=qa;function Qd(e,r){return e[0]=r[4],e[1]=r[5],e[2]=r[6],e[3]=r[7],e}var Kd=qa;function Zd(e,r){return e[4]=r[0],e[5]=r[1],e[6]=r[2],e[7]=r[3],e}function Jd(e,r){var n=r[4],t=r[5],a=r[6],f=r[7],s=-r[0],c=-r[1],o=-r[2],m=r[3];return e[0]=(n*m+f*s+t*o-a*c)*2,e[1]=(t*m+f*c+a*s-n*o)*2,e[2]=(a*m+f*o+n*c-t*s)*2,e}function eh(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=n[0]*.5,o=n[1]*.5,m=n[2]*.5,E=r[4],R=r[5],G=r[6],F=r[7];return e[0]=t,e[1]=a,e[2]=f,e[3]=s,e[4]=s*c+a*m-f*o+E,e[5]=s*o+f*c-t*m+R,e[6]=s*m+t*o-a*c+G,e[7]=-t*c-a*o-f*m+F,e}function rh(e,r,n){var t=-r[0],a=-r[1],f=-r[2],s=r[3],c=r[4],o=r[5],m=r[6],E=r[7],R=c*s+E*t+o*f-m*a,G=o*s+E*a+m*t-c*f,F=m*s+E*f+c*a-o*t,V=E*s-c*t-o*a-m*f;return js(e,r,n),t=e[0],a=e[1],f=e[2],s=e[3],e[4]=R*s+V*t+G*f-F*a,e[5]=G*s+V*a+F*t-R*f,e[6]=F*s+V*f+R*a-G*t,e[7]=V*s-R*t-G*a-F*f,e}function nh(e,r,n){var t=-r[0],a=-r[1],f=-r[2],s=r[3],c=r[4],o=r[5],m=r[6],E=r[7],R=c*s+E*t+o*f-m*a,G=o*s+E*a+m*t-c*f,F=m*s+E*f+c*a-o*t,V=E*s-c*t-o*a-m*f;return qs(e,r,n),t=e[0],a=e[1],f=e[2],s=e[3],e[4]=R*s+V*t+G*f-F*a,e[5]=G*s+V*a+F*t-R*f,e[6]=F*s+V*f+R*a-G*t,e[7]=V*s-R*t-G*a-F*f,e}function th(e,r,n){var t=-r[0],a=-r[1],f=-r[2],s=r[3],c=r[4],o=r[5],m=r[6],E=r[7],R=c*s+E*t+o*f-m*a,G=o*s+E*a+m*t-c*f,F=m*s+E*f+c*a-o*t,V=E*s-c*t-o*a-m*f;return Xs(e,r,n),t=e[0],a=e[1],f=e[2],s=e[3],e[4]=R*s+V*t+G*f-F*a,e[5]=G*s+V*a+F*t-R*f,e[6]=F*s+V*f+R*a-G*t,e[7]=V*s-R*t-G*a-F*f,e}function ah(e,r,n){var t=n[0],a=n[1],f=n[2],s=n[3],c=r[0],o=r[1],m=r[2],E=r[3];return e[0]=c*s+E*t+o*f-m*a,e[1]=o*s+E*a+m*t-c*f,e[2]=m*s+E*f+c*a-o*t,e[3]=E*s-c*t-o*a-m*f,c=r[4],o=r[5],m=r[6],E=r[7],e[4]=c*s+E*t+o*f-m*a,e[5]=o*s+E*a+m*t-c*f,e[6]=m*s+E*f+c*a-o*t,e[7]=E*s-c*t-o*a-m*f,e}function ih(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=n[0],o=n[1],m=n[2],E=n[3];return e[0]=t*E+s*c+a*m-f*o,e[1]=a*E+s*o+f*c-t*m,e[2]=f*E+s*m+t*o-a*c,e[3]=s*E-t*c-a*o-f*m,c=n[4],o=n[5],m=n[6],E=n[7],e[4]=t*E+s*c+a*m-f*o,e[5]=a*E+s*o+f*c-t*m,e[6]=f*E+s*m+t*o-a*c,e[7]=s*E-t*c-a*o-f*m,e}function fh(e,r,n,t){if(Math.abs(t)<ge)return Qs(e,r);var a=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);t=t*.5;var f=Math.sin(t),s=f*n[0]/a,c=f*n[1]/a,o=f*n[2]/a,m=Math.cos(t),E=r[0],R=r[1],G=r[2],F=r[3];e[0]=E*m+F*s+R*o-G*c,e[1]=R*m+F*c+G*s-E*o,e[2]=G*m+F*o+E*c-R*s,e[3]=F*m-E*s-R*c-G*o;var V=r[4],K=r[5],j=r[6],fe=r[7];return e[4]=V*m+fe*s+K*o-j*c,e[5]=K*m+fe*c+j*s-V*o,e[6]=j*m+fe*o+V*c-K*s,e[7]=fe*m-V*s-K*c-j*o,e}function sh(e,r,n){return e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e[3]=r[3]+n[3],e[4]=r[4]+n[4],e[5]=r[5]+n[5],e[6]=r[6]+n[6],e[7]=r[7]+n[7],e}function Ks(e,r,n){var t=r[0],a=r[1],f=r[2],s=r[3],c=n[4],o=n[5],m=n[6],E=n[7],R=r[4],G=r[5],F=r[6],V=r[7],K=n[0],j=n[1],fe=n[2],Ge=n[3];return e[0]=t*Ge+s*K+a*fe-f*j,e[1]=a*Ge+s*j+f*K-t*fe,e[2]=f*Ge+s*fe+t*j-a*K,e[3]=s*Ge-t*K-a*j-f*fe,e[4]=t*E+s*c+a*m-f*o+R*Ge+V*K+G*fe-F*j,e[5]=a*E+s*o+f*c-t*m+G*Ge+V*j+F*K-R*fe,e[6]=f*E+s*m+t*o-a*c+F*Ge+V*fe+R*j-G*K,e[7]=s*E-t*c-a*o-f*m+V*Ge-R*K-G*j-F*fe,e}var ch=Ks;function lh(e,r,n){return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*n,e[5]=r[5]*n,e[6]=r[6]*n,e[7]=r[7]*n,e}var Zs=Ws;function oh(e,r,n,t){var a=1-t;return Zs(r,n)<0&&(t=-t),e[0]=r[0]*a+n[0]*t,e[1]=r[1]*a+n[1]*t,e[2]=r[2]*a+n[2]*t,e[3]=r[3]*a+n[3]*t,e[4]=r[4]*a+n[4]*t,e[5]=r[5]*a+n[5]*t,e[6]=r[6]*a+n[6]*t,e[7]=r[7]*a+n[7]*t,e}function uh(e,r){var n=Nt(r);return e[0]=-r[0]/n,e[1]=-r[1]/n,e[2]=-r[2]/n,e[3]=r[3]/n,e[4]=-r[4]/n,e[5]=-r[5]/n,e[6]=-r[6]/n,e[7]=r[7]/n,e}function vh(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=r[3],e[4]=-r[4],e[5]=-r[5],e[6]=-r[6],e[7]=r[7],e}var Js=Xa,dh=Js,Nt=Ha,hh=Nt;function mh(e,r){var n=Nt(r);if(n>0){n=Math.sqrt(n);var t=r[0]/n,a=r[1]/n,f=r[2]/n,s=r[3]/n,c=r[4],o=r[5],m=r[6],E=r[7],R=t*c+a*o+f*m+s*E;e[0]=t,e[1]=a,e[2]=f,e[3]=s,e[4]=(c-t*R)/n,e[5]=(o-a*R)/n,e[6]=(m-f*R)/n,e[7]=(E-s*R)/n}return e}function ph(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function yh(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]}function _h(e,r){var n=e[0],t=e[1],a=e[2],f=e[3],s=e[4],c=e[5],o=e[6],m=e[7],E=r[0],R=r[1],G=r[2],F=r[3],V=r[4],K=r[5],j=r[6],fe=r[7];return Math.abs(n-E)<=ge*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(t-R)<=ge*Math.max(1,Math.abs(t),Math.abs(R))&&Math.abs(a-G)<=ge*Math.max(1,Math.abs(a),Math.abs(G))&&Math.abs(f-F)<=ge*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(s-V)<=ge*Math.max(1,Math.abs(s),Math.abs(V))&&Math.abs(c-K)<=ge*Math.max(1,Math.abs(c),Math.abs(K))&&Math.abs(o-j)<=ge*Math.max(1,Math.abs(o),Math.abs(j))&&Math.abs(m-fe)<=ge*Math.max(1,Math.abs(m),Math.abs(fe))}const bh=Object.freeze(Object.defineProperty({__proto__:null,add:sh,clone:zd,conjugate:vh,copy:Qs,create:kd,dot:Zs,equals:_h,exactEquals:yh,fromMat4:Xd,fromRotation:qd,fromRotationTranslation:Ys,fromRotationTranslationValues:Vd,fromTranslation:jd,fromValues:Ud,getDual:Qd,getReal:Yd,getTranslation:Jd,identity:Hd,invert:uh,len:dh,length:Js,lerp:oh,mul:ch,multiply:Ks,normalize:mh,rotateAroundAxis:fh,rotateByQuatAppend:ah,rotateByQuatPrepend:ih,rotateX:rh,rotateY:nh,rotateZ:th,scale:lh,set:Wd,setDual:Zd,setReal:Kd,sqrLen:hh,squaredLength:Nt,str:ph,translate:eh},Symbol.toStringTag,{value:"Module"}));function ec(){var e=new Ve(2);return Ve!=Float32Array&&(e[0]=0,e[1]=0),e}function xh(e){var r=new Ve(2);return r[0]=e[0],r[1]=e[1],r}function Eh(e,r){var n=new Ve(2);return n[0]=e,n[1]=r,n}function Ah(e,r){return e[0]=r[0],e[1]=r[1],e}function Th(e,r,n){return e[0]=r,e[1]=n,e}function gh(e,r,n){return e[0]=r[0]+n[0],e[1]=r[1]+n[1],e}function rc(e,r,n){return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e}function nc(e,r,n){return e[0]=r[0]*n[0],e[1]=r[1]*n[1],e}function tc(e,r,n){return e[0]=r[0]/n[0],e[1]=r[1]/n[1],e}function Mh(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e}function Sh(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e}function wh(e,r,n){return e[0]=Math.min(r[0],n[0]),e[1]=Math.min(r[1],n[1]),e}function Lh(e,r,n){return e[0]=Math.max(r[0],n[0]),e[1]=Math.max(r[1],n[1]),e}function Rh(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e}function Oh(e,r,n){return e[0]=r[0]*n,e[1]=r[1]*n,e}function Ch(e,r,n,t){return e[0]=r[0]+n[0]*t,e[1]=r[1]+n[1]*t,e}function ac(e,r){var n=r[0]-e[0],t=r[1]-e[1];return Math.sqrt(n*n+t*t)}function ic(e,r){var n=r[0]-e[0],t=r[1]-e[1];return n*n+t*t}function fc(e){var r=e[0],n=e[1];return Math.sqrt(r*r+n*n)}function sc(e){var r=e[0],n=e[1];return r*r+n*n}function Gh(e,r){return e[0]=-r[0],e[1]=-r[1],e}function Fh(e,r){return e[0]=1/r[0],e[1]=1/r[1],e}function Dh(e,r){var n=r[0],t=r[1],a=n*n+t*t;return a>0&&(a=1/Math.sqrt(a),e[0]=r[0]*a,e[1]=r[1]*a),e}function Ph(e,r){return e[0]*r[0]+e[1]*r[1]}function Ih(e,r,n){var t=r[0]*n[1]-r[1]*n[0];return e[0]=e[1]=0,e[2]=t,e}function $h(e,r,n,t){var a=r[0],f=r[1];return e[0]=a+t*(n[0]-a),e[1]=f+t*(n[1]-f),e}function Nh(e,r){r=r||1;var n=Or()*2*Math.PI;return e[0]=Math.cos(n)*r,e[1]=Math.sin(n)*r,e}function Bh(e,r,n){var t=r[0],a=r[1];return e[0]=n[0]*t+n[2]*a,e[1]=n[1]*t+n[3]*a,e}function kh(e,r,n){var t=r[0],a=r[1];return e[0]=n[0]*t+n[2]*a+n[4],e[1]=n[1]*t+n[3]*a+n[5],e}function zh(e,r,n){var t=r[0],a=r[1];return e[0]=n[0]*t+n[3]*a+n[6],e[1]=n[1]*t+n[4]*a+n[7],e}function Uh(e,r,n){var t=r[0],a=r[1];return e[0]=n[0]*t+n[4]*a+n[12],e[1]=n[1]*t+n[5]*a+n[13],e}function Vh(e,r,n,t){var a=r[0]-n[0],f=r[1]-n[1],s=Math.sin(t),c=Math.cos(t);return e[0]=a*c-f*s+n[0],e[1]=a*s+f*c+n[1],e}function jh(e,r){var n=e[0],t=e[1],a=r[0],f=r[1],s=n*n+t*t;s>0&&(s=1/Math.sqrt(s));var c=a*a+f*f;c>0&&(c=1/Math.sqrt(c));var o=(n*a+t*f)*s*c;return o>1?0:o<-1?Math.PI:Math.acos(o)}function qh(e){return"vec2("+e[0]+", "+e[1]+")"}function Xh(e,r){return e[0]===r[0]&&e[1]===r[1]}function Hh(e,r){var n=e[0],t=e[1],a=r[0],f=r[1];return Math.abs(n-a)<=ge*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(t-f)<=ge*Math.max(1,Math.abs(t),Math.abs(f))}var Wh=fc,Yh=rc,Qh=nc,Kh=tc,Zh=ac,Jh=ic,em=sc,rm=function(){var e=ec();return function(r,n,t,a,f,s){var c=void 0,o=void 0;for(n||(n=2),t||(t=0),a?o=Math.min(a*n+t,r.length):o=r.length,c=t;c<o;c+=n)e[0]=r[c],e[1]=r[c+1],f(e,e,s),r[c]=e[0],r[c+1]=e[1];return r}}();const nm=Object.freeze(Object.defineProperty({__proto__:null,add:gh,angle:jh,ceil:Mh,clone:xh,copy:Ah,create:ec,cross:Ih,dist:Zh,distance:ac,div:Kh,divide:tc,dot:Ph,equals:Hh,exactEquals:Xh,floor:Sh,forEach:rm,fromValues:Eh,inverse:Fh,len:Wh,length:fc,lerp:$h,max:Lh,min:wh,mul:Qh,multiply:nc,negate:Gh,normalize:Dh,random:Nh,rotate:Vh,round:Rh,scale:Oh,scaleAndAdd:Ch,set:Th,sqrDist:Jh,sqrLen:em,squaredDistance:ic,squaredLength:sc,str:qh,sub:Yh,subtract:rc,transformMat2:Bh,transformMat2d:kh,transformMat3:zh,transformMat4:Uh},Symbol.toStringTag,{value:"Module"})),tm=Object.freeze(Object.defineProperty({__proto__:null,glMatrix:ru,mat2:Su,mat2d:Qu,mat3:S1,mat4:hv,quat:Bd,quat2:bh,vec2:nm,vec3:Yv,vec4:pd},Symbol.toStringTag,{value:"Module"})),am=W0(tm);var Bt=am,Rn=Bt.vec3,im=Bt.mat3,Pt=Bt.mat4,Hr=Bt.quat,yr=new Float32Array(16),Wr=new Float32Array(16);function cc(e,r,n){this.rotation=e,this.center=r,this.distance=n}var Yn=cc.prototype;Yn.view=function(e){return e||(e=Pt.create()),Wr[0]=Wr[1]=0,Wr[2]=-this.distance,Pt.fromRotationTranslation(e,Hr.conjugate(yr,this.rotation),Wr),Pt.translate(e,e,Rn.negate(yr,this.center)),e};Yn.lookAt=function(e,r,n){Pt.lookAt(yr,e,r,n),im.fromMat4(yr,yr),Hr.fromMat3(this.rotation,yr),Rn.copy(this.center,r),this.distance=Rn.distance(e,r)};Yn.pan=function(e){var r=this.distance;yr[0]=-r*(e[0]||0),yr[1]=r*(e[1]||0),yr[2]=r*(e[2]||0),Rn.transformQuat(yr,yr,this.rotation),Rn.add(this.center,this.center,yr)};Yn.zoom=function(e){this.distance+=e,this.distance<0&&(this.distance=0)};function rs(e,r){var n=r[0],t=r[1];r[2];var a=n*n+t*t;a>1&&(a=1),e[0]=-r[0],e[1]=r[1],e[2]=r[2]||Math.sqrt(1-a),e[3]=0}Yn.rotate=function(e,r){rs(yr,e),rs(Wr,r),Hr.invert(Wr,Wr),Hr.multiply(yr,yr,Wr),!(Hr.length(yr)<1e-6)&&(Hr.multiply(this.rotation,this.rotation,yr),Hr.normalize(this.rotation,this.rotation))};function fm(e,r,n){e=e||[0,0,-1],r=r||[0,0,0],n=n||[0,1,0];var t=new cc(Hr.create(),Rn.create(),1);return t.lookAt(e,r,n),t}var sm=fm;const lc=ns(sm),cm=`/* Main function, uniforms & utils */
precision mediump float;
#define GLSLIFY 1
//
// Description : Array and textureless GLSL 2D simplex noise function.
//      Author : Ian McEwan, Ashima Arts.
//  Maintainer : ijm
//     Lastmod : 20110822 (ijm)
//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.
//               Distributed under the MIT License. See LICENSE file.
//               https://github.com/ashima/webgl-noise
//

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v)
  {
  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
                     -0.577350269189626,  // -1.0 + 2.0 * C.x
                      0.024390243902439); // 1.0 / 41.0
// First corner
  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

// Other corners
  vec2 i1;
  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0
  //i1.y = 1.0 - i1.x;
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  // x0 = x0 - 0.0 + 0.0 * C.xx ;
  // x1 = x0 - i1 + 1.0 * C.xx ;
  // x2 = x0 - 1.0 + 2.0 * C.xx ;
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

// Permutations
  i = mod289(i); // Avoid truncation effects in permutation
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
    + i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

// Gradients: 41 points uniformly over a line, mapped onto a diamond.
// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

// Normalise gradients implicitly by scaling m
// Approximation of: m *= inversesqrt( a0*a0 + h*h );
  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

// Compute final noise value at P
  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}

attribute float aIndex;

uniform sampler2D uColorTex;
uniform sampler2D uPhysTex;
uniform float uParticleRadius;
uniform mat4 uCamMat;
varying vec2 vPos;
varying float dist;
#define PI_TWO 1.570796326794897
#define PI 3.141592653589793
#define TWO_PI 6.283185307179586

vec2 transformCoord(vec2 source) {
    float x = (2. * source.x) - 1.;
    float interY = 1. - source.y;
    float y = (2. * source.y) - 1.;
    return vec2(x, y);
}

void main() {
    float x = mod(aIndex, uParticleRadius) / uParticleRadius;
    float y = floor(aIndex / uParticleRadius) / uParticleRadius;
    vec4 particlePhysData = texture2D(uPhysTex, vec2(x, y));
    vPos = vec2(x, y);
    vec2 form = clamp(particlePhysData.xy, vec2(-1.), vec2(1.));
    float z = snoise(vec2(x * 12., y * 12.) * 12.);
    gl_PointSize = 32.;
    vec4 pos = vec4(transformCoord(form), 0.1 - .2 * z, 1.) * uCamMat;
    dist = pos.z;
    gl_Position = pos;
}`;console.log(lc);const lm=Object.assign({"./shaders/prcl.frag":V0,"./shaders/prcl.vert":j0,"./shaders/prcl_process.frag":q0,"./shaders/prcl_process.vert":X0}),Na=Object.fromEntries(Object.entries(lm).map(([e,r])=>{const n=e.match(new RegExp("(?<=\\/)[^/]+$"))[0];return console.log(n),[n,r]})),Yr=Q0({extensions:["OES_texture_float","OES_texture_float_linear","WEBGL_draw_buffers"],attributes:{alpha:!0,depth:!0,premultipliedAlpha:!1}});Yr.clear({color:[0/255,18/255,70/255,1]});const Nr=64,dn=Nr**2,oc=Yr.buffer({length:dn,type:"float32",data:new Float32Array(dn).map((e,r)=>r)});console.log(new Uint32Array(dn).map((e,r)=>r));const uc=Yr.texture({width:Nr,height:Nr,channels:4,data:new Float32Array(dn*4).map(()=>-1+2*Math.random())}),Ba=new Float32Array(dn*4);for(let e=0;e<Ba.length;e+=4){const r=Math.random()*Math.PI*2,n=.5+Math.sqrt(Math.random())/2,t=Math.cos(r)*n,a=Math.sin(r)*n,f=Math.sqrt(n)*1,s=r+Math.PI/2,c=t/2+.5,o=a/2+.5;Ba.set([c,o,Math.cos(s)*f,Math.sin(s)*f],e)}const ka=[0,0].map(()=>{const e=Yr.texture({width:Nr,height:Nr,wrap:"repeat",data:Ba});return[Yr.framebuffer({width:Nr,height:Nr,color:e,depthStencil:!1}),e]}),om=Yr({attributes:{aIndex:oc},count:dn,primitive:"points",uniforms:{uColorTex:uc,uPhysTex:(e,r)=>ka[(r.set+1)%2][1],uParticleRadius:Nr},framebuffer:(e,r)=>ka[r.set][0],vert:Na["prcl_process.vert"],frag:Na["prcl_process.frag"]}),vc=new Float32Array(16),dc=Yr({attributes:{aIndex:oc},count:dn,primitive:"points",uniforms:{uColorTex:uc,uPhysTex:(e,r)=>ka[r.set][0],uParticleRadius:Nr,uCamMat:(e,r)=>r.view??vc},vert:cm,frag:Na["prcl.frag"],blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"src alpha",dstRGB:"one minus src alpha",dstAlpha:"dst alpha"},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!0}});dc({set:0});let Gt=0,$a=0;const hc=()=>{const e=lc([0,1-Math.cos($a/1e3),Math.sin($a/1e3)],[0,0,0],[0,-1,0]);e.zoom(-10),e.zoom(-10);const r=e.view(vc);Yr.clear({color:[0/255,18/255,70/255,1]}),om({set:Gt}),dc({set:Gt,view:r}),Gt=(Gt+1)%2,requestAnimationFrame(hc),$a++};hc();
