(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const f of a)if(f.type==="childList")for(const s of f.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function n(a){const f={};return a.integrity&&(f.integrity=a.integrity),a.referrerPolicy&&(f.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?f.credentials="include":a.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function t(a){if(a.ep)return;a.ep=!0;const f=n(a);fetch(a.href,f)}})();const j0=`/* Main function, uniforms & utils */
precision mediump float;
uniform sampler2D uColorTex;
uniform float uParticleRadius;

varying vec2 vPos;
varying float dist;
#define PI_TWO 1.570796326794897
#define PI 3.141592653589793
#define TWO_PI 6.283185307179586

void main() {
  vec3 pointColor = texture2D(uColorTex, vPos).rgb;
  float fragDist = distance(vec2(.5, .5), gl_PointCoord);
  float slightDist = ((1. + dist) / 2.) * 0.5;

  float alpha = mix(1., 0., (fragDist * 2.) + slightDist);
  if(alpha < .1) {
    discard;
  }
  gl_FragColor = vec4(vec3(.8 - slightDist), 1.);

}`,ns=`/* Main function, uniforms & utils */
precision mediump float;
#pragma glslify: snoise = require(glsl-noise/simplex/2d) 

attribute float aIndex;

uniform sampler2D uColorTex;
uniform sampler2D uPhysTex;
uniform float uParticleRadius;
uniform mat4 uCamMat;
varying vec2 vPos;
varying float dist;
#define PI_TWO 1.570796326794897
#define PI 3.141592653589793
#define TWO_PI 6.283185307179586

vec2 transformCoord(vec2 source) {
    float x = (2. * source.x) - 1.;
    float interY = 1. - source.y;
    float y = (2. * source.y) - 1.;
    return vec2(x, y);
}

void main() {
    float x = mod(aIndex, uParticleRadius) / uParticleRadius;
    float y = floor(aIndex / uParticleRadius) / uParticleRadius;
    vec4 particlePhysData = texture2D(uPhysTex, vec2(x, y));
    vPos = vec2(x, y);
    vec2 form = clamp(particlePhysData.xy, vec2(-1.), vec2(1.));
    float z = snoise(vec2(x * 12., y * 12.) * 12.);
    gl_PointSize = 32.;
    vec4 pos = vec4(transformCoord(form), 0.1 - .2 * z, 1.) * uCamMat;
    dist = pos.z;
    gl_Position = pos;
}`,q0=`/* Main function, uniforms & utils */
precision mediump float;

uniform sampler2D uPhysTex;
uniform float uParticleRadius;

varying vec2 vUV;

#define PI_TWO 1.570796326794897
#define PI 3.141592653589793
#define TWO_PI 6.283185307179586

void main() {
  vec4 pastData = texture2D(uPhysTex, vUV);
  vec2 pos = pastData.xy;
  vec2 vel = pastData.zw;
  vec2 newPos = pos + (vel / 2000.);
  ;
  float dist = distance(newPos, vec2(.5, .5));
  vec2 v = vec2(.5, .5) - newPos;
  float force = 1. / (pow(dist, 2.) * 4096.);
  vec2 normV = normalize(v) * force;
  gl_FragColor = vec4(newPos, pastData.zw + normV);
}`,X0=`/* Main function, uniforms & utils */

precision mediump float;

attribute float aIndex;

uniform sampler2D uPhysTex;
uniform float uParticleRadius;

varying vec2 vUV;

#define PI_TWO 1.570796326794897
#define PI 3.141592653589793
#define TWO_PI 6.283185307179586

void main() {
  float xPosition = (.5 + mod(aIndex, uParticleRadius)) / uParticleRadius;
  float yPosition = 1. - ((.5 + floor(aIndex / uParticleRadius)) / uParticleRadius);
  vec2 screenPos = vec2(-1. + (xPosition * 2.), -1. + (yPosition * 2.));
  gl_Position = vec4(screenPos, 0., 1.);
  gl_PointSize = 1.;
  vUV = vec2(xPosition, yPosition);
}`;var H0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ts(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function W0(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var n=function t(){if(this instanceof t){var a=[null];a.push.apply(a,arguments);var f=Function.bind.apply(e,a);return new f}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(r).forEach(function(t){var a=Object.getOwnPropertyDescriptor(r,t);Object.defineProperty(n,t,a.get?a:{enumerable:!0,get:function(){return r[t]}})}),n}var as={exports:{}};(function(r,e){(function(n,t){r.exports=t()})(H0,function(){var n=function(i){return i instanceof Uint8Array||i instanceof Uint16Array||i instanceof Uint32Array||i instanceof Int8Array||i instanceof Int16Array||i instanceof Int32Array||i instanceof Float32Array||i instanceof Float64Array||i instanceof Uint8ClampedArray},t=function(i,u){for(var b=Object.keys(u),P=0;P<b.length;++P)i[b[P]]=u[b[P]];return i},a=`
`;function f(i){return typeof atob<"u"?atob(i):"base64:"+i}function s(i){var u=new Error("(regl) "+i);throw console.error(u),u}function c(i,u){i||s(u)}function o(i){return i?": "+i:""}function m(i,u,b){i in u||s("unknown parameter ("+i+")"+o(b)+". possible values: "+Object.keys(u).join())}function E(i,u){n(i)||s("invalid parameter type"+o(u)+". must be a typed array")}function O(i,u){switch(u){case"number":return typeof i=="number";case"object":return typeof i=="object";case"string":return typeof i=="string";case"boolean":return typeof i=="boolean";case"function":return typeof i=="function";case"undefined":return typeof i>"u";case"symbol":return typeof i=="symbol"}}function G(i,u,b){O(i,u)||s("invalid parameter type"+o(b)+". expected "+u+", got "+typeof i)}function F(i,u){i>=0&&(i|0)===i||s("invalid parameter type, ("+i+")"+o(u)+". must be a nonnegative integer")}function V(i,u,b){u.indexOf(i)<0&&s("invalid value"+o(b)+". must be one of: "+u)}var K=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function j(i){Object.keys(i).forEach(function(u){K.indexOf(u)<0&&s('invalid regl constructor argument "'+u+'". must be one of '+K)})}function fr(i,u){for(i=i+"";i.length<u;)i=" "+i;return i}function Gr(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Or(i,u){this.number=i,this.line=u,this.errors=[]}function Cr(i,u,b){this.file=i,this.line=u,this.message=b}function Rr(){var i=new Error,u=(i.stack||i).toString(),b=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(u);if(b)return b[1];var P=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(u);return P?P[1]:"unknown"}function Pr(){var i=new Error,u=(i.stack||i).toString(),b=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(u);if(b)return b[1];var P=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(u);return P?P[1]:"unknown"}function Hr(i,u){var b=i.split(`
`),P=1,U=0,D={unknown:new Gr,0:new Gr};D.unknown.name=D[0].name=u||Rr(),D.unknown.lines.push(new Or(0,""));for(var N=0;N<b.length;++N){var Q=b[N],Y=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Q);if(Y)switch(Y[1]){case"line":var nr=/(\d+)(\s+\d+)?/.exec(Y[2]);nr&&(P=nr[1]|0,nr[2]&&(U=nr[2]|0,U in D||(D[U]=new Gr)));break;case"define":var ar=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Y[2]);ar&&(D[U].name=ar[1]?f(ar[2]):ar[2]);break}D[U].lines.push(new Or(P++,Q))}return Object.keys(D).forEach(function(tr){var sr=D[tr];sr.lines.forEach(function(Z){sr.index[Z.number]=Z})}),D}function Qr(i){var u=[];return i.split(`
`).forEach(function(b){if(!(b.length<5)){var P=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(b);P?u.push(new Cr(P[1]|0,P[2]|0,P[3].trim())):b.length>0&&u.push(new Cr("unknown",0,b))}}),u}function Kr(i,u){u.forEach(function(b){var P=i[b.file];if(P){var U=P.index[b.line];if(U){U.errors.push(b),P.hasErrors=!0;return}}i.unknown.hasErrors=!0,i.unknown.lines[0].errors.push(b)})}function Xr(i,u,b,P,U){if(!i.getShaderParameter(u,i.COMPILE_STATUS)){var D=i.getShaderInfoLog(u),N=P===i.FRAGMENT_SHADER?"fragment":"vertex";Be(b,"string",N+" shader source must be a string",U);var Q=Hr(b,U),Y=Qr(D);Kr(Q,Y),Object.keys(Q).forEach(function(nr){var ar=Q[nr];if(!ar.hasErrors)return;var tr=[""],sr=[""];function Z(er,S){tr.push(er),sr.push(S||"")}Z("file number "+nr+": "+ar.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ar.lines.forEach(function(er){if(er.errors.length>0){Z(fr(er.number,4)+"|  ","background-color:yellow; font-weight:bold"),Z(er.line+a,"color:red; background-color:yellow; font-weight:bold");var S=0;er.errors.forEach(function(I){var rr=I.message,mr=/^\s*'(.*)'\s*:\s*(.*)$/.exec(rr);if(mr){var W=mr[1];switch(rr=mr[2],W){case"assign":W="=";break}S=Math.max(er.line.indexOf(W,S),0)}else S=0;Z(fr("| ",6)),Z(fr("^^^",S+3)+a,"font-weight:bold"),Z(fr("| ",6)),Z(rr+a,"font-weight:bold")}),Z(fr("| ",6)+a)}else Z(fr(er.number,4)+"|  "),Z(er.line+a,"color:red")}),typeof document<"u"&&!window.chrome?(sr[0]=tr.join("%c"),console.log.apply(console,sr)):console.log(tr.join(""))}),c.raise("Error compiling "+N+" shader, "+Q[0].name)}}function re(i,u,b,P,U){if(!i.getProgramParameter(u,i.LINK_STATUS)){var D=i.getProgramInfoLog(u),N=Hr(b,U),Q=Hr(P,U),Y='Error linking program with vertex shader, "'+Q[0].name+'", and fragment shader "'+N[0].name+'"';typeof document<"u"?console.log("%c"+Y+a+"%c"+D,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Y+a+D),c.raise(Y)}}function Wr(i){i._commandRef=Rr()}function ee(i,u,b,P){Wr(i);function U(Y){return Y?P.id(Y):0}i._fragId=U(i.static.frag),i._vertId=U(i.static.vert);function D(Y,nr){Object.keys(nr).forEach(function(ar){Y[P.id(ar)]=!0})}var N=i._uniformSet={};D(N,u.static),D(N,u.dynamic);var Q=i._attributeSet={};D(Q,b.static),D(Q,b.dynamic),i._hasCount="count"in i.static||"count"in i.dynamic||"elements"in i.static||"elements"in i.dynamic}function Ir(i,u){var b=Pr();s(i+" in command "+(u||Rr())+(b==="unknown"?"":" called from "+b))}function xe(i,u,b){i||Ir(u,b||Rr())}function Qe(i,u,b,P){i in u||Ir("unknown parameter ("+i+")"+o(b)+". possible values: "+Object.keys(u).join(),P||Rr())}function Be(i,u,b,P){O(i,u)||Ir("invalid parameter type"+o(b)+". expected "+u+", got "+typeof i,P||Rr())}function Qn(i){i()}function Kn(i,u,b){i.texture?V(i.texture._texture.internalformat,u,"unsupported texture format for attachment"):V(i.renderbuffer._renderbuffer.format,b,"unsupported renderbuffer format for attachment")}var Zn=33071,Ya=9728,pc=9984,yc=9985,_c=9986,bc=9987,xc=5120,Ec=5121,Ac=5122,Tc=5123,gc=5124,Mc=5125,Qa=5126,Ka=32819,Za=32820,Ja=33635,ri=34042,Sc=36193,Ee={};Ee[xc]=Ee[Ec]=1,Ee[Ac]=Ee[Tc]=Ee[Sc]=Ee[Ja]=Ee[Ka]=Ee[Za]=2,Ee[gc]=Ee[Mc]=Ee[Qa]=Ee[ri]=4;function ei(i,u){return i===Za||i===Ka||i===Ja?2:i===ri?4:Ee[i]*u}function Jn(i){return!(i&i-1)&&!!i}function wc(i,u,b){var P,U=u.width,D=u.height,N=u.channels;c(U>0&&U<=b.maxTextureSize&&D>0&&D<=b.maxTextureSize,"invalid texture shape"),(i.wrapS!==Zn||i.wrapT!==Zn)&&c(Jn(U)&&Jn(D),"incompatible wrap mode for texture, both width and height must be power of 2"),u.mipmask===1?U!==1&&D!==1&&c(i.minFilter!==pc&&i.minFilter!==_c&&i.minFilter!==yc&&i.minFilter!==bc,"min filter requires mipmap"):(c(Jn(U)&&Jn(D),"texture must be a square power of 2 to support mipmapping"),c(u.mipmask===(U<<1)-1,"missing or incomplete mipmap data")),u.type===Qa&&(b.extensions.indexOf("oes_texture_float_linear")<0&&c(i.minFilter===Ya&&i.magFilter===Ya,"filter not supported, must enable oes_texture_float_linear"),c(!i.genMipmaps,"mipmap generation not supported with float textures"));var Q=u.images;for(P=0;P<16;++P)if(Q[P]){var Y=U>>P,nr=D>>P;c(u.mipmask&1<<P,"missing mipmap data");var ar=Q[P];if(c(ar.width===Y&&ar.height===nr,"invalid shape for mip images"),c(ar.format===u.format&&ar.internalformat===u.internalformat&&ar.type===u.type,"incompatible type for mip image"),!ar.compressed)if(ar.data){var tr=Math.ceil(ei(ar.type,N)*Y/ar.unpackAlignment)*ar.unpackAlignment;c(ar.data.byteLength===tr*nr,"invalid data for image, buffer size is inconsistent with image format")}else ar.element||ar.copy}else i.genMipmaps||c((u.mipmask&1<<P)===0,"extra mipmap data");u.compressed&&c(!i.genMipmaps,"mipmap generation for compressed images not supported")}function Lc(i,u,b,P){var U=i.width,D=i.height,N=i.channels;c(U>0&&U<=P.maxTextureSize&&D>0&&D<=P.maxTextureSize,"invalid texture shape"),c(U===D,"cube map must be square"),c(u.wrapS===Zn&&u.wrapT===Zn,"wrap mode not supported by cube map");for(var Q=0;Q<b.length;++Q){var Y=b[Q];c(Y.width===U&&Y.height===D,"inconsistent cube map face shape"),u.genMipmaps&&(c(!Y.compressed,"can not generate mipmap for compressed textures"),c(Y.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var nr=Y.images,ar=0;ar<16;++ar){var tr=nr[ar];if(tr){var sr=U>>ar,Z=D>>ar;c(Y.mipmask&1<<ar,"missing mipmap data"),c(tr.width===sr&&tr.height===Z,"invalid shape for mip images"),c(tr.format===i.format&&tr.internalformat===i.internalformat&&tr.type===i.type,"incompatible type for mip image"),tr.compressed||(tr.data?c(tr.data.byteLength===sr*Z*Math.max(ei(tr.type,N),tr.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):tr.element||tr.copy)}}}}var v=t(c,{optional:Qn,raise:s,commandRaise:Ir,command:xe,parameter:m,commandParameter:Qe,constructor:j,type:G,commandType:Be,isTypedArray:E,nni:F,oneOf:V,shaderError:Xr,linkError:re,callSite:Pr,saveCommandRef:Wr,saveDrawInfo:ee,framebufferFormat:Kn,guessCommand:Rr,texture2D:wc,textureCube:Lc}),Oc=0,Rc=0,Cc=5,Gc=6;function Ke(i,u){this.id=Oc++,this.type=i,this.data=u}function ni(i){return i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Rn(i){if(i.length===0)return[];var u=i.charAt(0),b=i.charAt(i.length-1);if(i.length>1&&u===b&&(u==='"'||u==="'"))return['"'+ni(i.substr(1,i.length-2))+'"'];var P=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(i);if(P)return Rn(i.substr(0,P.index)).concat(Rn(P[1])).concat(Rn(i.substr(P.index+P[0].length)));var U=i.split(".");if(U.length===1)return['"'+ni(i)+'"'];for(var D=[],N=0;N<U.length;++N)D=D.concat(Rn(U[N]));return D}function ti(i){return"["+Rn(i).join("][")+"]"}function Fc(i,u){return new Ke(i,ti(u+""))}function Dc(i){return typeof i=="function"&&!i._reglType||i instanceof Ke}function ai(i,u){if(typeof i=="function")return new Ke(Rc,i);if(typeof i=="number"||typeof i=="boolean")return new Ke(Cc,i);if(Array.isArray(i))return new Ke(Gc,i.map(function(b,P){return ai(b,u+"["+P+"]")}));if(i instanceof Ke)return i;v(!1,"invalid option type in uniform "+u)}var Ae={DynamicVariable:Ke,define:Fc,isDynamic:Dc,unbox:ai,accessor:ti},kt={next:typeof requestAnimationFrame=="function"?function(i){return requestAnimationFrame(i)}:function(i){return setTimeout(i,16)},cancel:typeof cancelAnimationFrame=="function"?function(i){return cancelAnimationFrame(i)}:clearTimeout},ii=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Pc(){var i={"":0},u=[""];return{id:function(b){var P=i[b];return P||(P=i[b]=u.length,u.push(b),P)},str:function(b){return u[b]}}}function $c(i,u,b){var P=document.createElement("canvas");t(P.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),i.appendChild(P),i===document.body&&(P.style.position="absolute",t(i.style,{margin:0,padding:0}));function U(){var Q=window.innerWidth,Y=window.innerHeight;if(i!==document.body){var nr=P.getBoundingClientRect();Q=nr.right-nr.left,Y=nr.bottom-nr.top}P.width=b*Q,P.height=b*Y}var D;i!==document.body&&typeof ResizeObserver=="function"?(D=new ResizeObserver(function(){setTimeout(U)}),D.observe(i)):window.addEventListener("resize",U,!1);function N(){D?D.disconnect():window.removeEventListener("resize",U),i.removeChild(P)}return U(),{canvas:P,onDestroy:N}}function Ic(i,u){function b(P){try{return i.getContext(P,u)}catch{return null}}return b("webgl")||b("experimental-webgl")||b("webgl-experimental")}function Nc(i){return typeof i.nodeName=="string"&&typeof i.appendChild=="function"&&typeof i.getBoundingClientRect=="function"}function Bc(i){return typeof i.drawArrays=="function"||typeof i.drawElements=="function"}function fi(i){return typeof i=="string"?i.split():(v(Array.isArray(i),"invalid extension array"),i)}function si(i){return typeof i=="string"?(v(typeof document<"u","not supported outside of DOM"),document.querySelector(i)):i}function kc(i){var u=i||{},b,P,U,D,N={},Q=[],Y=[],nr=typeof window>"u"?1:window.devicePixelRatio,ar=!1,tr=function(er){er&&v.raise(er)},sr=function(){};if(typeof u=="string"?(v(typeof document<"u","selector queries only supported in DOM enviroments"),b=document.querySelector(u),v(b,"invalid query string for element")):typeof u=="object"?Nc(u)?b=u:Bc(u)?(D=u,U=D.canvas):(v.constructor(u),"gl"in u?D=u.gl:"canvas"in u?U=si(u.canvas):"container"in u&&(P=si(u.container)),"attributes"in u&&(N=u.attributes,v.type(N,"object","invalid context attributes")),"extensions"in u&&(Q=fi(u.extensions)),"optionalExtensions"in u&&(Y=fi(u.optionalExtensions)),"onDone"in u&&(v.type(u.onDone,"function","invalid or missing onDone callback"),tr=u.onDone),"profile"in u&&(ar=!!u.profile),"pixelRatio"in u&&(nr=+u.pixelRatio,v(nr>0,"invalid pixel ratio"))):v.raise("invalid arguments to regl"),b&&(b.nodeName.toLowerCase()==="canvas"?U=b:P=b),!D){if(!U){v(typeof document<"u","must manually specify webgl context outside of DOM environments");var Z=$c(P||document.body,tr,nr);if(!Z)return null;U=Z.canvas,sr=Z.onDestroy}N.premultipliedAlpha===void 0&&(N.premultipliedAlpha=!0),D=Ic(U,N)}return D?{gl:D,canvas:U,container:P,extensions:Q,optionalExtensions:Y,pixelRatio:nr,profile:ar,onDone:tr,onDestroy:sr}:(sr(),tr("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function zc(i,u){var b={};function P(N){v.type(N,"string","extension name must be string");var Q=N.toLowerCase(),Y;try{Y=b[Q]=i.getExtension(Q)}catch{}return!!Y}for(var U=0;U<u.extensions.length;++U){var D=u.extensions[U];if(!P(D))return u.onDestroy(),u.onDone('"'+D+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return u.optionalExtensions.forEach(P),{extensions:b,restore:function(){Object.keys(b).forEach(function(N){if(b[N]&&!P(N))throw new Error("(regl): error restoring extension "+N)})}}}function Te(i,u){for(var b=Array(i),P=0;P<i;++P)b[P]=u(P);return b}var Uc=5120,Vc=5121,jc=5122,qc=5123,Xc=5124,Hc=5125,Wc=5126;function Yc(i){for(var u=16;u<=1<<28;u*=16)if(i<=u)return u;return 0}function ci(i){var u,b;return u=(i>65535)<<4,i>>>=u,b=(i>255)<<3,i>>>=b,u|=b,b=(i>15)<<2,i>>>=b,u|=b,b=(i>3)<<1,i>>>=b,u|=b,u|i>>1}function li(){var i=Te(8,function(){return[]});function u(D){var N=Yc(D),Q=i[ci(N)>>2];return Q.length>0?Q.pop():new ArrayBuffer(N)}function b(D){i[ci(D.byteLength)>>2].push(D)}function P(D,N){var Q=null;switch(D){case Uc:Q=new Int8Array(u(N),0,N);break;case Vc:Q=new Uint8Array(u(N),0,N);break;case jc:Q=new Int16Array(u(2*N),0,N);break;case qc:Q=new Uint16Array(u(2*N),0,N);break;case Xc:Q=new Int32Array(u(4*N),0,N);break;case Hc:Q=new Uint32Array(u(4*N),0,N);break;case Wc:Q=new Float32Array(u(4*N),0,N);break;default:return null}return Q.length!==N?Q.subarray(0,N):Q}function U(D){b(D.buffer)}return{alloc:u,free:b,allocType:P,freeType:U}}var ie=li();ie.zero=li();var Qc=3408,Kc=3410,Zc=3411,Jc=3412,rl=3413,el=3414,nl=3415,tl=33901,al=33902,il=3379,fl=3386,sl=34921,cl=36347,ll=36348,ol=35661,ul=35660,vl=34930,dl=36349,hl=34076,ml=34024,pl=7936,yl=7937,_l=7938,bl=35724,xl=34047,El=36063,Al=34852,rt=3553,oi=34067,Tl=34069,gl=33984,Cn=6408,zt=5126,ui=5121,Ut=36160,Ml=36053,Sl=36064,wl=16384,Ll=function(i,u){var b=1;u.ext_texture_filter_anisotropic&&(b=i.getParameter(xl));var P=1,U=1;u.webgl_draw_buffers&&(P=i.getParameter(Al),U=i.getParameter(El));var D=!!u.oes_texture_float;if(D){var N=i.createTexture();i.bindTexture(rt,N),i.texImage2D(rt,0,Cn,1,1,0,Cn,zt,null);var Q=i.createFramebuffer();if(i.bindFramebuffer(Ut,Q),i.framebufferTexture2D(Ut,Sl,rt,N,0),i.bindTexture(rt,null),i.checkFramebufferStatus(Ut)!==Ml)D=!1;else{i.viewport(0,0,1,1),i.clearColor(1,0,0,1),i.clear(wl);var Y=ie.allocType(zt,4);i.readPixels(0,0,1,1,Cn,zt,Y),i.getError()?D=!1:(i.deleteFramebuffer(Q),i.deleteTexture(N),D=Y[0]===1),ie.freeType(Y)}}var nr=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ar=!0;if(!nr){var tr=i.createTexture(),sr=ie.allocType(ui,36);i.activeTexture(gl),i.bindTexture(oi,tr),i.texImage2D(Tl,0,Cn,3,3,0,Cn,ui,sr),ie.freeType(sr),i.bindTexture(oi,null),i.deleteTexture(tr),ar=!i.getError()}return{colorBits:[i.getParameter(Kc),i.getParameter(Zc),i.getParameter(Jc),i.getParameter(rl)],depthBits:i.getParameter(el),stencilBits:i.getParameter(nl),subpixelBits:i.getParameter(Qc),extensions:Object.keys(u).filter(function(Z){return!!u[Z]}),maxAnisotropic:b,maxDrawbuffers:P,maxColorAttachments:U,pointSizeDims:i.getParameter(tl),lineWidthDims:i.getParameter(al),maxViewportDims:i.getParameter(fl),maxCombinedTextureUnits:i.getParameter(ol),maxCubeMapSize:i.getParameter(hl),maxRenderbufferSize:i.getParameter(ml),maxTextureUnits:i.getParameter(vl),maxTextureSize:i.getParameter(il),maxAttributes:i.getParameter(sl),maxVertexUniforms:i.getParameter(cl),maxVertexTextureUnits:i.getParameter(ul),maxVaryingVectors:i.getParameter(ll),maxFragmentUniforms:i.getParameter(dl),glsl:i.getParameter(bl),renderer:i.getParameter(yl),vendor:i.getParameter(pl),version:i.getParameter(_l),readFloat:D,npotTextureCube:ar}};function Le(i){return!!i&&typeof i=="object"&&Array.isArray(i.shape)&&Array.isArray(i.stride)&&typeof i.offset=="number"&&i.shape.length===i.stride.length&&(Array.isArray(i.data)||n(i.data))}var ge=function(i){return Object.keys(i).map(function(u){return i[u]})},et={shape:Gl,flatten:Cl};function Ol(i,u,b){for(var P=0;P<u;++P)b[P]=i[P]}function Rl(i,u,b,P){for(var U=0,D=0;D<u;++D)for(var N=i[D],Q=0;Q<b;++Q)P[U++]=N[Q]}function vi(i,u,b,P,U,D){for(var N=D,Q=0;Q<u;++Q)for(var Y=i[Q],nr=0;nr<b;++nr)for(var ar=Y[nr],tr=0;tr<P;++tr)U[N++]=ar[tr]}function di(i,u,b,P,U){for(var D=1,N=b+1;N<u.length;++N)D*=u[N];var Q=u[b];if(u.length-b===4){var Y=u[b+1],nr=u[b+2],ar=u[b+3];for(N=0;N<Q;++N)vi(i[N],Y,nr,ar,P,U),U+=D}else for(N=0;N<Q;++N)di(i[N],u,b+1,P,U),U+=D}function Cl(i,u,b,P){var U=1;if(u.length)for(var D=0;D<u.length;++D)U*=u[D];else U=0;var N=P||ie.allocType(b,U);switch(u.length){case 0:break;case 1:Ol(i,u[0],N);break;case 2:Rl(i,u[0],u[1],N);break;case 3:vi(i,u[0],u[1],u[2],N,0);break;default:di(i,u,0,N,0)}return N}function Gl(i){for(var u=[],b=i;b.length;b=b[0])u.push(b.length);return u}var Vt={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Fl=5120,Dl=5122,Pl=5124,$l=5121,Il=5123,Nl=5125,Bl=5126,kl=5126,Ze={int8:Fl,int16:Dl,int32:Pl,uint8:$l,uint16:Il,uint32:Nl,float:Bl,float32:kl},zl=35048,Ul=35040,nt={dynamic:zl,stream:Ul,static:35044},jt=et.flatten,hi=et.shape,mi=35044,Vl=35040,qt=5121,Xt=5126,ke=[];ke[5120]=1,ke[5122]=2,ke[5124]=4,ke[5121]=1,ke[5123]=2,ke[5125]=4,ke[5126]=4;function tt(i){return Vt[Object.prototype.toString.call(i)]|0}function pi(i,u){for(var b=0;b<u.length;++b)i[b]=u[b]}function yi(i,u,b,P,U,D,N){for(var Q=0,Y=0;Y<b;++Y)for(var nr=0;nr<P;++nr)i[Q++]=u[U*Y+D*nr+N]}function jl(i,u,b,P){var U=0,D={};function N(S){this.id=U++,this.buffer=i.createBuffer(),this.type=S,this.usage=mi,this.byteLength=0,this.dimension=1,this.dtype=qt,this.persistentData=null,b.profile&&(this.stats={size:0})}N.prototype.bind=function(){i.bindBuffer(this.type,this.buffer)},N.prototype.destroy=function(){sr(this)};var Q=[];function Y(S,I){var rr=Q.pop();return rr||(rr=new N(S)),rr.bind(),tr(rr,I,Vl,0,1,!1),rr}function nr(S){Q.push(S)}function ar(S,I,rr){S.byteLength=I.byteLength,i.bufferData(S.type,I,rr)}function tr(S,I,rr,mr,W,dr){var ur;if(S.usage=rr,Array.isArray(I)){if(S.dtype=mr||Xt,I.length>0){var Ar;if(Array.isArray(I[0])){ur=hi(I);for(var q=1,z=1;z<ur.length;++z)q*=ur[z];S.dimension=q,Ar=jt(I,ur,S.dtype),ar(S,Ar,rr),dr?S.persistentData=Ar:ie.freeType(Ar)}else if(typeof I[0]=="number"){S.dimension=W;var _r=ie.allocType(S.dtype,I.length);pi(_r,I),ar(S,_r,rr),dr?S.persistentData=_r:ie.freeType(_r)}else n(I[0])?(S.dimension=I[0].length,S.dtype=mr||tt(I[0])||Xt,Ar=jt(I,[I.length,I[0].length],S.dtype),ar(S,Ar,rr),dr?S.persistentData=Ar:ie.freeType(Ar)):v.raise("invalid buffer data")}}else if(n(I))S.dtype=mr||tt(I),S.dimension=W,ar(S,I,rr),dr&&(S.persistentData=new Uint8Array(new Uint8Array(I.buffer)));else if(Le(I)){ur=I.shape;var cr=I.stride,J=I.offset,lr=0,or=0,Fr=0,Lr=0;ur.length===1?(lr=ur[0],or=1,Fr=cr[0],Lr=0):ur.length===2?(lr=ur[0],or=ur[1],Fr=cr[0],Lr=cr[1]):v.raise("invalid shape"),S.dtype=mr||tt(I.data)||Xt,S.dimension=or;var vr=ie.allocType(S.dtype,lr*or);yi(vr,I.data,lr,or,Fr,Lr,J),ar(S,vr,rr),dr?S.persistentData=vr:ie.freeType(vr)}else I instanceof ArrayBuffer?(S.dtype=qt,S.dimension=W,ar(S,I,rr),dr&&(S.persistentData=new Uint8Array(new Uint8Array(I)))):v.raise("invalid buffer data")}function sr(S){u.bufferCount--,P(S);var I=S.buffer;v(I,"buffer must not be deleted already"),i.deleteBuffer(I),S.buffer=null,delete D[S.id]}function Z(S,I,rr,mr){u.bufferCount++;var W=new N(I);D[W.id]=W;function dr(q){var z=mi,_r=null,cr=0,J=0,lr=1;return Array.isArray(q)||n(q)||Le(q)||q instanceof ArrayBuffer?_r=q:typeof q=="number"?cr=q|0:q&&(v.type(q,"object","buffer arguments must be an object, a number or an array"),"data"in q&&(v(_r===null||Array.isArray(_r)||n(_r)||Le(_r),"invalid data for buffer"),_r=q.data),"usage"in q&&(v.parameter(q.usage,nt,"invalid buffer usage"),z=nt[q.usage]),"type"in q&&(v.parameter(q.type,Ze,"invalid buffer type"),J=Ze[q.type]),"dimension"in q&&(v.type(q.dimension,"number","invalid dimension"),lr=q.dimension|0),"length"in q&&(v.nni(cr,"buffer length must be a nonnegative integer"),cr=q.length|0)),W.bind(),_r?tr(W,_r,z,J,lr,mr):(cr&&i.bufferData(W.type,cr,z),W.dtype=J||qt,W.usage=z,W.dimension=lr,W.byteLength=cr),b.profile&&(W.stats.size=W.byteLength*ke[W.dtype]),dr}function ur(q,z){v(z+q.byteLength<=W.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+q.byteLength+" starting from offset "+z+" to a buffer of size "+W.byteLength),i.bufferSubData(W.type,z,q)}function Ar(q,z){var _r=(z||0)|0,cr;if(W.bind(),n(q)||q instanceof ArrayBuffer)ur(q,_r);else if(Array.isArray(q)){if(q.length>0)if(typeof q[0]=="number"){var J=ie.allocType(W.dtype,q.length);pi(J,q),ur(J,_r),ie.freeType(J)}else if(Array.isArray(q[0])||n(q[0])){cr=hi(q);var lr=jt(q,cr,W.dtype);ur(lr,_r),ie.freeType(lr)}else v.raise("invalid buffer data")}else if(Le(q)){cr=q.shape;var or=q.stride,Fr=0,Lr=0,vr=0,hr=0;cr.length===1?(Fr=cr[0],Lr=1,vr=or[0],hr=0):cr.length===2?(Fr=cr[0],Lr=cr[1],vr=or[0],hr=or[1]):v.raise("invalid shape");var Mr=Array.isArray(q.data)?W.dtype:tt(q.data),Dr=ie.allocType(Mr,Fr*Lr);yi(Dr,q.data,Fr,Lr,vr,hr,q.offset),ur(Dr,_r),ie.freeType(Dr)}else v.raise("invalid data for buffer subdata");return dr}return rr||dr(S),dr._reglType="buffer",dr._buffer=W,dr.subdata=Ar,b.profile&&(dr.stats=W.stats),dr.destroy=function(){sr(W)},dr}function er(){ge(D).forEach(function(S){S.buffer=i.createBuffer(),i.bindBuffer(S.type,S.buffer),i.bufferData(S.type,S.persistentData||S.byteLength,S.usage)})}return b.profile&&(u.getTotalBufferSize=function(){var S=0;return Object.keys(D).forEach(function(I){S+=D[I].stats.size}),S}),{create:Z,createStream:Y,destroyStream:nr,clear:function(){ge(D).forEach(sr),Q.forEach(sr)},getBuffer:function(S){return S&&S._buffer instanceof N?S._buffer:null},restore:er,_initBuffer:tr}}var ql=0,Xl=0,Hl=1,Wl=1,Yl=4,Ql=4,ze={points:ql,point:Xl,lines:Hl,line:Wl,triangles:Yl,triangle:Ql,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Kl=0,Zl=1,Gn=4,Jl=5120,hn=5121,_i=5122,mn=5123,bi=5124,Je=5125,Ht=34963,ro=35040,eo=35044;function no(i,u,b,P){var U={},D=0,N={uint8:hn,uint16:mn};u.oes_element_index_uint&&(N.uint32=Je);function Q(er){this.id=D++,U[this.id]=this,this.buffer=er,this.primType=Gn,this.vertCount=0,this.type=0}Q.prototype.bind=function(){this.buffer.bind()};var Y=[];function nr(er){var S=Y.pop();return S||(S=new Q(b.create(null,Ht,!0,!1)._buffer)),tr(S,er,ro,-1,-1,0,0),S}function ar(er){Y.push(er)}function tr(er,S,I,rr,mr,W,dr){er.buffer.bind();var ur;if(S){var Ar=dr;!dr&&(!n(S)||Le(S)&&!n(S.data))&&(Ar=u.oes_element_index_uint?Je:mn),b._initBuffer(er.buffer,S,I,Ar,3)}else i.bufferData(Ht,W,I),er.buffer.dtype=ur||hn,er.buffer.usage=I,er.buffer.dimension=3,er.buffer.byteLength=W;if(ur=dr,!dr){switch(er.buffer.dtype){case hn:case Jl:ur=hn;break;case mn:case _i:ur=mn;break;case Je:case bi:ur=Je;break;default:v.raise("unsupported type for element array")}er.buffer.dtype=ur}er.type=ur,v(ur!==Je||!!u.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var q=mr;q<0&&(q=er.buffer.byteLength,ur===mn?q>>=1:ur===Je&&(q>>=2)),er.vertCount=q;var z=rr;if(rr<0){z=Gn;var _r=er.buffer.dimension;_r===1&&(z=Kl),_r===2&&(z=Zl),_r===3&&(z=Gn)}er.primType=z}function sr(er){P.elementsCount--,v(er.buffer!==null,"must not double destroy elements"),delete U[er.id],er.buffer.destroy(),er.buffer=null}function Z(er,S){var I=b.create(null,Ht,!0),rr=new Q(I._buffer);P.elementsCount++;function mr(W){if(!W)I(),rr.primType=Gn,rr.vertCount=0,rr.type=hn;else if(typeof W=="number")I(W),rr.primType=Gn,rr.vertCount=W|0,rr.type=hn;else{var dr=null,ur=eo,Ar=-1,q=-1,z=0,_r=0;Array.isArray(W)||n(W)||Le(W)?dr=W:(v.type(W,"object","invalid arguments for elements"),"data"in W&&(dr=W.data,v(Array.isArray(dr)||n(dr)||Le(dr),"invalid data for element buffer")),"usage"in W&&(v.parameter(W.usage,nt,"invalid element buffer usage"),ur=nt[W.usage]),"primitive"in W&&(v.parameter(W.primitive,ze,"invalid element buffer primitive"),Ar=ze[W.primitive]),"count"in W&&(v(typeof W.count=="number"&&W.count>=0,"invalid vertex count for elements"),q=W.count|0),"type"in W&&(v.parameter(W.type,N,"invalid buffer type"),_r=N[W.type]),"length"in W?z=W.length|0:(z=q,_r===mn||_r===_i?z*=2:(_r===Je||_r===bi)&&(z*=4))),tr(rr,dr,ur,Ar,q,z,_r)}return mr}return mr(er),mr._reglType="elements",mr._elements=rr,mr.subdata=function(W,dr){return I.subdata(W,dr),mr},mr.destroy=function(){sr(rr)},mr}return{create:Z,createStream:nr,destroyStream:ar,getElements:function(er){return typeof er=="function"&&er._elements instanceof Q?er._elements:null},clear:function(){ge(U).forEach(sr)}}}var xi=new Float32Array(1),to=new Uint32Array(xi.buffer),ao=5123;function Ei(i){for(var u=ie.allocType(ao,i.length),b=0;b<i.length;++b)if(isNaN(i[b]))u[b]=65535;else if(i[b]===1/0)u[b]=31744;else if(i[b]===-1/0)u[b]=64512;else{xi[0]=i[b];var P=to[0],U=P>>>31<<15,D=(P<<1>>>24)-127,N=P>>13&1024-1;if(D<-24)u[b]=U;else if(D<-14){var Q=-14-D;u[b]=U+(N+1024>>Q)}else D>15?u[b]=U+31744:u[b]=U+(D+15<<10)+N}return u}function Zr(i){return Array.isArray(i)||n(i)}var Ai=function(i){return!(i&i-1)&&!!i},io=34467,Ce=3553,Wt=34067,at=34069,rn=6408,Yt=6406,it=6407,Fn=6409,ft=6410,Ti=32854,Qt=32855,gi=36194,fo=32819,so=32820,co=33635,lo=34042,Kt=6402,st=34041,Zt=35904,Jt=35906,pn=36193,ra=33776,ea=33777,na=33778,ta=33779,Mi=35986,Si=35987,wi=34798,Li=35840,Oi=35841,Ri=35842,Ci=35843,Gi=36196,yn=5121,aa=5123,ia=5125,Dn=5126,oo=10242,uo=10243,vo=10497,fa=33071,ho=33648,mo=10240,po=10241,sa=9728,yo=9729,ca=9984,Fi=9985,Di=9986,la=9987,_o=33170,ct=4352,bo=4353,xo=4354,Eo=34046,Ao=3317,To=37440,go=37441,Mo=37443,Pi=37444,Pn=33984,So=[ca,Di,Fi,la],lt=[0,Fn,ft,it,rn],Se={};Se[Fn]=Se[Yt]=Se[Kt]=1,Se[st]=Se[ft]=2,Se[it]=Se[Zt]=3,Se[rn]=Se[Jt]=4;function _n(i){return"[object "+i+"]"}var $i=_n("HTMLCanvasElement"),Ii=_n("OffscreenCanvas"),Ni=_n("CanvasRenderingContext2D"),Bi=_n("ImageBitmap"),ki=_n("HTMLImageElement"),zi=_n("HTMLVideoElement"),wo=Object.keys(Vt).concat([$i,Ii,Ni,Bi,ki,zi]),bn=[];bn[yn]=1,bn[Dn]=4,bn[pn]=2,bn[aa]=2,bn[ia]=4;var de=[];de[Ti]=2,de[Qt]=2,de[gi]=2,de[st]=4,de[ra]=.5,de[ea]=.5,de[na]=1,de[ta]=1,de[Mi]=.5,de[Si]=1,de[wi]=1,de[Li]=.5,de[Oi]=.25,de[Ri]=.5,de[Ci]=.25,de[Gi]=.5;function Ui(i){return Array.isArray(i)&&(i.length===0||typeof i[0]=="number")}function Vi(i){if(!Array.isArray(i))return!1;var u=i.length;return!(u===0||!Zr(i[0]))}function en(i){return Object.prototype.toString.call(i)}function ji(i){return en(i)===$i}function qi(i){return en(i)===Ii}function Lo(i){return en(i)===Ni}function Oo(i){return en(i)===Bi}function Ro(i){return en(i)===ki}function Co(i){return en(i)===zi}function oa(i){if(!i)return!1;var u=en(i);return wo.indexOf(u)>=0?!0:Ui(i)||Vi(i)||Le(i)}function Xi(i){return Vt[Object.prototype.toString.call(i)]|0}function Go(i,u){var b=u.length;switch(i.type){case yn:case aa:case ia:case Dn:var P=ie.allocType(i.type,b);P.set(u),i.data=P;break;case pn:i.data=Ei(u);break;default:v.raise("unsupported texture type, must specify a typed array")}}function Hi(i,u){return ie.allocType(i.type===pn?Dn:i.type,u)}function Wi(i,u){i.type===pn?(i.data=Ei(u),ie.freeType(u)):i.data=u}function Fo(i,u,b,P,U,D){for(var N=i.width,Q=i.height,Y=i.channels,nr=N*Q*Y,ar=Hi(i,nr),tr=0,sr=0;sr<Q;++sr)for(var Z=0;Z<N;++Z)for(var er=0;er<Y;++er)ar[tr++]=u[b*Z+P*sr+U*er+D];Wi(i,ar)}function ot(i,u,b,P,U,D){var N;if(typeof de[i]<"u"?N=de[i]:N=Se[i]*bn[u],D&&(N*=6),U){for(var Q=0,Y=b;Y>=1;)Q+=N*Y*Y,Y/=2;return Q}else return N*b*P}function Do(i,u,b,P,U,D,N){var Q={"don't care":ct,"dont care":ct,nice:xo,fast:bo},Y={repeat:vo,clamp:fa,mirror:ho},nr={nearest:sa,linear:yo},ar=t({mipmap:la,"nearest mipmap nearest":ca,"linear mipmap nearest":Fi,"nearest mipmap linear":Di,"linear mipmap linear":la},nr),tr={none:0,browser:Pi},sr={uint8:yn,rgba4:fo,rgb565:co,"rgb5 a1":so},Z={alpha:Yt,luminance:Fn,"luminance alpha":ft,rgb:it,rgba:rn,rgba4:Ti,"rgb5 a1":Qt,rgb565:gi},er={};u.ext_srgb&&(Z.srgb=Zt,Z.srgba=Jt),u.oes_texture_float&&(sr.float32=sr.float=Dn),u.oes_texture_half_float&&(sr.float16=sr["half float"]=pn),u.webgl_depth_texture&&(t(Z,{depth:Kt,"depth stencil":st}),t(sr,{uint16:aa,uint32:ia,"depth stencil":lo})),u.webgl_compressed_texture_s3tc&&t(er,{"rgb s3tc dxt1":ra,"rgba s3tc dxt1":ea,"rgba s3tc dxt3":na,"rgba s3tc dxt5":ta}),u.webgl_compressed_texture_atc&&t(er,{"rgb atc":Mi,"rgba atc explicit alpha":Si,"rgba atc interpolated alpha":wi}),u.webgl_compressed_texture_pvrtc&&t(er,{"rgb pvrtc 4bppv1":Li,"rgb pvrtc 2bppv1":Oi,"rgba pvrtc 4bppv1":Ri,"rgba pvrtc 2bppv1":Ci}),u.webgl_compressed_texture_etc1&&(er["rgb etc1"]=Gi);var S=Array.prototype.slice.call(i.getParameter(io));Object.keys(er).forEach(function(y){var $=er[y];S.indexOf($)>=0&&(Z[y]=$)});var I=Object.keys(Z);b.textureFormats=I;var rr=[];Object.keys(Z).forEach(function(y){var $=Z[y];rr[$]=y});var mr=[];Object.keys(sr).forEach(function(y){var $=sr[y];mr[$]=y});var W=[];Object.keys(nr).forEach(function(y){var $=nr[y];W[$]=y});var dr=[];Object.keys(ar).forEach(function(y){var $=ar[y];dr[$]=y});var ur=[];Object.keys(Y).forEach(function(y){var $=Y[y];ur[$]=y});var Ar=I.reduce(function(y,$){var C=Z[$];return C===Fn||C===Yt||C===Fn||C===ft||C===Kt||C===st||u.ext_srgb&&(C===Zt||C===Jt)?y[C]=C:C===Qt||$.indexOf("rgba")>=0?y[C]=rn:y[C]=it,y},{});function q(){this.internalformat=rn,this.format=rn,this.type=yn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Pi,this.width=0,this.height=0,this.channels=0}function z(y,$){y.internalformat=$.internalformat,y.format=$.format,y.type=$.type,y.compressed=$.compressed,y.premultiplyAlpha=$.premultiplyAlpha,y.flipY=$.flipY,y.unpackAlignment=$.unpackAlignment,y.colorSpace=$.colorSpace,y.width=$.width,y.height=$.height,y.channels=$.channels}function _r(y,$){if(!(typeof $!="object"||!$)){if("premultiplyAlpha"in $&&(v.type($.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),y.premultiplyAlpha=$.premultiplyAlpha),"flipY"in $&&(v.type($.flipY,"boolean","invalid texture flip"),y.flipY=$.flipY),"alignment"in $&&(v.oneOf($.alignment,[1,2,4,8],"invalid texture unpack alignment"),y.unpackAlignment=$.alignment),"colorSpace"in $&&(v.parameter($.colorSpace,tr,"invalid colorSpace"),y.colorSpace=tr[$.colorSpace]),"type"in $){var C=$.type;v(u.oes_texture_float||!(C==="float"||C==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),v(u.oes_texture_half_float||!(C==="half float"||C==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),v(u.webgl_depth_texture||!(C==="uint16"||C==="uint32"||C==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),v.parameter(C,sr,"invalid texture type"),y.type=sr[C]}var yr=y.width,Nr=y.height,d=y.channels,l=!1;"shape"in $?(v(Array.isArray($.shape)&&$.shape.length>=2,"shape must be an array"),yr=$.shape[0],Nr=$.shape[1],$.shape.length===3&&(d=$.shape[2],v(d>0&&d<=4,"invalid number of channels"),l=!0),v(yr>=0&&yr<=b.maxTextureSize,"invalid width"),v(Nr>=0&&Nr<=b.maxTextureSize,"invalid height")):("radius"in $&&(yr=Nr=$.radius,v(yr>=0&&yr<=b.maxTextureSize,"invalid radius")),"width"in $&&(yr=$.width,v(yr>=0&&yr<=b.maxTextureSize,"invalid width")),"height"in $&&(Nr=$.height,v(Nr>=0&&Nr<=b.maxTextureSize,"invalid height")),"channels"in $&&(d=$.channels,v(d>0&&d<=4,"invalid number of channels"),l=!0)),y.width=yr|0,y.height=Nr|0,y.channels=d|0;var x=!1;if("format"in $){var M=$.format;v(u.webgl_depth_texture||!(M==="depth"||M==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),v.parameter(M,Z,"invalid texture format");var w=y.internalformat=Z[M];y.format=Ar[w],M in sr&&("type"in $||(y.type=sr[M])),M in er&&(y.compressed=!0),x=!0}!l&&x?y.channels=Se[y.format]:l&&!x?y.channels!==lt[y.format]&&(y.format=y.internalformat=lt[y.channels]):x&&l&&v(y.channels===Se[y.format],"number of channels inconsistent with specified format")}}function cr(y){i.pixelStorei(To,y.flipY),i.pixelStorei(go,y.premultiplyAlpha),i.pixelStorei(Mo,y.colorSpace),i.pixelStorei(Ao,y.unpackAlignment)}function J(){q.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function lr(y,$){var C=null;if(oa($)?C=$:$&&(v.type($,"object","invalid pixel data type"),_r(y,$),"x"in $&&(y.xOffset=$.x|0),"y"in $&&(y.yOffset=$.y|0),oa($.data)&&(C=$.data)),v(!y.compressed||C instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),$.copy){v(!C,"can not specify copy and data field for the same texture");var yr=U.viewportWidth,Nr=U.viewportHeight;y.width=y.width||yr-y.xOffset,y.height=y.height||Nr-y.yOffset,y.needsCopy=!0,v(y.xOffset>=0&&y.xOffset<yr&&y.yOffset>=0&&y.yOffset<Nr&&y.width>0&&y.width<=yr&&y.height>0&&y.height<=Nr,"copy texture read out of bounds")}else if(!C)y.width=y.width||1,y.height=y.height||1,y.channels=y.channels||4;else if(n(C))y.channels=y.channels||4,y.data=C,!("type"in $)&&y.type===yn&&(y.type=Xi(C));else if(Ui(C))y.channels=y.channels||4,Go(y,C),y.alignment=1,y.needsFree=!0;else if(Le(C)){var d=C.data;!Array.isArray(d)&&y.type===yn&&(y.type=Xi(d));var l=C.shape,x=C.stride,M,w,T,A,g,h;l.length===3?(T=l[2],h=x[2]):(v(l.length===2,"invalid ndarray pixel data, must be 2 or 3D"),T=1,h=1),M=l[0],w=l[1],A=x[0],g=x[1],y.alignment=1,y.width=M,y.height=w,y.channels=T,y.format=y.internalformat=lt[T],y.needsFree=!0,Fo(y,d,A,g,h,C.offset)}else if(ji(C)||qi(C)||Lo(C))ji(C)||qi(C)?y.element=C:y.element=C.canvas,y.width=y.element.width,y.height=y.element.height,y.channels=4;else if(Oo(C))y.element=C,y.width=C.width,y.height=C.height,y.channels=4;else if(Ro(C))y.element=C,y.width=C.naturalWidth,y.height=C.naturalHeight,y.channels=4;else if(Co(C))y.element=C,y.width=C.videoWidth,y.height=C.videoHeight,y.channels=4;else if(Vi(C)){var _=y.width||C[0].length,p=y.height||C.length,R=y.channels;Zr(C[0][0])?R=R||C[0][0].length:R=R||1;for(var L=et.shape(C),k=1,X=0;X<L.length;++X)k*=L[X];var ir=Hi(y,k);et.flatten(C,L,"",ir),Wi(y,ir),y.alignment=1,y.width=_,y.height=p,y.channels=R,y.format=y.internalformat=lt[R],y.needsFree=!0}y.type===Dn?v(b.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):y.type===pn&&v(b.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function or(y,$,C){var yr=y.element,Nr=y.data,d=y.internalformat,l=y.format,x=y.type,M=y.width,w=y.height;cr(y),yr?i.texImage2D($,C,l,l,x,yr):y.compressed?i.compressedTexImage2D($,C,d,M,w,0,Nr):y.needsCopy?(P(),i.copyTexImage2D($,C,l,y.xOffset,y.yOffset,M,w,0)):i.texImage2D($,C,l,M,w,0,l,x,Nr||null)}function Fr(y,$,C,yr,Nr){var d=y.element,l=y.data,x=y.internalformat,M=y.format,w=y.type,T=y.width,A=y.height;cr(y),d?i.texSubImage2D($,Nr,C,yr,M,w,d):y.compressed?i.compressedTexSubImage2D($,Nr,C,yr,x,T,A,l):y.needsCopy?(P(),i.copyTexSubImage2D($,Nr,C,yr,y.xOffset,y.yOffset,T,A)):i.texSubImage2D($,Nr,C,yr,T,A,M,w,l)}var Lr=[];function vr(){return Lr.pop()||new J}function hr(y){y.needsFree&&ie.freeType(y.data),J.call(y),Lr.push(y)}function Mr(){q.call(this),this.genMipmaps=!1,this.mipmapHint=ct,this.mipmask=0,this.images=Array(16)}function Dr(y,$,C){var yr=y.images[0]=vr();y.mipmask=1,yr.width=y.width=$,yr.height=y.height=C,yr.channels=y.channels=4}function Br(y,$){var C=null;if(oa($))C=y.images[0]=vr(),z(C,y),lr(C,$),y.mipmask=1;else if(_r(y,$),Array.isArray($.mipmap))for(var yr=$.mipmap,Nr=0;Nr<yr.length;++Nr)C=y.images[Nr]=vr(),z(C,y),C.width>>=Nr,C.height>>=Nr,lr(C,yr[Nr]),y.mipmask|=1<<Nr;else C=y.images[0]=vr(),z(C,y),lr(C,$),y.mipmask=1;z(y,y.images[0]),y.compressed&&(y.internalformat===ra||y.internalformat===ea||y.internalformat===na||y.internalformat===ta)&&v(y.width%4===0&&y.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Jr(y,$){for(var C=y.images,yr=0;yr<C.length;++yr){if(!C[yr])return;or(C[yr],$,yr)}}var ne=[];function zr(){var y=ne.pop()||new Mr;q.call(y),y.mipmask=0;for(var $=0;$<16;++$)y.images[$]=null;return y}function ce(y){for(var $=y.images,C=0;C<$.length;++C)$[C]&&hr($[C]),$[C]=null;ne.push(y)}function Yr(){this.minFilter=sa,this.magFilter=sa,this.wrapS=fa,this.wrapT=fa,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ct}function se(y,$){if("min"in $){var C=$.min;v.parameter(C,ar),y.minFilter=ar[C],So.indexOf(y.minFilter)>=0&&!("faces"in $)&&(y.genMipmaps=!0)}if("mag"in $){var yr=$.mag;v.parameter(yr,nr),y.magFilter=nr[yr]}var Nr=y.wrapS,d=y.wrapT;if("wrap"in $){var l=$.wrap;typeof l=="string"?(v.parameter(l,Y),Nr=d=Y[l]):Array.isArray(l)&&(v.parameter(l[0],Y),v.parameter(l[1],Y),Nr=Y[l[0]],d=Y[l[1]])}else{if("wrapS"in $){var x=$.wrapS;v.parameter(x,Y),Nr=Y[x]}if("wrapT"in $){var M=$.wrapT;v.parameter(M,Y),d=Y[M]}}if(y.wrapS=Nr,y.wrapT=d,"anisotropic"in $){var w=$.anisotropic;v(typeof w=="number"&&w>=1&&w<=b.maxAnisotropic,"aniso samples must be between 1 and "),y.anisotropic=$.anisotropic}if("mipmap"in $){var T=!1;switch(typeof $.mipmap){case"string":v.parameter($.mipmap,Q,"invalid mipmap hint"),y.mipmapHint=Q[$.mipmap],y.genMipmaps=!0,T=!0;break;case"boolean":T=y.genMipmaps=$.mipmap;break;case"object":v(Array.isArray($.mipmap),"invalid mipmap type"),y.genMipmaps=!1,T=!0;break;default:v.raise("invalid mipmap type")}T&&!("min"in $)&&(y.minFilter=ca)}}function le(y,$){i.texParameteri($,po,y.minFilter),i.texParameteri($,mo,y.magFilter),i.texParameteri($,oo,y.wrapS),i.texParameteri($,uo,y.wrapT),u.ext_texture_filter_anisotropic&&i.texParameteri($,Eo,y.anisotropic),y.genMipmaps&&(i.hint(_o,y.mipmapHint),i.generateMipmap($))}var oe=0,ve={},he=b.maxTextureUnits,te=Array(he).map(function(){return null});function $r(y){q.call(this),this.mipmask=0,this.internalformat=rn,this.id=oe++,this.refCount=1,this.target=y,this.texture=i.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Yr,N.profile&&(this.stats={size:0})}function me(y){i.activeTexture(Pn),i.bindTexture(y.target,y.texture)}function jr(){var y=te[0];y?i.bindTexture(y.target,y.texture):i.bindTexture(Ce,null)}function Tr(y){var $=y.texture;v($,"must not double destroy texture");var C=y.unit,yr=y.target;C>=0&&(i.activeTexture(Pn+C),i.bindTexture(yr,null),te[C]=null),i.deleteTexture($),y.texture=null,y.params=null,y.pixels=null,y.refCount=0,delete ve[y.id],D.textureCount--}t($r.prototype,{bind:function(){var y=this;y.bindCount+=1;var $=y.unit;if($<0){for(var C=0;C<he;++C){var yr=te[C];if(yr){if(yr.bindCount>0)continue;yr.unit=-1}te[C]=y,$=C;break}$>=he&&v.raise("insufficient number of texture units"),N.profile&&D.maxTextureUnits<$+1&&(D.maxTextureUnits=$+1),y.unit=$,i.activeTexture(Pn+$),i.bindTexture(y.target,y.texture)}return $},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Tr(this)}});function kr(y,$){var C=new $r(Ce);ve[C.id]=C,D.textureCount++;function yr(l,x){var M=C.texInfo;Yr.call(M);var w=zr();return typeof l=="number"?typeof x=="number"?Dr(w,l|0,x|0):Dr(w,l|0,l|0):l?(v.type(l,"object","invalid arguments to regl.texture"),se(M,l),Br(w,l)):Dr(w,1,1),M.genMipmaps&&(w.mipmask=(w.width<<1)-1),C.mipmask=w.mipmask,z(C,w),v.texture2D(M,w,b),C.internalformat=w.internalformat,yr.width=w.width,yr.height=w.height,me(C),Jr(w,Ce),le(M,Ce),jr(),ce(w),N.profile&&(C.stats.size=ot(C.internalformat,C.type,w.width,w.height,M.genMipmaps,!1)),yr.format=rr[C.internalformat],yr.type=mr[C.type],yr.mag=W[M.magFilter],yr.min=dr[M.minFilter],yr.wrapS=ur[M.wrapS],yr.wrapT=ur[M.wrapT],yr}function Nr(l,x,M,w){v(!!l,"must specify image data");var T=x|0,A=M|0,g=w|0,h=vr();return z(h,C),h.width=0,h.height=0,lr(h,l),h.width=h.width||(C.width>>g)-T,h.height=h.height||(C.height>>g)-A,v(C.type===h.type&&C.format===h.format&&C.internalformat===h.internalformat,"incompatible format for texture.subimage"),v(T>=0&&A>=0&&T+h.width<=C.width&&A+h.height<=C.height,"texture.subimage write out of bounds"),v(C.mipmask&1<<g,"missing mipmap data"),v(h.data||h.element||h.needsCopy,"missing image data"),me(C),Fr(h,Ce,T,A,g),jr(),hr(h),yr}function d(l,x){var M=l|0,w=x|0||M;if(M===C.width&&w===C.height)return yr;yr.width=C.width=M,yr.height=C.height=w,me(C);for(var T=0;C.mipmask>>T;++T){var A=M>>T,g=w>>T;if(!A||!g)break;i.texImage2D(Ce,T,C.format,A,g,0,C.format,C.type,null)}return jr(),N.profile&&(C.stats.size=ot(C.internalformat,C.type,M,w,!1,!1)),yr}return yr(y,$),yr.subimage=Nr,yr.resize=d,yr._reglType="texture2d",yr._texture=C,N.profile&&(yr.stats=C.stats),yr.destroy=function(){C.decRef()},yr}function Ur(y,$,C,yr,Nr,d){var l=new $r(Wt);ve[l.id]=l,D.cubeCount++;var x=new Array(6);function M(A,g,h,_,p,R){var L,k=l.texInfo;for(Yr.call(k),L=0;L<6;++L)x[L]=zr();if(typeof A=="number"||!A){var X=A|0||1;for(L=0;L<6;++L)Dr(x[L],X,X)}else if(typeof A=="object")if(g)Br(x[0],A),Br(x[1],g),Br(x[2],h),Br(x[3],_),Br(x[4],p),Br(x[5],R);else if(se(k,A),_r(l,A),"faces"in A){var ir=A.faces;for(v(Array.isArray(ir)&&ir.length===6,"cube faces must be a length 6 array"),L=0;L<6;++L)v(typeof ir[L]=="object"&&!!ir[L],"invalid input for cube map face"),z(x[L],l),Br(x[L],ir[L])}else for(L=0;L<6;++L)Br(x[L],A);else v.raise("invalid arguments to cube map");for(z(l,x[0]),v.optional(function(){b.npotTextureCube||v(Ai(l.width)&&Ai(l.height),"your browser does not support non power or two texture dimensions")}),k.genMipmaps?l.mipmask=(x[0].width<<1)-1:l.mipmask=x[0].mipmask,v.textureCube(l,k,x,b),l.internalformat=x[0].internalformat,M.width=x[0].width,M.height=x[0].height,me(l),L=0;L<6;++L)Jr(x[L],at+L);for(le(k,Wt),jr(),N.profile&&(l.stats.size=ot(l.internalformat,l.type,M.width,M.height,k.genMipmaps,!0)),M.format=rr[l.internalformat],M.type=mr[l.type],M.mag=W[k.magFilter],M.min=dr[k.minFilter],M.wrapS=ur[k.wrapS],M.wrapT=ur[k.wrapT],L=0;L<6;++L)ce(x[L]);return M}function w(A,g,h,_,p){v(!!g,"must specify image data"),v(typeof A=="number"&&A===(A|0)&&A>=0&&A<6,"invalid face");var R=h|0,L=_|0,k=p|0,X=vr();return z(X,l),X.width=0,X.height=0,lr(X,g),X.width=X.width||(l.width>>k)-R,X.height=X.height||(l.height>>k)-L,v(l.type===X.type&&l.format===X.format&&l.internalformat===X.internalformat,"incompatible format for texture.subimage"),v(R>=0&&L>=0&&R+X.width<=l.width&&L+X.height<=l.height,"texture.subimage write out of bounds"),v(l.mipmask&1<<k,"missing mipmap data"),v(X.data||X.element||X.needsCopy,"missing image data"),me(l),Fr(X,at+A,R,L,k),jr(),hr(X),M}function T(A){var g=A|0;if(g!==l.width){M.width=l.width=g,M.height=l.height=g,me(l);for(var h=0;h<6;++h)for(var _=0;l.mipmask>>_;++_)i.texImage2D(at+h,_,l.format,g>>_,g>>_,0,l.format,l.type,null);return jr(),N.profile&&(l.stats.size=ot(l.internalformat,l.type,M.width,M.height,!1,!0)),M}}return M(y,$,C,yr,Nr,d),M.subimage=w,M.resize=T,M._reglType="textureCube",M._texture=l,N.profile&&(M.stats=l.stats),M.destroy=function(){l.decRef()},M}function ae(){for(var y=0;y<he;++y)i.activeTexture(Pn+y),i.bindTexture(Ce,null),te[y]=null;ge(ve).forEach(Tr),D.cubeCount=0,D.textureCount=0}N.profile&&(D.getTotalTextureSize=function(){var y=0;return Object.keys(ve).forEach(function($){y+=ve[$].stats.size}),y});function Fe(){for(var y=0;y<he;++y){var $=te[y];$&&($.bindCount=0,$.unit=-1,te[y]=null)}ge(ve).forEach(function(C){C.texture=i.createTexture(),i.bindTexture(C.target,C.texture);for(var yr=0;yr<32;++yr)if(C.mipmask&1<<yr)if(C.target===Ce)i.texImage2D(Ce,yr,C.internalformat,C.width>>yr,C.height>>yr,0,C.internalformat,C.type,null);else for(var Nr=0;Nr<6;++Nr)i.texImage2D(at+Nr,yr,C.internalformat,C.width>>yr,C.height>>yr,0,C.internalformat,C.type,null);le(C.texInfo,C.target)})}function ln(){for(var y=0;y<he;++y){var $=te[y];$&&($.bindCount=0,$.unit=-1,te[y]=null),i.activeTexture(Pn+y),i.bindTexture(Ce,null),i.bindTexture(Wt,null)}}return{create2D:kr,createCube:Ur,clear:ae,getTexture:function(y){return null},restore:Fe,refresh:ln}}var Ue=36161,ut=32854,Yi=32855,Qi=36194,Ki=33189,Zi=36168,Ji=34041,rf=35907,ef=34836,nf=34842,tf=34843,Oe=[];Oe[ut]=2,Oe[Yi]=2,Oe[Qi]=2,Oe[Ki]=2,Oe[Zi]=1,Oe[Ji]=4,Oe[rf]=4,Oe[ef]=16,Oe[nf]=8,Oe[tf]=6;function af(i,u,b){return Oe[i]*u*b}var Po=function(i,u,b,P,U){var D={rgba4:ut,rgb565:Qi,"rgb5 a1":Yi,depth:Ki,stencil:Zi,"depth stencil":Ji};u.ext_srgb&&(D.srgba=rf),u.ext_color_buffer_half_float&&(D.rgba16f=nf,D.rgb16f=tf),u.webgl_color_buffer_float&&(D.rgba32f=ef);var N=[];Object.keys(D).forEach(function(Z){var er=D[Z];N[er]=Z});var Q=0,Y={};function nr(Z){this.id=Q++,this.refCount=1,this.renderbuffer=Z,this.format=ut,this.width=0,this.height=0,U.profile&&(this.stats={size:0})}nr.prototype.decRef=function(){--this.refCount<=0&&ar(this)};function ar(Z){var er=Z.renderbuffer;v(er,"must not double destroy renderbuffer"),i.bindRenderbuffer(Ue,null),i.deleteRenderbuffer(er),Z.renderbuffer=null,Z.refCount=0,delete Y[Z.id],P.renderbufferCount--}function tr(Z,er){var S=new nr(i.createRenderbuffer());Y[S.id]=S,P.renderbufferCount++;function I(mr,W){var dr=0,ur=0,Ar=ut;if(typeof mr=="object"&&mr){var q=mr;if("shape"in q){var z=q.shape;v(Array.isArray(z)&&z.length>=2,"invalid renderbuffer shape"),dr=z[0]|0,ur=z[1]|0}else"radius"in q&&(dr=ur=q.radius|0),"width"in q&&(dr=q.width|0),"height"in q&&(ur=q.height|0);"format"in q&&(v.parameter(q.format,D,"invalid renderbuffer format"),Ar=D[q.format])}else typeof mr=="number"?(dr=mr|0,typeof W=="number"?ur=W|0:ur=dr):mr?v.raise("invalid arguments to renderbuffer constructor"):dr=ur=1;if(v(dr>0&&ur>0&&dr<=b.maxRenderbufferSize&&ur<=b.maxRenderbufferSize,"invalid renderbuffer size"),!(dr===S.width&&ur===S.height&&Ar===S.format))return I.width=S.width=dr,I.height=S.height=ur,S.format=Ar,i.bindRenderbuffer(Ue,S.renderbuffer),i.renderbufferStorage(Ue,Ar,dr,ur),v(i.getError()===0,"invalid render buffer format"),U.profile&&(S.stats.size=af(S.format,S.width,S.height)),I.format=N[S.format],I}function rr(mr,W){var dr=mr|0,ur=W|0||dr;return dr===S.width&&ur===S.height||(v(dr>0&&ur>0&&dr<=b.maxRenderbufferSize&&ur<=b.maxRenderbufferSize,"invalid renderbuffer size"),I.width=S.width=dr,I.height=S.height=ur,i.bindRenderbuffer(Ue,S.renderbuffer),i.renderbufferStorage(Ue,S.format,dr,ur),v(i.getError()===0,"invalid render buffer format"),U.profile&&(S.stats.size=af(S.format,S.width,S.height))),I}return I(Z,er),I.resize=rr,I._reglType="renderbuffer",I._renderbuffer=S,U.profile&&(I.stats=S.stats),I.destroy=function(){S.decRef()},I}U.profile&&(P.getTotalRenderbufferSize=function(){var Z=0;return Object.keys(Y).forEach(function(er){Z+=Y[er].stats.size}),Z});function sr(){ge(Y).forEach(function(Z){Z.renderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(Ue,Z.renderbuffer),i.renderbufferStorage(Ue,Z.format,Z.width,Z.height)}),i.bindRenderbuffer(Ue,null)}return{create:tr,clear:function(){ge(Y).forEach(ar)},restore:sr}},Pe=36160,ua=36161,nn=3553,vt=34069,ff=36064,sf=36096,cf=36128,lf=33306,of=36053,$o=36054,Io=36055,No=36057,Bo=36061,ko=36193,zo=5121,Uo=5126,uf=6407,vf=6408,Vo=6402,jo=[uf,vf],va=[];va[vf]=4,va[uf]=3;var dt=[];dt[zo]=1,dt[Uo]=4,dt[ko]=2;var qo=32854,Xo=32855,Ho=36194,Wo=33189,Yo=36168,df=34041,Qo=35907,Ko=34836,Zo=34842,Jo=34843,r0=[qo,Xo,Ho,Qo,Zo,Jo,Ko],xn={};xn[of]="complete",xn[$o]="incomplete attachment",xn[No]="incomplete dimensions",xn[Io]="incomplete, missing attachment",xn[Bo]="unsupported";function e0(i,u,b,P,U,D){var N={cur:null,next:null,dirty:!1,setFBO:null},Q=["rgba"],Y=["rgba4","rgb565","rgb5 a1"];u.ext_srgb&&Y.push("srgba"),u.ext_color_buffer_half_float&&Y.push("rgba16f","rgb16f"),u.webgl_color_buffer_float&&Y.push("rgba32f");var nr=["uint8"];u.oes_texture_half_float&&nr.push("half float","float16"),u.oes_texture_float&&nr.push("float","float32");function ar(J,lr,or){this.target=J,this.texture=lr,this.renderbuffer=or;var Fr=0,Lr=0;lr?(Fr=lr.width,Lr=lr.height):or&&(Fr=or.width,Lr=or.height),this.width=Fr,this.height=Lr}function tr(J){J&&(J.texture&&J.texture._texture.decRef(),J.renderbuffer&&J.renderbuffer._renderbuffer.decRef())}function sr(J,lr,or){if(J)if(J.texture){var Fr=J.texture._texture,Lr=Math.max(1,Fr.width),vr=Math.max(1,Fr.height);v(Lr===lr&&vr===or,"inconsistent width/height for supplied texture"),Fr.refCount+=1}else{var hr=J.renderbuffer._renderbuffer;v(hr.width===lr&&hr.height===or,"inconsistent width/height for renderbuffer"),hr.refCount+=1}}function Z(J,lr){lr&&(lr.texture?i.framebufferTexture2D(Pe,J,lr.target,lr.texture._texture.texture,0):i.framebufferRenderbuffer(Pe,J,ua,lr.renderbuffer._renderbuffer.renderbuffer))}function er(J){var lr=nn,or=null,Fr=null,Lr=J;typeof J=="object"&&(Lr=J.data,"target"in J&&(lr=J.target|0)),v.type(Lr,"function","invalid attachment data");var vr=Lr._reglType;return vr==="texture2d"?(or=Lr,v(lr===nn)):vr==="textureCube"?(or=Lr,v(lr>=vt&&lr<vt+6,"invalid cube map target")):vr==="renderbuffer"?(Fr=Lr,lr=ua):v.raise("invalid regl object for attachment"),new ar(lr,or,Fr)}function S(J,lr,or,Fr,Lr){if(or){var vr=P.create2D({width:J,height:lr,format:Fr,type:Lr});return vr._texture.refCount=0,new ar(nn,vr,null)}else{var hr=U.create({width:J,height:lr,format:Fr});return hr._renderbuffer.refCount=0,new ar(ua,null,hr)}}function I(J){return J&&(J.texture||J.renderbuffer)}function rr(J,lr,or){J&&(J.texture?J.texture.resize(lr,or):J.renderbuffer&&J.renderbuffer.resize(lr,or),J.width=lr,J.height=or)}var mr=0,W={};function dr(){this.id=mr++,W[this.id]=this,this.framebuffer=i.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function ur(J){J.colorAttachments.forEach(tr),tr(J.depthAttachment),tr(J.stencilAttachment),tr(J.depthStencilAttachment)}function Ar(J){var lr=J.framebuffer;v(lr,"must not double destroy framebuffer"),i.deleteFramebuffer(lr),J.framebuffer=null,D.framebufferCount--,delete W[J.id]}function q(J){var lr;i.bindFramebuffer(Pe,J.framebuffer);var or=J.colorAttachments;for(lr=0;lr<or.length;++lr)Z(ff+lr,or[lr]);for(lr=or.length;lr<b.maxColorAttachments;++lr)i.framebufferTexture2D(Pe,ff+lr,nn,null,0);i.framebufferTexture2D(Pe,lf,nn,null,0),i.framebufferTexture2D(Pe,sf,nn,null,0),i.framebufferTexture2D(Pe,cf,nn,null,0),Z(sf,J.depthAttachment),Z(cf,J.stencilAttachment),Z(lf,J.depthStencilAttachment);var Fr=i.checkFramebufferStatus(Pe);!i.isContextLost()&&Fr!==of&&v.raise("framebuffer configuration not supported, status = "+xn[Fr]),i.bindFramebuffer(Pe,N.next?N.next.framebuffer:null),N.cur=N.next,i.getError()}function z(J,lr){var or=new dr;D.framebufferCount++;function Fr(vr,hr){var Mr;v(N.next!==or,"can not update framebuffer which is currently in use");var Dr=0,Br=0,Jr=!0,ne=!0,zr=null,ce=!0,Yr="rgba",se="uint8",le=1,oe=null,ve=null,he=null,te=!1;if(typeof vr=="number")Dr=vr|0,Br=hr|0||Dr;else if(!vr)Dr=Br=1;else{v.type(vr,"object","invalid arguments for framebuffer");var $r=vr;if("shape"in $r){var me=$r.shape;v(Array.isArray(me)&&me.length>=2,"invalid shape for framebuffer"),Dr=me[0],Br=me[1]}else"radius"in $r&&(Dr=Br=$r.radius),"width"in $r&&(Dr=$r.width),"height"in $r&&(Br=$r.height);("color"in $r||"colors"in $r)&&(zr=$r.color||$r.colors,Array.isArray(zr)&&v(zr.length===1||u.webgl_draw_buffers,"multiple render targets not supported")),zr||("colorCount"in $r&&(le=$r.colorCount|0,v(le>0,"invalid color buffer count")),"colorTexture"in $r&&(ce=!!$r.colorTexture,Yr="rgba4"),"colorType"in $r&&(se=$r.colorType,ce?(v(u.oes_texture_float||!(se==="float"||se==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),v(u.oes_texture_half_float||!(se==="half float"||se==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):se==="half float"||se==="float16"?(v(u.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Yr="rgba16f"):(se==="float"||se==="float32")&&(v(u.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Yr="rgba32f"),v.oneOf(se,nr,"invalid color type")),"colorFormat"in $r&&(Yr=$r.colorFormat,Q.indexOf(Yr)>=0?ce=!0:Y.indexOf(Yr)>=0?ce=!1:v.optional(function(){ce?v.oneOf($r.colorFormat,Q,"invalid color format for texture"):v.oneOf($r.colorFormat,Y,"invalid color format for renderbuffer")}))),("depthTexture"in $r||"depthStencilTexture"in $r)&&(te=!!($r.depthTexture||$r.depthStencilTexture),v(!te||u.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in $r&&(typeof $r.depth=="boolean"?Jr=$r.depth:(oe=$r.depth,ne=!1)),"stencil"in $r&&(typeof $r.stencil=="boolean"?ne=$r.stencil:(ve=$r.stencil,Jr=!1)),"depthStencil"in $r&&(typeof $r.depthStencil=="boolean"?Jr=ne=$r.depthStencil:(he=$r.depthStencil,Jr=!1,ne=!1))}var jr=null,Tr=null,kr=null,Ur=null;if(Array.isArray(zr))jr=zr.map(er);else if(zr)jr=[er(zr)];else for(jr=new Array(le),Mr=0;Mr<le;++Mr)jr[Mr]=S(Dr,Br,ce,Yr,se);v(u.webgl_draw_buffers||jr.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),v(jr.length<=b.maxColorAttachments,"too many color attachments, not supported"),Dr=Dr||jr[0].width,Br=Br||jr[0].height,oe?Tr=er(oe):Jr&&!ne&&(Tr=S(Dr,Br,te,"depth","uint32")),ve?kr=er(ve):ne&&!Jr&&(kr=S(Dr,Br,!1,"stencil","uint8")),he?Ur=er(he):!oe&&!ve&&ne&&Jr&&(Ur=S(Dr,Br,te,"depth stencil","depth stencil")),v(!!oe+!!ve+!!he<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var ae=null;for(Mr=0;Mr<jr.length;++Mr)if(sr(jr[Mr],Dr,Br),v(!jr[Mr]||jr[Mr].texture&&jo.indexOf(jr[Mr].texture._texture.format)>=0||jr[Mr].renderbuffer&&r0.indexOf(jr[Mr].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Mr+" is invalid"),jr[Mr]&&jr[Mr].texture){var Fe=va[jr[Mr].texture._texture.format]*dt[jr[Mr].texture._texture.type];ae===null?ae=Fe:v(ae===Fe,"all color attachments much have the same number of bits per pixel.")}return sr(Tr,Dr,Br),v(!Tr||Tr.texture&&Tr.texture._texture.format===Vo||Tr.renderbuffer&&Tr.renderbuffer._renderbuffer.format===Wo,"invalid depth attachment for framebuffer object"),sr(kr,Dr,Br),v(!kr||kr.renderbuffer&&kr.renderbuffer._renderbuffer.format===Yo,"invalid stencil attachment for framebuffer object"),sr(Ur,Dr,Br),v(!Ur||Ur.texture&&Ur.texture._texture.format===df||Ur.renderbuffer&&Ur.renderbuffer._renderbuffer.format===df,"invalid depth-stencil attachment for framebuffer object"),ur(or),or.width=Dr,or.height=Br,or.colorAttachments=jr,or.depthAttachment=Tr,or.stencilAttachment=kr,or.depthStencilAttachment=Ur,Fr.color=jr.map(I),Fr.depth=I(Tr),Fr.stencil=I(kr),Fr.depthStencil=I(Ur),Fr.width=or.width,Fr.height=or.height,q(or),Fr}function Lr(vr,hr){v(N.next!==or,"can not resize a framebuffer which is currently in use");var Mr=Math.max(vr|0,1),Dr=Math.max(hr|0||Mr,1);if(Mr===or.width&&Dr===or.height)return Fr;for(var Br=or.colorAttachments,Jr=0;Jr<Br.length;++Jr)rr(Br[Jr],Mr,Dr);return rr(or.depthAttachment,Mr,Dr),rr(or.stencilAttachment,Mr,Dr),rr(or.depthStencilAttachment,Mr,Dr),or.width=Fr.width=Mr,or.height=Fr.height=Dr,q(or),Fr}return Fr(J,lr),t(Fr,{resize:Lr,_reglType:"framebuffer",_framebuffer:or,destroy:function(){Ar(or),ur(or)},use:function(vr){N.setFBO({framebuffer:Fr},vr)}})}function _r(J){var lr=Array(6);function or(Lr){var vr;v(lr.indexOf(N.next)<0,"can not update framebuffer which is currently in use");var hr={color:null},Mr=0,Dr=null,Br="rgba",Jr="uint8",ne=1;if(typeof Lr=="number")Mr=Lr|0;else if(!Lr)Mr=1;else{v.type(Lr,"object","invalid arguments for framebuffer");var zr=Lr;if("shape"in zr){var ce=zr.shape;v(Array.isArray(ce)&&ce.length>=2,"invalid shape for framebuffer"),v(ce[0]===ce[1],"cube framebuffer must be square"),Mr=ce[0]}else"radius"in zr&&(Mr=zr.radius|0),"width"in zr?(Mr=zr.width|0,"height"in zr&&v(zr.height===Mr,"must be square")):"height"in zr&&(Mr=zr.height|0);("color"in zr||"colors"in zr)&&(Dr=zr.color||zr.colors,Array.isArray(Dr)&&v(Dr.length===1||u.webgl_draw_buffers,"multiple render targets not supported")),Dr||("colorCount"in zr&&(ne=zr.colorCount|0,v(ne>0,"invalid color buffer count")),"colorType"in zr&&(v.oneOf(zr.colorType,nr,"invalid color type"),Jr=zr.colorType),"colorFormat"in zr&&(Br=zr.colorFormat,v.oneOf(zr.colorFormat,Q,"invalid color format for texture"))),"depth"in zr&&(hr.depth=zr.depth),"stencil"in zr&&(hr.stencil=zr.stencil),"depthStencil"in zr&&(hr.depthStencil=zr.depthStencil)}var Yr;if(Dr)if(Array.isArray(Dr))for(Yr=[],vr=0;vr<Dr.length;++vr)Yr[vr]=Dr[vr];else Yr=[Dr];else{Yr=Array(ne);var se={radius:Mr,format:Br,type:Jr};for(vr=0;vr<ne;++vr)Yr[vr]=P.createCube(se)}for(hr.color=Array(Yr.length),vr=0;vr<Yr.length;++vr){var le=Yr[vr];v(typeof le=="function"&&le._reglType==="textureCube","invalid cube map"),Mr=Mr||le.width,v(le.width===Mr&&le.height===Mr,"invalid cube map shape"),hr.color[vr]={target:vt,data:Yr[vr]}}for(vr=0;vr<6;++vr){for(var oe=0;oe<Yr.length;++oe)hr.color[oe].target=vt+vr;vr>0&&(hr.depth=lr[0].depth,hr.stencil=lr[0].stencil,hr.depthStencil=lr[0].depthStencil),lr[vr]?lr[vr](hr):lr[vr]=z(hr)}return t(or,{width:Mr,height:Mr,color:Yr})}function Fr(Lr){var vr,hr=Lr|0;if(v(hr>0&&hr<=b.maxCubeMapSize,"invalid radius for cube fbo"),hr===or.width)return or;var Mr=or.color;for(vr=0;vr<Mr.length;++vr)Mr[vr].resize(hr);for(vr=0;vr<6;++vr)lr[vr].resize(hr);return or.width=or.height=hr,or}return or(J),t(or,{faces:lr,resize:Fr,_reglType:"framebufferCube",destroy:function(){lr.forEach(function(Lr){Lr.destroy()})}})}function cr(){N.cur=null,N.next=null,N.dirty=!0,ge(W).forEach(function(J){J.framebuffer=i.createFramebuffer(),q(J)})}return t(N,{getFramebuffer:function(J){if(typeof J=="function"&&J._reglType==="framebuffer"){var lr=J._framebuffer;if(lr instanceof dr)return lr}return null},create:z,createCube:_r,clear:function(){ge(W).forEach(Ar)},restore:cr})}var n0=5126,hf=34962,ht=34963,mf=["attributes","elements","offset","count","primitive","instances"];function da(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=n0,this.offset=0,this.stride=0,this.divisor=0}function t0(i,u,b,P,U,D,N){for(var Q=b.maxAttributes,Y=new Array(Q),nr=0;nr<Q;++nr)Y[nr]=new da;var ar=0,tr={},sr={Record:da,scope:{},state:Y,currentVAO:null,targetVAO:null,restore:er()?ur:function(){},createVAO:Ar,getVAO:I,destroyBuffer:Z,setVAO:er()?rr:mr,clear:er()?W:function(){}};function Z(q){for(var z=0;z<Y.length;++z){var _r=Y[z];_r.buffer===q&&(i.disableVertexAttribArray(z),_r.buffer=null)}}function er(){return u.oes_vertex_array_object}function S(){return u.angle_instanced_arrays}function I(q){return typeof q=="function"&&q._vao?q._vao:null}function rr(q){if(q!==sr.currentVAO){var z=er();q?z.bindVertexArrayOES(q.vao):z.bindVertexArrayOES(null),sr.currentVAO=q}}function mr(q){if(q!==sr.currentVAO){if(q)q.bindAttrs();else{for(var z=S(),_r=0;_r<Y.length;++_r){var cr=Y[_r];cr.buffer?(i.enableVertexAttribArray(_r),cr.buffer.bind(),i.vertexAttribPointer(_r,cr.size,cr.type,cr.normalized,cr.stride,cr.offfset),z&&cr.divisor&&z.vertexAttribDivisorANGLE(_r,cr.divisor)):(i.disableVertexAttribArray(_r),i.vertexAttrib4f(_r,cr.x,cr.y,cr.z,cr.w))}N.elements?i.bindBuffer(ht,N.elements.buffer.buffer):i.bindBuffer(ht,null)}sr.currentVAO=q}}function W(){ge(tr).forEach(function(q){q.destroy()})}function dr(){this.id=++ar,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var q=er();q?this.vao=q.createVertexArrayOES():this.vao=null,tr[this.id]=this,this.buffers=[]}dr.prototype.bindAttrs=function(){for(var q=S(),z=this.attributes,_r=0;_r<z.length;++_r){var cr=z[_r];cr.buffer?(i.enableVertexAttribArray(_r),i.bindBuffer(hf,cr.buffer.buffer),i.vertexAttribPointer(_r,cr.size,cr.type,cr.normalized,cr.stride,cr.offset),q&&cr.divisor&&q.vertexAttribDivisorANGLE(_r,cr.divisor)):(i.disableVertexAttribArray(_r),i.vertexAttrib4f(_r,cr.x,cr.y,cr.z,cr.w))}for(var J=z.length;J<Q;++J)i.disableVertexAttribArray(J);var lr=D.getElements(this.elements);lr?i.bindBuffer(ht,lr.buffer.buffer):i.bindBuffer(ht,null)},dr.prototype.refresh=function(){var q=er();q&&(q.bindVertexArrayOES(this.vao),this.bindAttrs(),sr.currentVAO=null,q.bindVertexArrayOES(null))},dr.prototype.destroy=function(){if(this.vao){var q=er();this===sr.currentVAO&&(sr.currentVAO=null,q.bindVertexArrayOES(null)),q.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),tr[this.id]&&(delete tr[this.id],P.vaoCount-=1)};function ur(){var q=er();q&&ge(tr).forEach(function(z){z.refresh()})}function Ar(q){var z=new dr;P.vaoCount+=1;function _r(cr){var J;if(Array.isArray(cr))J=cr,z.elements&&z.ownsElements&&z.elements.destroy(),z.elements=null,z.ownsElements=!1,z.offset=0,z.count=0,z.instances=-1,z.primitive=4;else{if(v(typeof cr=="object","invalid arguments for create vao"),v("attributes"in cr,"must specify attributes for vao"),cr.elements){var lr=cr.elements;z.ownsElements?typeof lr=="function"&&lr._reglType==="elements"?(z.elements.destroy(),z.ownsElements=!1):(z.elements(lr),z.ownsElements=!1):D.getElements(cr.elements)?(z.elements=cr.elements,z.ownsElements=!1):(z.elements=D.create(cr.elements),z.ownsElements=!0)}else z.elements=null,z.ownsElements=!1;J=cr.attributes,z.offset=0,z.count=-1,z.instances=-1,z.primitive=4,z.elements&&(z.count=z.elements._elements.vertCount,z.primitive=z.elements._elements.primType),"offset"in cr&&(z.offset=cr.offset|0),"count"in cr&&(z.count=cr.count|0),"instances"in cr&&(z.instances=cr.instances|0),"primitive"in cr&&(v(cr.primitive in ze,"bad primitive type: "+cr.primitive),z.primitive=ze[cr.primitive]),v.optional(()=>{for(var Jr=Object.keys(cr),ne=0;ne<Jr.length;++ne)v(mf.indexOf(Jr[ne])>=0,'invalid option for vao: "'+Jr[ne]+'" valid options are '+mf)}),v(Array.isArray(J),"attributes must be an array")}v(J.length<Q,"too many attributes"),v(J.length>0,"must specify at least one attribute");var or={},Fr=z.attributes;Fr.length=J.length;for(var Lr=0;Lr<J.length;++Lr){var vr=J[Lr],hr=Fr[Lr]=new da,Mr=vr.data||vr;if(Array.isArray(Mr)||n(Mr)||Le(Mr)){var Dr;z.buffers[Lr]&&(Dr=z.buffers[Lr],n(Mr)&&Dr._buffer.byteLength>=Mr.byteLength?Dr.subdata(Mr):(Dr.destroy(),z.buffers[Lr]=null)),z.buffers[Lr]||(Dr=z.buffers[Lr]=U.create(vr,hf,!1,!0)),hr.buffer=U.getBuffer(Dr),hr.size=hr.buffer.dimension|0,hr.normalized=!1,hr.type=hr.buffer.dtype,hr.offset=0,hr.stride=0,hr.divisor=0,hr.state=1,or[Lr]=1}else U.getBuffer(vr)?(hr.buffer=U.getBuffer(vr),hr.size=hr.buffer.dimension|0,hr.normalized=!1,hr.type=hr.buffer.dtype,hr.offset=0,hr.stride=0,hr.divisor=0,hr.state=1):U.getBuffer(vr.buffer)?(hr.buffer=U.getBuffer(vr.buffer),hr.size=(+vr.size||hr.buffer.dimension)|0,hr.normalized=!!vr.normalized||!1,"type"in vr?(v.parameter(vr.type,Ze,"invalid buffer type"),hr.type=Ze[vr.type]):hr.type=hr.buffer.dtype,hr.offset=(vr.offset||0)|0,hr.stride=(vr.stride||0)|0,hr.divisor=(vr.divisor||0)|0,hr.state=1,v(hr.size>=1&&hr.size<=4,"size must be between 1 and 4"),v(hr.offset>=0,"invalid offset"),v(hr.stride>=0&&hr.stride<=255,"stride must be between 0 and 255"),v(hr.divisor>=0,"divisor must be positive"),v(!hr.divisor||!!u.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in vr?(v(Lr>0,"first attribute must not be a constant"),hr.x=+vr.x||0,hr.y=+vr.y||0,hr.z=+vr.z||0,hr.w=+vr.w||0,hr.state=2):v(!1,"invalid attribute spec for location "+Lr)}for(var Br=0;Br<z.buffers.length;++Br)!or[Br]&&z.buffers[Br]&&(z.buffers[Br].destroy(),z.buffers[Br]=null);return z.refresh(),_r}return _r.destroy=function(){for(var cr=0;cr<z.buffers.length;++cr)z.buffers[cr]&&z.buffers[cr].destroy();z.buffers.length=0,z.ownsElements&&(z.elements.destroy(),z.elements=null,z.ownsElements=!1),z.destroy()},_r._vao=z,_r._reglType="vao",_r(q)}return sr}var pf=35632,a0=35633,i0=35718,f0=35721;function s0(i,u,b,P){var U={},D={};function N(S,I,rr,mr){this.name=S,this.id=I,this.location=rr,this.info=mr}function Q(S,I){for(var rr=0;rr<S.length;++rr)if(S[rr].id===I.id){S[rr].location=I.location;return}S.push(I)}function Y(S,I,rr){var mr=S===pf?U:D,W=mr[I];if(!W){var dr=u.str(I);W=i.createShader(S),i.shaderSource(W,dr),i.compileShader(W),v.shaderError(i,W,dr,S,rr),mr[I]=W}return W}var nr={},ar=[],tr=0;function sr(S,I){this.id=tr++,this.fragId=S,this.vertId=I,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,P.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Z(S,I,rr){var mr,W,dr=Y(pf,S.fragId),ur=Y(a0,S.vertId),Ar=S.program=i.createProgram();if(i.attachShader(Ar,dr),i.attachShader(Ar,ur),rr)for(mr=0;mr<rr.length;++mr){var q=rr[mr];i.bindAttribLocation(Ar,q[0],q[1])}i.linkProgram(Ar),v.linkError(i,Ar,u.str(S.fragId),u.str(S.vertId),I);var z=i.getProgramParameter(Ar,i0);P.profile&&(S.stats.uniformsCount=z);var _r=S.uniforms;for(mr=0;mr<z;++mr)if(W=i.getActiveUniform(Ar,mr),W){if(W.size>1)for(var cr=0;cr<W.size;++cr){var J=W.name.replace("[0]","["+cr+"]");Q(_r,new N(J,u.id(J),i.getUniformLocation(Ar,J),W))}var lr=W.name;W.size>1&&(lr=lr.replace("[0]","")),Q(_r,new N(lr,u.id(lr),i.getUniformLocation(Ar,lr),W))}var or=i.getProgramParameter(Ar,f0);P.profile&&(S.stats.attributesCount=or);var Fr=S.attributes;for(mr=0;mr<or;++mr)W=i.getActiveAttrib(Ar,mr),W&&Q(Fr,new N(W.name,u.id(W.name),i.getAttribLocation(Ar,W.name),W))}P.profile&&(b.getMaxUniformsCount=function(){var S=0;return ar.forEach(function(I){I.stats.uniformsCount>S&&(S=I.stats.uniformsCount)}),S},b.getMaxAttributesCount=function(){var S=0;return ar.forEach(function(I){I.stats.attributesCount>S&&(S=I.stats.attributesCount)}),S});function er(){U={},D={};for(var S=0;S<ar.length;++S)Z(ar[S],null,ar[S].attributes.map(function(I){return[I.location,I.name]}))}return{clear:function(){var S=i.deleteShader.bind(i);ge(U).forEach(S),U={},ge(D).forEach(S),D={},ar.forEach(function(I){i.deleteProgram(I.program)}),ar.length=0,nr={},b.shaderCount=0},program:function(S,I,rr,mr){v.command(S>=0,"missing vertex shader",rr),v.command(I>=0,"missing fragment shader",rr);var W=nr[I];W||(W=nr[I]={});var dr=W[S];if(dr&&(dr.refCount++,!mr))return dr;var ur=new sr(I,S);return b.shaderCount++,Z(ur,rr,mr),dr||(W[S]=ur),ar.push(ur),t(ur,{destroy:function(){if(ur.refCount--,ur.refCount<=0){i.deleteProgram(ur.program);var Ar=ar.indexOf(ur);ar.splice(Ar,1),b.shaderCount--}W[ur.vertId].refCount<=0&&(i.deleteShader(D[ur.vertId]),delete D[ur.vertId],delete nr[ur.fragId][ur.vertId]),Object.keys(nr[ur.fragId]).length||(i.deleteShader(U[ur.fragId]),delete U[ur.fragId],delete nr[ur.fragId])}})},restore:er,shader:Y,frag:-1,vert:-1}}var c0=6408,$n=5121,l0=3333,mt=5126;function o0(i,u,b,P,U,D,N){function Q(ar){var tr;u.next===null?(v(U.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),tr=$n):(v(u.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),tr=u.next.colorAttachments[0].texture._texture.type,v.optional(function(){D.oes_texture_float?(v(tr===$n||tr===mt,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),tr===mt&&v(N.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):v(tr===$n,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var sr=0,Z=0,er=P.framebufferWidth,S=P.framebufferHeight,I=null;n(ar)?I=ar:ar&&(v.type(ar,"object","invalid arguments to regl.read()"),sr=ar.x|0,Z=ar.y|0,v(sr>=0&&sr<P.framebufferWidth,"invalid x offset for regl.read"),v(Z>=0&&Z<P.framebufferHeight,"invalid y offset for regl.read"),er=(ar.width||P.framebufferWidth-sr)|0,S=(ar.height||P.framebufferHeight-Z)|0,I=ar.data||null),I&&(tr===$n?v(I instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):tr===mt&&v(I instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),v(er>0&&er+sr<=P.framebufferWidth,"invalid width for read pixels"),v(S>0&&S+Z<=P.framebufferHeight,"invalid height for read pixels"),b();var rr=er*S*4;return I||(tr===$n?I=new Uint8Array(rr):tr===mt&&(I=I||new Float32Array(rr))),v.isTypedArray(I,"data buffer for regl.read() must be a typedarray"),v(I.byteLength>=rr,"data buffer for regl.read() too small"),i.pixelStorei(l0,4),i.readPixels(sr,Z,er,S,c0,tr,I),I}function Y(ar){var tr;return u.setFBO({framebuffer:ar.framebuffer},function(){tr=Q(ar)}),tr}function nr(ar){return!ar||!("framebuffer"in ar)?Q(ar):Y(ar)}return nr}function En(i){return Array.prototype.slice.call(i)}function An(i){return En(i).join("")}function u0(){var i=0,u=[],b=[];function P(tr){for(var sr=0;sr<b.length;++sr)if(b[sr]===tr)return u[sr];var Z="g"+i++;return u.push(Z),b.push(tr),Z}function U(){var tr=[];function sr(){tr.push.apply(tr,En(arguments))}var Z=[];function er(){var S="v"+i++;return Z.push(S),arguments.length>0&&(tr.push(S,"="),tr.push.apply(tr,En(arguments)),tr.push(";")),S}return t(sr,{def:er,toString:function(){return An([Z.length>0?"var "+Z.join(",")+";":"",An(tr)])}})}function D(){var tr=U(),sr=U(),Z=tr.toString,er=sr.toString;function S(I,rr){sr(I,rr,"=",tr.def(I,rr),";")}return t(function(){tr.apply(tr,En(arguments))},{def:tr.def,entry:tr,exit:sr,save:S,set:function(I,rr,mr){S(I,rr),tr(I,rr,"=",mr,";")},toString:function(){return Z()+er()}})}function N(){var tr=An(arguments),sr=D(),Z=D(),er=sr.toString,S=Z.toString;return t(sr,{then:function(){return sr.apply(sr,En(arguments)),this},else:function(){return Z.apply(Z,En(arguments)),this},toString:function(){var I=S();return I&&(I="else{"+I+"}"),An(["if(",tr,"){",er(),"}",I])}})}var Q=U(),Y={};function nr(tr,sr){var Z=[];function er(){var W="a"+Z.length;return Z.push(W),W}sr=sr||0;for(var S=0;S<sr;++S)er();var I=D(),rr=I.toString,mr=Y[tr]=t(I,{arg:er,toString:function(){return An(["function(",Z.join(),"){",rr(),"}"])}});return mr}function ar(){var tr=['"use strict";',Q,"return {"];Object.keys(Y).forEach(function(er){tr.push('"',er,'":',Y[er].toString(),",")}),tr.push("}");var sr=An(tr).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Z=Function.apply(null,u.concat(sr));return Z.apply(null,b)}return{global:Q,link:P,block:U,proc:nr,scope:D,cond:N,compile:ar}}var Tn="xyzw".split(""),yf=5121,gn=1,ha=2,ma=0,pa=1,ya=2,_a=3,pt=4,_f=5,bf=6,xf="dither",Ef="blend.enable",Af="blend.color",ba="blend.equation",xa="blend.func",Tf="depth.enable",gf="depth.func",Mf="depth.range",Sf="depth.mask",Ea="colorMask",wf="cull.enable",Lf="cull.face",Aa="frontFace",Ta="lineWidth",Of="polygonOffset.enable",ga="polygonOffset.offset",Rf="sample.alpha",Cf="sample.enable",Ma="sample.coverage",Gf="stencil.enable",Ff="stencil.mask",Sa="stencil.func",wa="stencil.opFront",In="stencil.opBack",Df="scissor.enable",yt="scissor.box",$e="viewport",Nn="profile",tn="framebuffer",Bn="vert",kn="frag",an="elements",fn="primitive",sn="count",_t="offset",bt="instances",zn="vao",La="Width",Oa="Height",Mn=tn+La,Sn=tn+Oa,v0=$e+La,d0=$e+Oa,Pf="drawingBuffer",$f=Pf+La,If=Pf+Oa,h0=[xa,ba,Sa,wa,In,Ma,$e,yt,ga],wn=34962,Ra=34963,m0=35632,p0=35633,Nf=3553,y0=34067,_0=2884,b0=3042,x0=3024,E0=2960,A0=2929,T0=3089,g0=32823,M0=32926,S0=32928,Ca=5126,xt=35664,Et=35665,At=35666,Ga=5124,Tt=35667,gt=35668,Mt=35669,Fa=35670,St=35671,wt=35672,Lt=35673,Un=35674,Vn=35675,jn=35676,qn=35678,Xn=35680,Da=4,Hn=1028,cn=1029,Bf=2304,Pa=2305,w0=32775,L0=32776,O0=519,Ve=7680,kf=0,zf=1,Uf=32774,R0=513,Vf=36160,C0=36064,Ge={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},jf=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Ln={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},je={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},qf={frag:m0,vert:p0},$a={cw:Bf,ccw:Pa};function Ot(i){return Array.isArray(i)||n(i)||Le(i)}function Xf(i){return i.sort(function(u,b){return u===$e?-1:b===$e?1:u<b?-1:1})}function ue(i,u,b,P){this.thisDep=i,this.contextDep=u,this.propDep=b,this.append=P}function qe(i){return i&&!(i.thisDep||i.contextDep||i.propDep)}function fe(i){return new ue(!1,!1,!1,i)}function _e(i,u){var b=i.type;if(b===ma){var P=i.data.length;return new ue(!0,P>=1,P>=2,u)}else if(b===pt){var U=i.data;return new ue(U.thisDep,U.contextDep,U.propDep,u)}else{if(b===_f)return new ue(!1,!1,!1,u);if(b===bf){for(var D=!1,N=!1,Q=!1,Y=0;Y<i.data.length;++Y){var nr=i.data[Y];if(nr.type===pa)Q=!0;else if(nr.type===ya)N=!0;else if(nr.type===_a)D=!0;else if(nr.type===ma){D=!0;var ar=nr.data;ar>=1&&(N=!0),ar>=2&&(Q=!0)}else nr.type===pt&&(D=D||nr.data.thisDep,N=N||nr.data.contextDep,Q=Q||nr.data.propDep)}return new ue(D,N,Q,u)}else return new ue(b===_a,b===ya,b===pa,u)}}var Hf=new ue(!1,!1,!1,function(){});function G0(i,u,b,P,U,D,N,Q,Y,nr,ar,tr,sr,Z,er){var S=nr.Record,I={add:32774,subtract:32778,"reverse subtract":32779};b.ext_blend_minmax&&(I.min=w0,I.max=L0);var rr=b.angle_instanced_arrays,mr=b.webgl_draw_buffers,W=b.oes_vertex_array_object,dr={dirty:!0,profile:er.profile},ur={},Ar=[],q={},z={};function _r(d){return d.replace(".","_")}function cr(d,l,x){var M=_r(d);Ar.push(d),ur[M]=dr[M]=!!x,q[M]=l}function J(d,l,x){var M=_r(d);Ar.push(d),Array.isArray(x)?(dr[M]=x.slice(),ur[M]=x.slice()):dr[M]=ur[M]=x,z[M]=l}cr(xf,x0),cr(Ef,b0),J(Af,"blendColor",[0,0,0,0]),J(ba,"blendEquationSeparate",[Uf,Uf]),J(xa,"blendFuncSeparate",[zf,kf,zf,kf]),cr(Tf,A0,!0),J(gf,"depthFunc",R0),J(Mf,"depthRange",[0,1]),J(Sf,"depthMask",!0),J(Ea,Ea,[!0,!0,!0,!0]),cr(wf,_0),J(Lf,"cullFace",cn),J(Aa,Aa,Pa),J(Ta,Ta,1),cr(Of,g0),J(ga,"polygonOffset",[0,0]),cr(Rf,M0),cr(Cf,S0),J(Ma,"sampleCoverage",[1,!1]),cr(Gf,E0),J(Ff,"stencilMask",-1),J(Sa,"stencilFunc",[O0,0,-1]),J(wa,"stencilOpSeparate",[Hn,Ve,Ve,Ve]),J(In,"stencilOpSeparate",[cn,Ve,Ve,Ve]),cr(Df,T0),J(yt,"scissor",[0,0,i.drawingBufferWidth,i.drawingBufferHeight]),J($e,$e,[0,0,i.drawingBufferWidth,i.drawingBufferHeight]);var lr={gl:i,context:sr,strings:u,next:ur,current:dr,draw:tr,elements:D,buffer:U,shader:ar,attributes:nr.state,vao:nr,uniforms:Y,framebuffer:Q,extensions:b,timer:Z,isBufferArgs:Ot},or={primTypes:ze,compareFuncs:Ln,blendFuncs:Ge,blendEquations:I,stencilOps:je,glTypes:Ze,orientationType:$a};v.optional(function(){lr.isArrayLike=Zr}),mr&&(or.backBuffer=[cn],or.drawBuffer=Te(P.maxDrawbuffers,function(d){return d===0?[0]:Te(d,function(l){return C0+l})}));var Fr=0;function Lr(){var d=u0(),l=d.link,x=d.global;d.id=Fr++,d.batchId="0";var M=l(lr),w=d.shared={props:"a0"};Object.keys(lr).forEach(function(_){w[_]=x.def(M,".",_)}),v.optional(function(){d.CHECK=l(v),d.commandStr=v.guessCommand(),d.command=l(d.commandStr),d.assert=function(_,p,R){_("if(!(",p,"))",this.CHECK,".commandRaise(",l(R),",",this.command,");")},or.invalidBlendCombinations=jf});var T=d.next={},A=d.current={};Object.keys(z).forEach(function(_){Array.isArray(dr[_])&&(T[_]=x.def(w.next,".",_),A[_]=x.def(w.current,".",_))});var g=d.constants={};Object.keys(or).forEach(function(_){g[_]=x.def(JSON.stringify(or[_]))}),d.invoke=function(_,p){switch(p.type){case ma:var R=["this",w.context,w.props,d.batchId];return _.def(l(p.data),".call(",R.slice(0,Math.max(p.data.length+1,4)),")");case pa:return _.def(w.props,p.data);case ya:return _.def(w.context,p.data);case _a:return _.def("this",p.data);case pt:return p.data.append(d,_),p.data.ref;case _f:return p.data.toString();case bf:return p.data.map(function(L){return d.invoke(_,L)})}},d.attribCache={};var h={};return d.scopeAttrib=function(_){var p=u.id(_);if(p in h)return h[p];var R=nr.scope[p];R||(R=nr.scope[p]=new S);var L=h[p]=l(R);return L},d}function vr(d){var l=d.static,x=d.dynamic,M;if(Nn in l){var w=!!l[Nn];M=fe(function(A,g){return w}),M.enable=w}else if(Nn in x){var T=x[Nn];M=_e(T,function(A,g){return A.invoke(g,T)})}return M}function hr(d,l){var x=d.static,M=d.dynamic;if(tn in x){var w=x[tn];return w?(w=Q.getFramebuffer(w),v.command(w,"invalid framebuffer object"),fe(function(A,g){var h=A.link(w),_=A.shared;g.set(_.framebuffer,".next",h);var p=_.context;return g.set(p,"."+Mn,h+".width"),g.set(p,"."+Sn,h+".height"),h})):fe(function(A,g){var h=A.shared;g.set(h.framebuffer,".next","null");var _=h.context;return g.set(_,"."+Mn,_+"."+$f),g.set(_,"."+Sn,_+"."+If),"null"})}else if(tn in M){var T=M[tn];return _e(T,function(A,g){var h=A.invoke(g,T),_=A.shared,p=_.framebuffer,R=g.def(p,".getFramebuffer(",h,")");v.optional(function(){A.assert(g,"!"+h+"||"+R,"invalid framebuffer object")}),g.set(p,".next",R);var L=_.context;return g.set(L,"."+Mn,R+"?"+R+".width:"+L+"."+$f),g.set(L,"."+Sn,R+"?"+R+".height:"+L+"."+If),R})}else return null}function Mr(d,l,x){var M=d.static,w=d.dynamic;function T(h){if(h in M){var _=M[h];v.commandType(_,"object","invalid "+h,x.commandStr);var p=!0,R=_.x|0,L=_.y|0,k,X;return"width"in _?(k=_.width|0,v.command(k>=0,"invalid "+h,x.commandStr)):p=!1,"height"in _?(X=_.height|0,v.command(X>=0,"invalid "+h,x.commandStr)):p=!1,new ue(!p&&l&&l.thisDep,!p&&l&&l.contextDep,!p&&l&&l.propDep,function(Er,pr){var H=Er.shared.context,B=k;"width"in _||(B=pr.def(H,".",Mn,"-",R));var xr=X;return"height"in _||(xr=pr.def(H,".",Sn,"-",L)),[R,L,B,xr]})}else if(h in w){var ir=w[h],wr=_e(ir,function(Er,pr){var H=Er.invoke(pr,ir);v.optional(function(){Er.assert(pr,H+"&&typeof "+H+'==="object"',"invalid "+h)});var B=Er.shared.context,xr=pr.def(H,".x|0"),br=pr.def(H,".y|0"),Sr=pr.def('"width" in ',H,"?",H,".width|0:","(",B,".",Mn,"-",xr,")"),qr=pr.def('"height" in ',H,"?",H,".height|0:","(",B,".",Sn,"-",br,")");return v.optional(function(){Er.assert(pr,Sr+">=0&&"+qr+">=0","invalid "+h)}),[xr,br,Sr,qr]});return l&&(wr.thisDep=wr.thisDep||l.thisDep,wr.contextDep=wr.contextDep||l.contextDep,wr.propDep=wr.propDep||l.propDep),wr}else return l?new ue(l.thisDep,l.contextDep,l.propDep,function(Er,pr){var H=Er.shared.context;return[0,0,pr.def(H,".",Mn),pr.def(H,".",Sn)]}):null}var A=T($e);if(A){var g=A;A=new ue(A.thisDep,A.contextDep,A.propDep,function(h,_){var p=g.append(h,_),R=h.shared.context;return _.set(R,"."+v0,p[2]),_.set(R,"."+d0,p[3]),p})}return{viewport:A,scissor_box:T(yt)}}function Dr(d,l){var x=d.static,M=typeof x[kn]=="string"&&typeof x[Bn]=="string";if(M){if(Object.keys(l.dynamic).length>0)return null;var w=l.static,T=Object.keys(w);if(T.length>0&&typeof w[T[0]]=="number"){for(var A=[],g=0;g<T.length;++g)v(typeof w[T[g]]=="number","must specify all vertex attribute locations when using vaos"),A.push([w[T[g]]|0,T[g]]);return A}}return null}function Br(d,l,x){var M=d.static,w=d.dynamic;function T(p){if(p in M){var R=u.id(M[p]);v.optional(function(){ar.shader(qf[p],R,v.guessCommand())});var L=fe(function(){return R});return L.id=R,L}else if(p in w){var k=w[p];return _e(k,function(X,ir){var wr=X.invoke(ir,k),Er=ir.def(X.shared.strings,".id(",wr,")");return v.optional(function(){ir(X.shared.shader,".shader(",qf[p],",",Er,",",X.command,");")}),Er})}return null}var A=T(kn),g=T(Bn),h=null,_;return qe(A)&&qe(g)?(h=ar.program(g.id,A.id,null,x),_=fe(function(p,R){return p.link(h)})):_=new ue(A&&A.thisDep||g&&g.thisDep,A&&A.contextDep||g&&g.contextDep,A&&A.propDep||g&&g.propDep,function(p,R){var L=p.shared.shader,k;A?k=A.append(p,R):k=R.def(L,".",kn);var X;g?X=g.append(p,R):X=R.def(L,".",Bn);var ir=L+".program("+X+","+k;return v.optional(function(){ir+=","+p.command}),R.def(ir+")")}),{frag:A,vert:g,progVar:_,program:h}}function Jr(d,l){var x=d.static,M=d.dynamic,w={},T=!1;function A(){if(zn in x){var pr=x[zn];return pr!==null&&nr.getVAO(pr)===null&&(pr=nr.createVAO(pr)),T=!0,w.vao=pr,fe(function(B){var xr=nr.getVAO(pr);return xr?B.link(xr):"null"})}else if(zn in M){T=!0;var H=M[zn];return _e(H,function(B,xr){var br=B.invoke(xr,H);return xr.def(B.shared.vao+".getVAO("+br+")")})}return null}var g=A(),h=!1;function _(){if(an in x){var pr=x[an];if(w.elements=pr,Ot(pr)){var H=w.elements=D.create(pr,!0);pr=D.getElements(H),h=!0}else pr&&(pr=D.getElements(pr),h=!0,v.command(pr,"invalid elements",l.commandStr));var B=fe(function(br,Sr){if(pr){var qr=br.link(pr);return br.ELEMENTS=qr,qr}return br.ELEMENTS=null,null});return B.value=pr,B}else if(an in M){h=!0;var xr=M[an];return _e(xr,function(br,Sr){var qr=br.shared,pe=qr.isBufferArgs,on=qr.elements,Ie=br.invoke(Sr,xr),De=Sr.def("null"),Xe=Sr.def(pe,"(",Ie,")"),un=br.cond(Xe).then(De,"=",on,".createStream(",Ie,");").else(De,"=",on,".getElements(",Ie,");");return v.optional(function(){br.assert(un.else,"!"+Ie+"||"+De,"invalid elements")}),Sr.entry(un),Sr.exit(br.cond(Xe).then(on,".destroyStream(",De,");")),br.ELEMENTS=De,De})}else if(T)return new ue(g.thisDep,g.contextDep,g.propDep,function(br,Sr){return Sr.def(br.shared.vao+".currentVAO?"+br.shared.elements+".getElements("+br.shared.vao+".currentVAO.elements):null")});return null}var p=_();function R(){if(fn in x){var pr=x[fn];return w.primitive=pr,v.commandParameter(pr,ze,"invalid primitve",l.commandStr),fe(function(B,xr){return ze[pr]})}else if(fn in M){var H=M[fn];return _e(H,function(B,xr){var br=B.constants.primTypes,Sr=B.invoke(xr,H);return v.optional(function(){B.assert(xr,Sr+" in "+br,"invalid primitive, must be one of "+Object.keys(ze))}),xr.def(br,"[",Sr,"]")})}else{if(h)return qe(p)?p.value?fe(function(B,xr){return xr.def(B.ELEMENTS,".primType")}):fe(function(){return Da}):new ue(p.thisDep,p.contextDep,p.propDep,function(B,xr){var br=B.ELEMENTS;return xr.def(br,"?",br,".primType:",Da)});if(T)return new ue(g.thisDep,g.contextDep,g.propDep,function(B,xr){return xr.def(B.shared.vao+".currentVAO?"+B.shared.vao+".currentVAO.primitive:"+Da)})}return null}function L(pr,H){if(pr in x){var B=x[pr]|0;return H?w.offset=B:w.instances=B,v.command(!H||B>=0,"invalid "+pr,l.commandStr),fe(function(br,Sr){return H&&(br.OFFSET=B),B})}else if(pr in M){var xr=M[pr];return _e(xr,function(br,Sr){var qr=br.invoke(Sr,xr);return H&&(br.OFFSET=qr,v.optional(function(){br.assert(Sr,qr+">=0","invalid "+pr)})),qr})}else if(H){if(h)return fe(function(br,Sr){return br.OFFSET=0,0});if(T)return new ue(g.thisDep,g.contextDep,g.propDep,function(br,Sr){return Sr.def(br.shared.vao+".currentVAO?"+br.shared.vao+".currentVAO.offset:0")})}else if(T)return new ue(g.thisDep,g.contextDep,g.propDep,function(br,Sr){return Sr.def(br.shared.vao+".currentVAO?"+br.shared.vao+".currentVAO.instances:-1")});return null}var k=L(_t,!0);function X(){if(sn in x){var pr=x[sn]|0;return w.count=pr,v.command(typeof pr=="number"&&pr>=0,"invalid vertex count",l.commandStr),fe(function(){return pr})}else if(sn in M){var H=M[sn];return _e(H,function(Sr,qr){var pe=Sr.invoke(qr,H);return v.optional(function(){Sr.assert(qr,"typeof "+pe+'==="number"&&'+pe+">=0&&"+pe+"===("+pe+"|0)","invalid vertex count")}),pe})}else if(h)if(qe(p)){if(p)return k?new ue(k.thisDep,k.contextDep,k.propDep,function(Sr,qr){var pe=qr.def(Sr.ELEMENTS,".vertCount-",Sr.OFFSET);return v.optional(function(){Sr.assert(qr,pe+">=0","invalid vertex offset/element buffer too small")}),pe}):fe(function(Sr,qr){return qr.def(Sr.ELEMENTS,".vertCount")});var B=fe(function(){return-1});return v.optional(function(){B.MISSING=!0}),B}else{var xr=new ue(p.thisDep||k.thisDep,p.contextDep||k.contextDep,p.propDep||k.propDep,function(Sr,qr){var pe=Sr.ELEMENTS;return Sr.OFFSET?qr.def(pe,"?",pe,".vertCount-",Sr.OFFSET,":-1"):qr.def(pe,"?",pe,".vertCount:-1")});return v.optional(function(){xr.DYNAMIC=!0}),xr}else if(T){var br=new ue(g.thisDep,g.contextDep,g.propDep,function(Sr,qr){return qr.def(Sr.shared.vao,".currentVAO?",Sr.shared.vao,".currentVAO.count:-1")});return br}return null}var ir=R(),wr=X(),Er=L(bt,!1);return{elements:p,primitive:ir,count:wr,instances:Er,offset:k,vao:g,vaoActive:T,elementsActive:h,static:w}}function ne(d,l){var x=d.static,M=d.dynamic,w={};return Ar.forEach(function(T){var A=_r(T);function g(h,_){if(T in x){var p=h(x[T]);w[A]=fe(function(){return p})}else if(T in M){var R=M[T];w[A]=_e(R,function(L,k){return _(L,k,L.invoke(k,R))})}}switch(T){case wf:case Ef:case xf:case Gf:case Tf:case Df:case Of:case Rf:case Cf:case Sf:return g(function(h){return v.commandType(h,"boolean",T,l.commandStr),h},function(h,_,p){return v.optional(function(){h.assert(_,"typeof "+p+'==="boolean"',"invalid flag "+T,h.commandStr)}),p});case gf:return g(function(h){return v.commandParameter(h,Ln,"invalid "+T,l.commandStr),Ln[h]},function(h,_,p){var R=h.constants.compareFuncs;return v.optional(function(){h.assert(_,p+" in "+R,"invalid "+T+", must be one of "+Object.keys(Ln))}),_.def(R,"[",p,"]")});case Mf:return g(function(h){return v.command(Zr(h)&&h.length===2&&typeof h[0]=="number"&&typeof h[1]=="number"&&h[0]<=h[1],"depth range is 2d array",l.commandStr),h},function(h,_,p){v.optional(function(){h.assert(_,h.shared.isArrayLike+"("+p+")&&"+p+".length===2&&typeof "+p+'[0]==="number"&&typeof '+p+'[1]==="number"&&'+p+"[0]<="+p+"[1]","depth range must be a 2d array")});var R=_.def("+",p,"[0]"),L=_.def("+",p,"[1]");return[R,L]});case xa:return g(function(h){v.commandType(h,"object","blend.func",l.commandStr);var _="srcRGB"in h?h.srcRGB:h.src,p="srcAlpha"in h?h.srcAlpha:h.src,R="dstRGB"in h?h.dstRGB:h.dst,L="dstAlpha"in h?h.dstAlpha:h.dst;return v.commandParameter(_,Ge,A+".srcRGB",l.commandStr),v.commandParameter(p,Ge,A+".srcAlpha",l.commandStr),v.commandParameter(R,Ge,A+".dstRGB",l.commandStr),v.commandParameter(L,Ge,A+".dstAlpha",l.commandStr),v.command(jf.indexOf(_+", "+R)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+_+", "+R+")",l.commandStr),[Ge[_],Ge[R],Ge[p],Ge[L]]},function(h,_,p){var R=h.constants.blendFuncs;v.optional(function(){h.assert(_,p+"&&typeof "+p+'==="object"',"invalid blend func, must be an object")});function L(H,B){var xr=_.def('"',H,B,'" in ',p,"?",p,".",H,B,":",p,".",H);return v.optional(function(){h.assert(_,xr+" in "+R,"invalid "+T+"."+H+B+", must be one of "+Object.keys(Ge))}),xr}var k=L("src","RGB"),X=L("dst","RGB");v.optional(function(){var H=h.constants.invalidBlendCombinations;h.assert(_,H+".indexOf("+k+'+", "+'+X+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ir=_.def(R,"[",k,"]"),wr=_.def(R,"[",L("src","Alpha"),"]"),Er=_.def(R,"[",X,"]"),pr=_.def(R,"[",L("dst","Alpha"),"]");return[ir,Er,wr,pr]});case ba:return g(function(h){if(typeof h=="string")return v.commandParameter(h,I,"invalid "+T,l.commandStr),[I[h],I[h]];if(typeof h=="object")return v.commandParameter(h.rgb,I,T+".rgb",l.commandStr),v.commandParameter(h.alpha,I,T+".alpha",l.commandStr),[I[h.rgb],I[h.alpha]];v.commandRaise("invalid blend.equation",l.commandStr)},function(h,_,p){var R=h.constants.blendEquations,L=_.def(),k=_.def(),X=h.cond("typeof ",p,'==="string"');return v.optional(function(){function ir(wr,Er,pr){h.assert(wr,pr+" in "+R,"invalid "+Er+", must be one of "+Object.keys(I))}ir(X.then,T,p),h.assert(X.else,p+"&&typeof "+p+'==="object"',"invalid "+T),ir(X.else,T+".rgb",p+".rgb"),ir(X.else,T+".alpha",p+".alpha")}),X.then(L,"=",k,"=",R,"[",p,"];"),X.else(L,"=",R,"[",p,".rgb];",k,"=",R,"[",p,".alpha];"),_(X),[L,k]});case Af:return g(function(h){return v.command(Zr(h)&&h.length===4,"blend.color must be a 4d array",l.commandStr),Te(4,function(_){return+h[_]})},function(h,_,p){return v.optional(function(){h.assert(_,h.shared.isArrayLike+"("+p+")&&"+p+".length===4","blend.color must be a 4d array")}),Te(4,function(R){return _.def("+",p,"[",R,"]")})});case Ff:return g(function(h){return v.commandType(h,"number",A,l.commandStr),h|0},function(h,_,p){return v.optional(function(){h.assert(_,"typeof "+p+'==="number"',"invalid stencil.mask")}),_.def(p,"|0")});case Sa:return g(function(h){v.commandType(h,"object",A,l.commandStr);var _=h.cmp||"keep",p=h.ref||0,R="mask"in h?h.mask:-1;return v.commandParameter(_,Ln,T+".cmp",l.commandStr),v.commandType(p,"number",T+".ref",l.commandStr),v.commandType(R,"number",T+".mask",l.commandStr),[Ln[_],p,R]},function(h,_,p){var R=h.constants.compareFuncs;v.optional(function(){function ir(){h.assert(_,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ir(p+"&&typeof ",p,'==="object"'),ir('!("cmp" in ',p,")||(",p,".cmp in ",R,")")});var L=_.def('"cmp" in ',p,"?",R,"[",p,".cmp]",":",Ve),k=_.def(p,".ref|0"),X=_.def('"mask" in ',p,"?",p,".mask|0:-1");return[L,k,X]});case wa:case In:return g(function(h){v.commandType(h,"object",A,l.commandStr);var _=h.fail||"keep",p=h.zfail||"keep",R=h.zpass||"keep";return v.commandParameter(_,je,T+".fail",l.commandStr),v.commandParameter(p,je,T+".zfail",l.commandStr),v.commandParameter(R,je,T+".zpass",l.commandStr),[T===In?cn:Hn,je[_],je[p],je[R]]},function(h,_,p){var R=h.constants.stencilOps;v.optional(function(){h.assert(_,p+"&&typeof "+p+'==="object"',"invalid "+T)});function L(k){return v.optional(function(){h.assert(_,'!("'+k+'" in '+p+")||("+p+"."+k+" in "+R+")","invalid "+T+"."+k+", must be one of "+Object.keys(je))}),_.def('"',k,'" in ',p,"?",R,"[",p,".",k,"]:",Ve)}return[T===In?cn:Hn,L("fail"),L("zfail"),L("zpass")]});case ga:return g(function(h){v.commandType(h,"object",A,l.commandStr);var _=h.factor|0,p=h.units|0;return v.commandType(_,"number",A+".factor",l.commandStr),v.commandType(p,"number",A+".units",l.commandStr),[_,p]},function(h,_,p){v.optional(function(){h.assert(_,p+"&&typeof "+p+'==="object"',"invalid "+T)});var R=_.def(p,".factor|0"),L=_.def(p,".units|0");return[R,L]});case Lf:return g(function(h){var _=0;return h==="front"?_=Hn:h==="back"&&(_=cn),v.command(!!_,A,l.commandStr),_},function(h,_,p){return v.optional(function(){h.assert(_,p+'==="front"||'+p+'==="back"',"invalid cull.face")}),_.def(p,'==="front"?',Hn,":",cn)});case Ta:return g(function(h){return v.command(typeof h=="number"&&h>=P.lineWidthDims[0]&&h<=P.lineWidthDims[1],"invalid line width, must be a positive number between "+P.lineWidthDims[0]+" and "+P.lineWidthDims[1],l.commandStr),h},function(h,_,p){return v.optional(function(){h.assert(_,"typeof "+p+'==="number"&&'+p+">="+P.lineWidthDims[0]+"&&"+p+"<="+P.lineWidthDims[1],"invalid line width")}),p});case Aa:return g(function(h){return v.commandParameter(h,$a,A,l.commandStr),$a[h]},function(h,_,p){return v.optional(function(){h.assert(_,p+'==="cw"||'+p+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),_.def(p+'==="cw"?'+Bf+":"+Pa)});case Ea:return g(function(h){return v.command(Zr(h)&&h.length===4,"color.mask must be length 4 array",l.commandStr),h.map(function(_){return!!_})},function(h,_,p){return v.optional(function(){h.assert(_,h.shared.isArrayLike+"("+p+")&&"+p+".length===4","invalid color.mask")}),Te(4,function(R){return"!!"+p+"["+R+"]"})});case Ma:return g(function(h){v.command(typeof h=="object"&&h,A,l.commandStr);var _="value"in h?h.value:1,p=!!h.invert;return v.command(typeof _=="number"&&_>=0&&_<=1,"sample.coverage.value must be a number between 0 and 1",l.commandStr),[_,p]},function(h,_,p){v.optional(function(){h.assert(_,p+"&&typeof "+p+'==="object"',"invalid sample.coverage")});var R=_.def('"value" in ',p,"?+",p,".value:1"),L=_.def("!!",p,".invert");return[R,L]})}}),w}function zr(d,l){var x=d.static,M=d.dynamic,w={};return Object.keys(x).forEach(function(T){var A=x[T],g;if(typeof A=="number"||typeof A=="boolean")g=fe(function(){return A});else if(typeof A=="function"){var h=A._reglType;h==="texture2d"||h==="textureCube"?g=fe(function(_){return _.link(A)}):h==="framebuffer"||h==="framebufferCube"?(v.command(A.color.length>0,'missing color attachment for framebuffer sent to uniform "'+T+'"',l.commandStr),g=fe(function(_){return _.link(A.color[0])})):v.commandRaise('invalid data for uniform "'+T+'"',l.commandStr)}else Zr(A)?g=fe(function(_){var p=_.global.def("[",Te(A.length,function(R){return v.command(typeof A[R]=="number"||typeof A[R]=="boolean","invalid uniform "+T,_.commandStr),A[R]}),"]");return p}):v.commandRaise('invalid or missing data for uniform "'+T+'"',l.commandStr);g.value=A,w[T]=g}),Object.keys(M).forEach(function(T){var A=M[T];w[T]=_e(A,function(g,h){return g.invoke(h,A)})}),w}function ce(d,l){var x=d.static,M=d.dynamic,w={};return Object.keys(x).forEach(function(T){var A=x[T],g=u.id(T),h=new S;if(Ot(A))h.state=gn,h.buffer=U.getBuffer(U.create(A,wn,!1,!0)),h.type=0;else{var _=U.getBuffer(A);if(_)h.state=gn,h.buffer=_,h.type=0;else if(v.command(typeof A=="object"&&A,"invalid data for attribute "+T,l.commandStr),"constant"in A){var p=A.constant;h.buffer="null",h.state=ha,typeof p=="number"?h.x=p:(v.command(Zr(p)&&p.length>0&&p.length<=4,"invalid constant for attribute "+T,l.commandStr),Tn.forEach(function(Er,pr){pr<p.length&&(h[Er]=p[pr])}))}else{Ot(A.buffer)?_=U.getBuffer(U.create(A.buffer,wn,!1,!0)):_=U.getBuffer(A.buffer),v.command(!!_,'missing buffer for attribute "'+T+'"',l.commandStr);var R=A.offset|0;v.command(R>=0,'invalid offset for attribute "'+T+'"',l.commandStr);var L=A.stride|0;v.command(L>=0&&L<256,'invalid stride for attribute "'+T+'", must be integer betweeen [0, 255]',l.commandStr);var k=A.size|0;v.command(!("size"in A)||k>0&&k<=4,'invalid size for attribute "'+T+'", must be 1,2,3,4',l.commandStr);var X=!!A.normalized,ir=0;"type"in A&&(v.commandParameter(A.type,Ze,"invalid type for attribute "+T,l.commandStr),ir=Ze[A.type]);var wr=A.divisor|0;v.optional(function(){"divisor"in A&&(v.command(wr===0||rr,'cannot specify divisor for attribute "'+T+'", instancing not supported',l.commandStr),v.command(wr>=0,'invalid divisor for attribute "'+T+'"',l.commandStr));var Er=l.commandStr,pr=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(A).forEach(function(H){v.command(pr.indexOf(H)>=0,'unknown parameter "'+H+'" for attribute pointer "'+T+'" (valid parameters are '+pr+")",Er)})}),h.buffer=_,h.state=gn,h.size=k,h.normalized=X,h.type=ir||_.dtype,h.offset=R,h.stride=L,h.divisor=wr}}w[T]=fe(function(Er,pr){var H=Er.attribCache;if(g in H)return H[g];var B={isStream:!1};return Object.keys(h).forEach(function(xr){B[xr]=h[xr]}),h.buffer&&(B.buffer=Er.link(h.buffer),B.type=B.type||B.buffer+".dtype"),H[g]=B,B})}),Object.keys(M).forEach(function(T){var A=M[T];function g(h,_){var p=h.invoke(_,A),R=h.shared,L=h.constants,k=R.isBufferArgs,X=R.buffer;v.optional(function(){h.assert(_,p+"&&(typeof "+p+'==="object"||typeof '+p+'==="function")&&('+k+"("+p+")||"+X+".getBuffer("+p+")||"+X+".getBuffer("+p+".buffer)||"+k+"("+p+'.buffer)||("constant" in '+p+"&&(typeof "+p+'.constant==="number"||'+R.isArrayLike+"("+p+".constant))))",'invalid dynamic attribute "'+T+'"')});var ir={isStream:_.def(!1)},wr=new S;wr.state=gn,Object.keys(wr).forEach(function(B){ir[B]=_.def(""+wr[B])});var Er=ir.buffer,pr=ir.type;_("if(",k,"(",p,")){",ir.isStream,"=true;",Er,"=",X,".createStream(",wn,",",p,");",pr,"=",Er,".dtype;","}else{",Er,"=",X,".getBuffer(",p,");","if(",Er,"){",pr,"=",Er,".dtype;",'}else if("constant" in ',p,"){",ir.state,"=",ha,";","if(typeof "+p+'.constant === "number"){',ir[Tn[0]],"=",p,".constant;",Tn.slice(1).map(function(B){return ir[B]}).join("="),"=0;","}else{",Tn.map(function(B,xr){return ir[B]+"="+p+".constant.length>"+xr+"?"+p+".constant["+xr+"]:0;"}).join(""),"}}else{","if(",k,"(",p,".buffer)){",Er,"=",X,".createStream(",wn,",",p,".buffer);","}else{",Er,"=",X,".getBuffer(",p,".buffer);","}",pr,'="type" in ',p,"?",L.glTypes,"[",p,".type]:",Er,".dtype;",ir.normalized,"=!!",p,".normalized;");function H(B){_(ir[B],"=",p,".",B,"|0;")}return H("size"),H("offset"),H("stride"),H("divisor"),_("}}"),_.exit("if(",ir.isStream,"){",X,".destroyStream(",Er,");","}"),ir}w[T]=_e(A,g)}),w}function Yr(d){var l=d.static,x=d.dynamic,M={};return Object.keys(l).forEach(function(w){var T=l[w];M[w]=fe(function(A,g){return typeof T=="number"||typeof T=="boolean"?""+T:A.link(T)})}),Object.keys(x).forEach(function(w){var T=x[w];M[w]=_e(T,function(A,g){return A.invoke(g,T)})}),M}function se(d,l,x,M,w){var T=d.static,A=d.dynamic;v.optional(function(){var H=[tn,Bn,kn,an,fn,_t,sn,bt,Nn,zn].concat(Ar);function B(xr){Object.keys(xr).forEach(function(br){v.command(H.indexOf(br)>=0,'unknown parameter "'+br+'"',w.commandStr)})}B(T),B(A)});var g=Dr(d,l),h=hr(d),_=Mr(d,h,w),p=Jr(d,w),R=ne(d,w),L=Br(d,w,g);function k(H){var B=_[H];B&&(R[H]=B)}k($e),k(_r(yt));var X=Object.keys(R).length>0,ir={framebuffer:h,draw:p,shader:L,state:R,dirty:X,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ir.profile=vr(d),ir.uniforms=zr(x,w),ir.drawVAO=ir.scopeVAO=p.vao,!ir.drawVAO&&L.program&&!g&&b.angle_instanced_arrays&&p.static.elements){var wr=!0,Er=L.program.attributes.map(function(H){var B=l.static[H];return wr=wr&&!!B,B});if(wr&&Er.length>0){var pr=nr.getVAO(nr.createVAO({attributes:Er,elements:p.static.elements}));ir.drawVAO=new ue(null,null,null,function(H,B){return H.link(pr)}),ir.useVAO=!0}}return g?ir.useVAO=!0:ir.attributes=ce(l,w),ir.context=Yr(M),ir}function le(d,l,x){var M=d.shared,w=M.context,T=d.scope();Object.keys(x).forEach(function(A){l.save(w,"."+A);var g=x[A],h=g.append(d,l);Array.isArray(h)?T(w,".",A,"=[",h.join(),"];"):T(w,".",A,"=",h,";")}),l(T)}function oe(d,l,x,M){var w=d.shared,T=w.gl,A=w.framebuffer,g;mr&&(g=l.def(w.extensions,".webgl_draw_buffers"));var h=d.constants,_=h.drawBuffer,p=h.backBuffer,R;x?R=x.append(d,l):R=l.def(A,".next"),M||l("if(",R,"!==",A,".cur){"),l("if(",R,"){",T,".bindFramebuffer(",Vf,",",R,".framebuffer);"),mr&&l(g,".drawBuffersWEBGL(",_,"[",R,".colorAttachments.length]);"),l("}else{",T,".bindFramebuffer(",Vf,",null);"),mr&&l(g,".drawBuffersWEBGL(",p,");"),l("}",A,".cur=",R,";"),M||l("}")}function ve(d,l,x){var M=d.shared,w=M.gl,T=d.current,A=d.next,g=M.current,h=M.next,_=d.cond(g,".dirty");Ar.forEach(function(p){var R=_r(p);if(!(R in x.state)){var L,k;if(R in A){L=A[R],k=T[R];var X=Te(dr[R].length,function(wr){return _.def(L,"[",wr,"]")});_(d.cond(X.map(function(wr,Er){return wr+"!=="+k+"["+Er+"]"}).join("||")).then(w,".",z[R],"(",X,");",X.map(function(wr,Er){return k+"["+Er+"]="+wr}).join(";"),";"))}else{L=_.def(h,".",R);var ir=d.cond(L,"!==",g,".",R);_(ir),R in q?ir(d.cond(L).then(w,".enable(",q[R],");").else(w,".disable(",q[R],");"),g,".",R,"=",L,";"):ir(w,".",z[R],"(",L,");",g,".",R,"=",L,";")}}}),Object.keys(x.state).length===0&&_(g,".dirty=false;"),l(_)}function he(d,l,x,M){var w=d.shared,T=d.current,A=w.current,g=w.gl;Xf(Object.keys(x)).forEach(function(h){var _=x[h];if(!(M&&!M(_))){var p=_.append(d,l);if(q[h]){var R=q[h];qe(_)?p?l(g,".enable(",R,");"):l(g,".disable(",R,");"):l(d.cond(p).then(g,".enable(",R,");").else(g,".disable(",R,");")),l(A,".",h,"=",p,";")}else if(Zr(p)){var L=T[h];l(g,".",z[h],"(",p,");",p.map(function(k,X){return L+"["+X+"]="+k}).join(";"),";")}else l(g,".",z[h],"(",p,");",A,".",h,"=",p,";")}})}function te(d,l){rr&&(d.instancing=l.def(d.shared.extensions,".angle_instanced_arrays"))}function $r(d,l,x,M,w){var T=d.shared,A=d.stats,g=T.current,h=T.timer,_=x.profile;function p(){return typeof performance>"u"?"Date.now()":"performance.now()"}var R,L;function k(H){R=l.def(),H(R,"=",p(),";"),typeof w=="string"?H(A,".count+=",w,";"):H(A,".count++;"),Z&&(M?(L=l.def(),H(L,"=",h,".getNumPendingQueries();")):H(h,".beginQuery(",A,");"))}function X(H){H(A,".cpuTime+=",p(),"-",R,";"),Z&&(M?H(h,".pushScopeStats(",L,",",h,".getNumPendingQueries(),",A,");"):H(h,".endQuery();"))}function ir(H){var B=l.def(g,".profile");l(g,".profile=",H,";"),l.exit(g,".profile=",B,";")}var wr;if(_){if(qe(_)){_.enable?(k(l),X(l.exit),ir("true")):ir("false");return}wr=_.append(d,l),ir(wr)}else wr=l.def(g,".profile");var Er=d.block();k(Er),l("if(",wr,"){",Er,"}");var pr=d.block();X(pr),l.exit("if(",wr,"){",pr,"}")}function me(d,l,x,M,w){var T=d.shared;function A(h){switch(h){case xt:case Tt:case St:return 2;case Et:case gt:case wt:return 3;case At:case Mt:case Lt:return 4;default:return 1}}function g(h,_,p){var R=T.gl,L=l.def(h,".location"),k=l.def(T.attributes,"[",L,"]"),X=p.state,ir=p.buffer,wr=[p.x,p.y,p.z,p.w],Er=["buffer","normalized","offset","stride"];function pr(){l("if(!",k,".buffer){",R,".enableVertexAttribArray(",L,");}");var B=p.type,xr;if(p.size?xr=l.def(p.size,"||",_):xr=_,l("if(",k,".type!==",B,"||",k,".size!==",xr,"||",Er.map(function(Sr){return k+"."+Sr+"!=="+p[Sr]}).join("||"),"){",R,".bindBuffer(",wn,",",ir,".buffer);",R,".vertexAttribPointer(",[L,xr,B,p.normalized,p.stride,p.offset],");",k,".type=",B,";",k,".size=",xr,";",Er.map(function(Sr){return k+"."+Sr+"="+p[Sr]+";"}).join(""),"}"),rr){var br=p.divisor;l("if(",k,".divisor!==",br,"){",d.instancing,".vertexAttribDivisorANGLE(",[L,br],");",k,".divisor=",br,";}")}}function H(){l("if(",k,".buffer){",R,".disableVertexAttribArray(",L,");",k,".buffer=null;","}if(",Tn.map(function(B,xr){return k+"."+B+"!=="+wr[xr]}).join("||"),"){",R,".vertexAttrib4f(",L,",",wr,");",Tn.map(function(B,xr){return k+"."+B+"="+wr[xr]+";"}).join(""),"}")}X===gn?pr():X===ha?H():(l("if(",X,"===",gn,"){"),pr(),l("}else{"),H(),l("}"))}M.forEach(function(h){var _=h.name,p=x.attributes[_],R;if(p){if(!w(p))return;R=p.append(d,l)}else{if(!w(Hf))return;var L=d.scopeAttrib(_);v.optional(function(){d.assert(l,L+".state","missing attribute "+_)}),R={},Object.keys(new S).forEach(function(k){R[k]=l.def(L,".",k)})}g(d.link(h),A(h.info.type),R)})}function jr(d,l,x,M,w,T){for(var A=d.shared,g=A.gl,h={},_,p=0;p<M.length;++p){var R=M[p],L=R.name,k=R.info.type,X=R.info.size,ir=x.uniforms[L];if(X>1){if(!ir)continue;var wr=L.replace("[0]","");if(h[wr])continue;h[wr]=1}var Er=d.link(R),pr=Er+".location",H;if(ir){if(!w(ir))continue;if(qe(ir)){var B=ir.value;if(v.command(B!==null&&typeof B<"u",'missing uniform "'+L+'"',d.commandStr),k===qn||k===Xn){v.command(typeof B=="function"&&(k===qn&&(B._reglType==="texture2d"||B._reglType==="framebuffer")||k===Xn&&(B._reglType==="textureCube"||B._reglType==="framebufferCube")),"invalid texture for uniform "+L,d.commandStr);var xr=d.link(B._texture||B.color[0]._texture);l(g,".uniform1i(",pr,",",xr+".bind());"),l.exit(xr,".unbind();")}else if(k===Un||k===Vn||k===jn){v.optional(function(){v.command(Zr(B),"invalid matrix for uniform "+L,d.commandStr),v.command(k===Un&&B.length===4||k===Vn&&B.length===9||k===jn&&B.length===16,"invalid length for matrix uniform "+L,d.commandStr)});var br=d.global.def("new Float32Array(["+Array.prototype.slice.call(B)+"])"),Sr=2;k===Vn?Sr=3:k===jn&&(Sr=4),l(g,".uniformMatrix",Sr,"fv(",pr,",false,",br,");")}else{switch(k){case Ca:X===1?v.commandType(B,"number","uniform "+L,d.commandStr):v.command(Zr(B)&&B.length===X,"uniform "+L,d.commandStr),_="1f";break;case xt:v.command(Zr(B)&&B.length&&B.length%2===0&&B.length<=X*2,"uniform "+L,d.commandStr),_="2f";break;case Et:v.command(Zr(B)&&B.length&&B.length%3===0&&B.length<=X*3,"uniform "+L,d.commandStr),_="3f";break;case At:v.command(Zr(B)&&B.length&&B.length%4===0&&B.length<=X*4,"uniform "+L,d.commandStr),_="4f";break;case Fa:X===1?v.commandType(B,"boolean","uniform "+L,d.commandStr):v.command(Zr(B)&&B.length===X,"uniform "+L,d.commandStr),_="1i";break;case Ga:X===1?v.commandType(B,"number","uniform "+L,d.commandStr):v.command(Zr(B)&&B.length===X,"uniform "+L,d.commandStr),_="1i";break;case St:v.command(Zr(B)&&B.length&&B.length%2===0&&B.length<=X*2,"uniform "+L,d.commandStr),_="2i";break;case Tt:v.command(Zr(B)&&B.length&&B.length%2===0&&B.length<=X*2,"uniform "+L,d.commandStr),_="2i";break;case wt:v.command(Zr(B)&&B.length&&B.length%3===0&&B.length<=X*3,"uniform "+L,d.commandStr),_="3i";break;case gt:v.command(Zr(B)&&B.length&&B.length%3===0&&B.length<=X*3,"uniform "+L,d.commandStr),_="3i";break;case Lt:v.command(Zr(B)&&B.length&&B.length%4===0&&B.length<=X*4,"uniform "+L,d.commandStr),_="4i";break;case Mt:v.command(Zr(B)&&B.length&&B.length%4===0&&B.length<=X*4,"uniform "+L,d.commandStr),_="4i";break}X>1?(_+="v",B=d.global.def("["+Array.prototype.slice.call(B)+"]")):B=Zr(B)?Array.prototype.slice.call(B):B,l(g,".uniform",_,"(",pr,",",B,");")}continue}else H=ir.append(d,l)}else{if(!w(Hf))continue;H=l.def(A.uniforms,"[",u.id(L),"]")}k===qn?(v(!Array.isArray(H),"must specify a scalar prop for textures"),l("if(",H,"&&",H,'._reglType==="framebuffer"){',H,"=",H,".color[0];","}")):k===Xn&&(v(!Array.isArray(H),"must specify a scalar prop for cube maps"),l("if(",H,"&&",H,'._reglType==="framebufferCube"){',H,"=",H,".color[0];","}")),v.optional(function(){function Me(be,Rt){d.assert(l,be,'bad data or missing for uniform "'+L+'".  '+Rt)}function vn(be,Rt){Rt===1&&v(!Array.isArray(H),"must not specify an array type for uniform"),Me("Array.isArray("+H+") && typeof "+H+'[0]===" '+be+'" || typeof '+H+'==="'+be+'"',"invalid type, expected "+be)}function we(be,Rt,Ct){Array.isArray(H)?v(H.length&&H.length%be===0&&H.length<=be*Ct,"must have length of "+(Ct===1?"":"n * ")+be):Me(A.isArrayLike+"("+H+")&&"+H+".length && "+H+".length % "+be+" === 0 && "+H+".length<="+be*Ct,"invalid vector, should have length of "+(Ct===1?"":"n * ")+be,d.commandStr)}function rs(be){v(!Array.isArray(H),"must not specify a value type"),Me("typeof "+H+'==="function"&&'+H+'._reglType==="texture'+(be===Nf?"2d":"Cube")+'"',"invalid texture type",d.commandStr)}switch(k){case Ga:vn("number",X);break;case Tt:we(2,"number",X);break;case gt:we(3,"number",X);break;case Mt:we(4,"number",X);break;case Ca:vn("number",X);break;case xt:we(2,"number",X);break;case Et:we(3,"number",X);break;case At:we(4,"number",X);break;case Fa:vn("boolean",X);break;case St:we(2,"boolean",X);break;case wt:we(3,"boolean",X);break;case Lt:we(4,"boolean",X);break;case Un:we(4,"number",X);break;case Vn:we(9,"number",X);break;case jn:we(16,"number",X);break;case qn:rs(Nf);break;case Xn:rs(y0);break}});var qr=1;switch(k){case qn:case Xn:var pe=l.def(H,"._texture");l(g,".uniform1i(",pr,",",pe,".bind());"),l.exit(pe,".unbind();");continue;case Ga:case Fa:_="1i";break;case Tt:case St:_="2i",qr=2;break;case gt:case wt:_="3i",qr=3;break;case Mt:case Lt:_="4i",qr=4;break;case Ca:_="1f";break;case xt:_="2f",qr=2;break;case Et:_="3f",qr=3;break;case At:_="4f",qr=4;break;case Un:_="Matrix2fv";break;case Vn:_="Matrix3fv";break;case jn:_="Matrix4fv";break}if(_.indexOf("Matrix")===-1&&X>1&&(_+="v",qr=1),_.charAt(0)==="M"){l(g,".uniform",_,"(",pr,",");var on=Math.pow(k-Un+2,2),Ie=d.global.def("new Float32Array(",on,")");Array.isArray(H)?l("false,(",Te(on,function(Me){return Ie+"["+Me+"]="+H[Me]}),",",Ie,")"):l("false,(Array.isArray(",H,")||",H," instanceof Float32Array)?",H,":(",Te(on,function(Me){return Ie+"["+Me+"]="+H+"["+Me+"]"}),",",Ie,")"),l(");")}else if(qr>1){for(var De=[],Xe=[],un=0;un<qr;++un)Array.isArray(H)?Xe.push(H[un]):Xe.push(l.def(H+"["+un+"]")),T&&De.push(l.def());T&&l("if(!",d.batchId,"||",De.map(function(Me,vn){return Me+"!=="+Xe[vn]}).join("||"),"){",De.map(function(Me,vn){return Me+"="+Xe[vn]+";"}).join("")),l(g,".uniform",_,"(",pr,",",Xe.join(","),");"),T&&l("}")}else{if(v(!Array.isArray(H),"uniform value must not be an array"),T){var Jf=l.def();l("if(!",d.batchId,"||",Jf,"!==",H,"){",Jf,"=",H,";")}l(g,".uniform",_,"(",pr,",",H,");"),T&&l("}")}}}function Tr(d,l,x,M){var w=d.shared,T=w.gl,A=w.draw,g=M.draw;function h(){var xr=g.elements,br,Sr=l;return xr?((xr.contextDep&&M.contextDynamic||xr.propDep)&&(Sr=x),br=xr.append(d,Sr),g.elementsActive&&Sr("if("+br+")"+T+".bindBuffer("+Ra+","+br+".buffer.buffer);")):(br=Sr.def(),Sr(br,"=",A,".",an,";","if(",br,"){",T,".bindBuffer(",Ra,",",br,".buffer.buffer);}","else if(",w.vao,".currentVAO){",br,"=",d.shared.elements+".getElements("+w.vao,".currentVAO.elements);",W?"":"if("+br+")"+T+".bindBuffer("+Ra+","+br+".buffer.buffer);","}")),br}function _(){var xr=g.count,br,Sr=l;return xr?((xr.contextDep&&M.contextDynamic||xr.propDep)&&(Sr=x),br=xr.append(d,Sr),v.optional(function(){xr.MISSING&&d.assert(l,"false","missing vertex count"),xr.DYNAMIC&&d.assert(Sr,br+">=0","missing vertex count")})):(br=Sr.def(A,".",sn),v.optional(function(){d.assert(Sr,br+">=0","missing vertex count")})),br}var p=h();function R(xr){var br=g[xr];return br?br.contextDep&&M.contextDynamic||br.propDep?br.append(d,x):br.append(d,l):l.def(A,".",xr)}var L=R(fn),k=R(_t),X=_();if(typeof X=="number"){if(X===0)return}else x("if(",X,"){"),x.exit("}");var ir,wr;rr&&(ir=R(bt),wr=d.instancing);var Er=p+".type",pr=g.elements&&qe(g.elements)&&!g.vaoActive;function H(){function xr(){x(wr,".drawElementsInstancedANGLE(",[L,X,Er,k+"<<(("+Er+"-"+yf+")>>1)",ir],");")}function br(){x(wr,".drawArraysInstancedANGLE(",[L,k,X,ir],");")}p&&p!=="null"?pr?xr():(x("if(",p,"){"),xr(),x("}else{"),br(),x("}")):br()}function B(){function xr(){x(T+".drawElements("+[L,X,Er,k+"<<(("+Er+"-"+yf+")>>1)"]+");")}function br(){x(T+".drawArrays("+[L,k,X]+");")}p&&p!=="null"?pr?xr():(x("if(",p,"){"),xr(),x("}else{"),br(),x("}")):br()}rr&&(typeof ir!="number"||ir>=0)?typeof ir=="string"?(x("if(",ir,">0){"),H(),x("}else if(",ir,"<0){"),B(),x("}")):H():B()}function kr(d,l,x,M,w){var T=Lr(),A=T.proc("body",w);return v.optional(function(){T.commandStr=l.commandStr,T.command=T.link(l.commandStr)}),rr&&(T.instancing=A.def(T.shared.extensions,".angle_instanced_arrays")),d(T,A,x,M),T.compile().body}function Ur(d,l,x,M){te(d,l),x.useVAO?x.drawVAO?l(d.shared.vao,".setVAO(",x.drawVAO.append(d,l),");"):l(d.shared.vao,".setVAO(",d.shared.vao,".targetVAO);"):(l(d.shared.vao,".setVAO(null);"),me(d,l,x,M.attributes,function(){return!0})),jr(d,l,x,M.uniforms,function(){return!0},!1),Tr(d,l,l,x)}function ae(d,l){var x=d.proc("draw",1);te(d,x),le(d,x,l.context),oe(d,x,l.framebuffer),ve(d,x,l),he(d,x,l.state),$r(d,x,l,!1,!0);var M=l.shader.progVar.append(d,x);if(x(d.shared.gl,".useProgram(",M,".program);"),l.shader.program)Ur(d,x,l,l.shader.program);else{x(d.shared.vao,".setVAO(null);");var w=d.global.def("{}"),T=x.def(M,".id"),A=x.def(w,"[",T,"]");x(d.cond(A).then(A,".call(this,a0);").else(A,"=",w,"[",T,"]=",d.link(function(g){return kr(Ur,d,l,g,1)}),"(",M,");",A,".call(this,a0);"))}Object.keys(l.state).length>0&&x(d.shared.current,".dirty=true;"),d.shared.vao&&x(d.shared.vao,".setVAO(null);")}function Fe(d,l,x,M){d.batchId="a1",te(d,l);function w(){return!0}me(d,l,x,M.attributes,w),jr(d,l,x,M.uniforms,w,!1),Tr(d,l,l,x)}function ln(d,l,x,M){te(d,l);var w=x.contextDep,T=l.def(),A="a0",g="a1",h=l.def();d.shared.props=h,d.batchId=T;var _=d.scope(),p=d.scope();l(_.entry,"for(",T,"=0;",T,"<",g,";++",T,"){",h,"=",A,"[",T,"];",p,"}",_.exit);function R(Er){return Er.contextDep&&w||Er.propDep}function L(Er){return!R(Er)}if(x.needsContext&&le(d,p,x.context),x.needsFramebuffer&&oe(d,p,x.framebuffer),he(d,p,x.state,R),x.profile&&R(x.profile)&&$r(d,p,x,!1,!0),M)x.useVAO?x.drawVAO?R(x.drawVAO)?p(d.shared.vao,".setVAO(",x.drawVAO.append(d,p),");"):_(d.shared.vao,".setVAO(",x.drawVAO.append(d,_),");"):_(d.shared.vao,".setVAO(",d.shared.vao,".targetVAO);"):(_(d.shared.vao,".setVAO(null);"),me(d,_,x,M.attributes,L),me(d,p,x,M.attributes,R)),jr(d,_,x,M.uniforms,L,!1),jr(d,p,x,M.uniforms,R,!0),Tr(d,_,p,x);else{var k=d.global.def("{}"),X=x.shader.progVar.append(d,p),ir=p.def(X,".id"),wr=p.def(k,"[",ir,"]");p(d.shared.gl,".useProgram(",X,".program);","if(!",wr,"){",wr,"=",k,"[",ir,"]=",d.link(function(Er){return kr(Fe,d,x,Er,2)}),"(",X,");}",wr,".call(this,a0[",T,"],",T,");")}}function y(d,l){var x=d.proc("batch",2);d.batchId="0",te(d,x);var M=!1,w=!0;Object.keys(l.context).forEach(function(k){M=M||l.context[k].propDep}),M||(le(d,x,l.context),w=!1);var T=l.framebuffer,A=!1;T?(T.propDep?M=A=!0:T.contextDep&&M&&(A=!0),A||oe(d,x,T)):oe(d,x,null),l.state.viewport&&l.state.viewport.propDep&&(M=!0);function g(k){return k.contextDep&&M||k.propDep}ve(d,x,l),he(d,x,l.state,function(k){return!g(k)}),(!l.profile||!g(l.profile))&&$r(d,x,l,!1,"a1"),l.contextDep=M,l.needsContext=w,l.needsFramebuffer=A;var h=l.shader.progVar;if(h.contextDep&&M||h.propDep)ln(d,x,l,null);else{var _=h.append(d,x);if(x(d.shared.gl,".useProgram(",_,".program);"),l.shader.program)ln(d,x,l,l.shader.program);else{x(d.shared.vao,".setVAO(null);");var p=d.global.def("{}"),R=x.def(_,".id"),L=x.def(p,"[",R,"]");x(d.cond(L).then(L,".call(this,a0,a1);").else(L,"=",p,"[",R,"]=",d.link(function(k){return kr(ln,d,l,k,2)}),"(",_,");",L,".call(this,a0,a1);"))}}Object.keys(l.state).length>0&&x(d.shared.current,".dirty=true;"),d.shared.vao&&x(d.shared.vao,".setVAO(null);")}function $(d,l){var x=d.proc("scope",3);d.batchId="a2";var M=d.shared,w=M.current;le(d,x,l.context),l.framebuffer&&l.framebuffer.append(d,x),Xf(Object.keys(l.state)).forEach(function(A){var g=l.state[A],h=g.append(d,x);Zr(h)?h.forEach(function(_,p){x.set(d.next[A],"["+p+"]",_)}):x.set(M.next,"."+A,h)}),$r(d,x,l,!0,!0),[an,_t,sn,bt,fn].forEach(function(A){var g=l.draw[A];g&&x.set(M.draw,"."+A,""+g.append(d,x))}),Object.keys(l.uniforms).forEach(function(A){var g=l.uniforms[A].append(d,x);Array.isArray(g)&&(g="["+g.join()+"]"),x.set(M.uniforms,"["+u.id(A)+"]",g)}),Object.keys(l.attributes).forEach(function(A){var g=l.attributes[A].append(d,x),h=d.scopeAttrib(A);Object.keys(new S).forEach(function(_){x.set(h,"."+_,g[_])})}),l.scopeVAO&&x.set(M.vao,".targetVAO",l.scopeVAO.append(d,x));function T(A){var g=l.shader[A];g&&x.set(M.shader,"."+A,g.append(d,x))}T(Bn),T(kn),Object.keys(l.state).length>0&&(x(w,".dirty=true;"),x.exit(w,".dirty=true;")),x("a1(",d.shared.context,",a0,",d.batchId,");")}function C(d){if(!(typeof d!="object"||Zr(d))){for(var l=Object.keys(d),x=0;x<l.length;++x)if(Ae.isDynamic(d[l[x]]))return!0;return!1}}function yr(d,l,x){var M=l.static[x];if(!M||!C(M))return;var w=d.global,T=Object.keys(M),A=!1,g=!1,h=!1,_=d.global.def("{}");T.forEach(function(R){var L=M[R];if(Ae.isDynamic(L)){typeof L=="function"&&(L=M[R]=Ae.unbox(L));var k=_e(L,null);A=A||k.thisDep,h=h||k.propDep,g=g||k.contextDep}else{switch(w(_,".",R,"="),typeof L){case"number":w(L);break;case"string":w('"',L,'"');break;case"object":Array.isArray(L)&&w("[",L.join(),"]");break;default:w(d.link(L));break}w(";")}});function p(R,L){T.forEach(function(k){var X=M[k];if(Ae.isDynamic(X)){var ir=R.invoke(L,X);L(_,".",k,"=",ir,";")}})}l.dynamic[x]=new Ae.DynamicVariable(pt,{thisDep:A,contextDep:g,propDep:h,ref:_,append:p}),delete l.static[x]}function Nr(d,l,x,M,w){var T=Lr();T.stats=T.link(w),Object.keys(l.static).forEach(function(g){yr(T,l,g)}),h0.forEach(function(g){yr(T,d,g)});var A=se(d,l,x,M,T);return ae(T,A),$(T,A),y(T,A),t(T.compile(),{destroy:function(){A.shader.program.destroy()}})}return{next:ur,current:dr,procs:function(){var d=Lr(),l=d.proc("poll"),x=d.proc("refresh"),M=d.block();l(M),x(M);var w=d.shared,T=w.gl,A=w.next,g=w.current;M(g,".dirty=false;"),oe(d,l),oe(d,x,null,!0);var h;rr&&(h=d.link(rr)),b.oes_vertex_array_object&&x(d.link(b.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var _=0;_<P.maxAttributes;++_){var p=x.def(w.attributes,"[",_,"]"),R=d.cond(p,".buffer");R.then(T,".enableVertexAttribArray(",_,");",T,".bindBuffer(",wn,",",p,".buffer.buffer);",T,".vertexAttribPointer(",_,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(T,".disableVertexAttribArray(",_,");",T,".vertexAttrib4f(",_,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),x(R),rr&&x(h,".vertexAttribDivisorANGLE(",_,",",p,".divisor);")}return x(d.shared.vao,".currentVAO=null;",d.shared.vao,".setVAO(",d.shared.vao,".targetVAO);"),Object.keys(q).forEach(function(L){var k=q[L],X=M.def(A,".",L),ir=d.block();ir("if(",X,"){",T,".enable(",k,")}else{",T,".disable(",k,")}",g,".",L,"=",X,";"),x(ir),l("if(",X,"!==",g,".",L,"){",ir,"}")}),Object.keys(z).forEach(function(L){var k=z[L],X=dr[L],ir,wr,Er=d.block();if(Er(T,".",k,"("),Zr(X)){var pr=X.length;ir=d.global.def(A,".",L),wr=d.global.def(g,".",L),Er(Te(pr,function(H){return ir+"["+H+"]"}),");",Te(pr,function(H){return wr+"["+H+"]="+ir+"["+H+"];"}).join("")),l("if(",Te(pr,function(H){return ir+"["+H+"]!=="+wr+"["+H+"]"}).join("||"),"){",Er,"}")}else ir=M.def(A,".",L),wr=M.def(g,".",L),Er(ir,");",g,".",L,"=",ir,";"),l("if(",ir,"!==",wr,"){",Er,"}");x(Er)}),d.compile()}(),compile:Nr}}function F0(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var D0=34918,P0=34919,Wf=35007,$0=function(i,u){if(!u.ext_disjoint_timer_query)return null;var b=[];function P(){return b.pop()||u.ext_disjoint_timer_query.createQueryEXT()}function U(rr){b.push(rr)}var D=[];function N(rr){var mr=P();u.ext_disjoint_timer_query.beginQueryEXT(Wf,mr),D.push(mr),Z(D.length-1,D.length,rr)}function Q(){u.ext_disjoint_timer_query.endQueryEXT(Wf)}function Y(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var nr=[];function ar(){return nr.pop()||new Y}function tr(rr){nr.push(rr)}var sr=[];function Z(rr,mr,W){var dr=ar();dr.startQueryIndex=rr,dr.endQueryIndex=mr,dr.sum=0,dr.stats=W,sr.push(dr)}var er=[],S=[];function I(){var rr,mr,W=D.length;if(W!==0){S.length=Math.max(S.length,W+1),er.length=Math.max(er.length,W+1),er[0]=0,S[0]=0;var dr=0;for(rr=0,mr=0;mr<D.length;++mr){var ur=D[mr];u.ext_disjoint_timer_query.getQueryObjectEXT(ur,P0)?(dr+=u.ext_disjoint_timer_query.getQueryObjectEXT(ur,D0),U(ur)):D[rr++]=ur,er[mr+1]=dr,S[mr+1]=rr}for(D.length=rr,rr=0,mr=0;mr<sr.length;++mr){var Ar=sr[mr],q=Ar.startQueryIndex,z=Ar.endQueryIndex;Ar.sum+=er[z]-er[q];var _r=S[q],cr=S[z];cr===_r?(Ar.stats.gpuTime+=Ar.sum/1e6,tr(Ar)):(Ar.startQueryIndex=_r,Ar.endQueryIndex=cr,sr[rr++]=Ar)}sr.length=rr}}return{beginQuery:N,endQuery:Q,pushScopeStats:Z,update:I,getNumPendingQueries:function(){return D.length},clear:function(){b.push.apply(b,D);for(var rr=0;rr<b.length;rr++)u.ext_disjoint_timer_query.deleteQueryEXT(b[rr]);D.length=0,b.length=0},restore:function(){D.length=0,b.length=0}}},I0=16384,N0=256,B0=1024,k0=34962,Yf="webglcontextlost",Qf="webglcontextrestored",Kf=1,z0=2,U0=3;function Zf(i,u){for(var b=0;b<i.length;++b)if(i[b]===u)return b;return-1}function V0(i){var u=kc(i);if(!u)return null;var b=u.gl,P=b.getContextAttributes(),U=b.isContextLost(),D=zc(b,u);if(!D)return null;var N=Pc(),Q=F0(),Y=D.extensions,nr=$0(b,Y),ar=ii(),tr=b.drawingBufferWidth,sr=b.drawingBufferHeight,Z={tick:0,time:0,viewportWidth:tr,viewportHeight:sr,framebufferWidth:tr,framebufferHeight:sr,drawingBufferWidth:tr,drawingBufferHeight:sr,pixelRatio:u.pixelRatio},er={},S={elements:null,primitive:4,count:-1,offset:0,instances:-1},I=Ll(b,Y),rr=jl(b,Q,u,dr),mr=no(b,Y,rr,Q),W=t0(b,Y,I,Q,rr,mr,S);function dr(Tr){return W.destroyBuffer(Tr)}var ur=s0(b,N,Q,u),Ar=Do(b,Y,I,function(){_r.procs.poll()},Z,Q,u),q=Po(b,Y,I,Q,u),z=e0(b,Y,I,Ar,q,Q),_r=G0(b,N,Y,I,rr,mr,Ar,z,er,W,ur,S,Z,nr,u),cr=o0(b,z,_r.procs.poll,Z,P,Y,I),J=_r.next,lr=b.canvas,or=[],Fr=[],Lr=[],vr=[u.onDestroy],hr=null;function Mr(){if(or.length===0){nr&&nr.update(),hr=null;return}hr=kt.next(Mr),he();for(var Tr=or.length-1;Tr>=0;--Tr){var kr=or[Tr];kr&&kr(Z,null,0)}b.flush(),nr&&nr.update()}function Dr(){!hr&&or.length>0&&(hr=kt.next(Mr))}function Br(){hr&&(kt.cancel(Mr),hr=null)}function Jr(Tr){Tr.preventDefault(),U=!0,Br(),Fr.forEach(function(kr){kr()})}function ne(Tr){b.getError(),U=!1,D.restore(),ur.restore(),rr.restore(),Ar.restore(),q.restore(),z.restore(),W.restore(),nr&&nr.restore(),_r.procs.refresh(),Dr(),Lr.forEach(function(kr){kr()})}lr&&(lr.addEventListener(Yf,Jr,!1),lr.addEventListener(Qf,ne,!1));function zr(){or.length=0,Br(),lr&&(lr.removeEventListener(Yf,Jr),lr.removeEventListener(Qf,ne)),ur.clear(),z.clear(),q.clear(),W.clear(),Ar.clear(),mr.clear(),rr.clear(),nr&&nr.clear(),vr.forEach(function(Tr){Tr()})}function ce(Tr){v(!!Tr,"invalid args to regl({...})"),v.type(Tr,"object","invalid args to regl({...})");function kr(w){var T=t({},w);delete T.uniforms,delete T.attributes,delete T.context,delete T.vao,"stencil"in T&&T.stencil.op&&(T.stencil.opBack=T.stencil.opFront=T.stencil.op,delete T.stencil.op);function A(g){if(g in T){var h=T[g];delete T[g],Object.keys(h).forEach(function(_){T[g+"."+_]=h[_]})}}return A("blend"),A("depth"),A("cull"),A("stencil"),A("polygonOffset"),A("scissor"),A("sample"),"vao"in w&&(T.vao=w.vao),T}function Ur(w,T){var A={},g={};return Object.keys(w).forEach(function(h){var _=w[h];if(Ae.isDynamic(_)){g[h]=Ae.unbox(_,h);return}else if(T&&Array.isArray(_)){for(var p=0;p<_.length;++p)if(Ae.isDynamic(_[p])){g[h]=Ae.unbox(_,h);return}}A[h]=_}),{dynamic:g,static:A}}var ae=Ur(Tr.context||{},!0),Fe=Ur(Tr.uniforms||{},!0),ln=Ur(Tr.attributes||{},!1),y=Ur(kr(Tr),!1),$={gpuTime:0,cpuTime:0,count:0},C=_r.compile(y,ln,Fe,ae,$),yr=C.draw,Nr=C.batch,d=C.scope,l=[];function x(w){for(;l.length<w;)l.push(null);return l}function M(w,T){var A;if(U&&v.raise("context lost"),typeof w=="function")return d.call(this,null,w,0);if(typeof T=="function")if(typeof w=="number")for(A=0;A<w;++A)d.call(this,null,T,A);else if(Array.isArray(w))for(A=0;A<w.length;++A)d.call(this,w[A],T,A);else return d.call(this,w,T,0);else if(typeof w=="number"){if(w>0)return Nr.call(this,x(w|0),w|0)}else if(Array.isArray(w)){if(w.length)return Nr.call(this,w,w.length)}else return yr.call(this,w)}return t(M,{stats:$,destroy:function(){C.destroy()}})}var Yr=z.setFBO=ce({framebuffer:Ae.define.call(null,Kf,"framebuffer")});function se(Tr,kr){var Ur=0;_r.procs.poll();var ae=kr.color;ae&&(b.clearColor(+ae[0]||0,+ae[1]||0,+ae[2]||0,+ae[3]||0),Ur|=I0),"depth"in kr&&(b.clearDepth(+kr.depth),Ur|=N0),"stencil"in kr&&(b.clearStencil(kr.stencil|0),Ur|=B0),v(!!Ur,"called regl.clear with no buffer specified"),b.clear(Ur)}function le(Tr){if(v(typeof Tr=="object"&&Tr,"regl.clear() takes an object as input"),"framebuffer"in Tr)if(Tr.framebuffer&&Tr.framebuffer_reglType==="framebufferCube")for(var kr=0;kr<6;++kr)Yr(t({framebuffer:Tr.framebuffer.faces[kr]},Tr),se);else Yr(Tr,se);else se(null,Tr)}function oe(Tr){v.type(Tr,"function","regl.frame() callback must be a function"),or.push(Tr);function kr(){var Ur=Zf(or,Tr);v(Ur>=0,"cannot cancel a frame twice");function ae(){var Fe=Zf(or,ae);or[Fe]=or[or.length-1],or.length-=1,or.length<=0&&Br()}or[Ur]=ae}return Dr(),{cancel:kr}}function ve(){var Tr=J.viewport,kr=J.scissor_box;Tr[0]=Tr[1]=kr[0]=kr[1]=0,Z.viewportWidth=Z.framebufferWidth=Z.drawingBufferWidth=Tr[2]=kr[2]=b.drawingBufferWidth,Z.viewportHeight=Z.framebufferHeight=Z.drawingBufferHeight=Tr[3]=kr[3]=b.drawingBufferHeight}function he(){Z.tick+=1,Z.time=$r(),ve(),_r.procs.poll()}function te(){Ar.refresh(),ve(),_r.procs.refresh(),nr&&nr.update()}function $r(){return(ii()-ar)/1e3}te();function me(Tr,kr){v.type(kr,"function","listener callback must be a function");var Ur;switch(Tr){case"frame":return oe(kr);case"lost":Ur=Fr;break;case"restore":Ur=Lr;break;case"destroy":Ur=vr;break;default:v.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ur.push(kr),{cancel:function(){for(var ae=0;ae<Ur.length;++ae)if(Ur[ae]===kr){Ur[ae]=Ur[Ur.length-1],Ur.pop();return}}}}var jr=t(ce,{clear:le,prop:Ae.define.bind(null,Kf),context:Ae.define.bind(null,z0),this:Ae.define.bind(null,U0),draw:ce({}),buffer:function(Tr){return rr.create(Tr,k0,!1,!1)},elements:function(Tr){return mr.create(Tr,!1)},texture:Ar.create2D,cube:Ar.createCube,renderbuffer:q.create,framebuffer:z.create,framebufferCube:z.createCube,vao:W.createVAO,attributes:P,frame:oe,on:me,limits:I,hasExtension:function(Tr){return I.extensions.indexOf(Tr.toLowerCase())>=0},read:cr,destroy:zr,_gl:b,_refresh:te,poll:function(){he(),nr&&nr.update()},now:$r,stats:Q});return u.onDone(null,jr),jr}return V0})})(as);var Y0=as.exports;const Q0=ts(Y0);var gr=1e-6,Vr=typeof Float32Array<"u"?Float32Array:Array,Re=Math.random;function K0(r){Vr=r}var Z0=Math.PI/180;function J0(r){return r*Z0}function ru(r,e){return Math.abs(r-e)<=gr*Math.max(1,Math.abs(r),Math.abs(e))}const eu=Object.freeze(Object.defineProperty({__proto__:null,get ARRAY_TYPE(){return Vr},EPSILON:gr,RANDOM:Re,equals:ru,setMatrixArrayType:K0,toRadian:J0},Symbol.toStringTag,{value:"Module"}));function nu(){var r=new Vr(4);return Vr!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}function tu(r){var e=new Vr(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function au(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function iu(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r}function fu(r,e,n,t){var a=new Vr(4);return a[0]=r,a[1]=e,a[2]=n,a[3]=t,a}function su(r,e,n,t,a){return r[0]=e,r[1]=n,r[2]=t,r[3]=a,r}function cu(r,e){if(r===e){var n=e[1];r[1]=e[2],r[2]=n}else r[0]=e[0],r[1]=e[2],r[2]=e[1],r[3]=e[3];return r}function lu(r,e){var n=e[0],t=e[1],a=e[2],f=e[3],s=n*f-a*t;return s?(s=1/s,r[0]=f*s,r[1]=-t*s,r[2]=-a*s,r[3]=n*s,r):null}function ou(r,e){var n=e[0];return r[0]=e[3],r[1]=-e[1],r[2]=-e[2],r[3]=n,r}function uu(r){return r[0]*r[3]-r[2]*r[1]}function is(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=n[0],o=n[1],m=n[2],E=n[3];return r[0]=t*c+f*o,r[1]=a*c+s*o,r[2]=t*m+f*E,r[3]=a*m+s*E,r}function vu(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=Math.sin(n),o=Math.cos(n);return r[0]=t*o+f*c,r[1]=a*o+s*c,r[2]=t*-c+f*o,r[3]=a*-c+s*o,r}function du(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=n[0],o=n[1];return r[0]=t*c,r[1]=a*c,r[2]=f*o,r[3]=s*o,r}function hu(r,e){var n=Math.sin(e),t=Math.cos(e);return r[0]=t,r[1]=n,r[2]=-n,r[3]=t,r}function mu(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=e[1],r}function pu(r){return"mat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}function yu(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2)+Math.pow(r[3],2))}function _u(r,e,n,t){return r[2]=t[2]/t[0],n[0]=t[0],n[1]=t[1],n[3]=t[3]-r[2]*n[1],[r,e,n]}function bu(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r}function fs(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r}function xu(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]}function Eu(r,e){var n=r[0],t=r[1],a=r[2],f=r[3],s=e[0],c=e[1],o=e[2],m=e[3];return Math.abs(n-s)<=gr*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(t-c)<=gr*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(a-o)<=gr*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(f-m)<=gr*Math.max(1,Math.abs(f),Math.abs(m))}function Au(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r}function Tu(r,e,n,t){return r[0]=e[0]+n[0]*t,r[1]=e[1]+n[1]*t,r[2]=e[2]+n[2]*t,r[3]=e[3]+n[3]*t,r}var gu=is,Mu=fs;const Su=Object.freeze(Object.defineProperty({__proto__:null,LDU:_u,add:bu,adjoint:ou,clone:tu,copy:au,create:nu,determinant:uu,equals:Eu,exactEquals:xu,frob:yu,fromRotation:hu,fromScaling:mu,fromValues:fu,identity:iu,invert:lu,mul:gu,multiply:is,multiplyScalar:Au,multiplyScalarAndAdd:Tu,rotate:vu,scale:du,set:su,str:pu,sub:Mu,subtract:fs,transpose:cu},Symbol.toStringTag,{value:"Module"}));function wu(){var r=new Vr(6);return Vr!=Float32Array&&(r[1]=0,r[2]=0,r[4]=0,r[5]=0),r[0]=1,r[3]=1,r}function Lu(r){var e=new Vr(6);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e}function Ou(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r}function Ru(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r}function Cu(r,e,n,t,a,f){var s=new Vr(6);return s[0]=r,s[1]=e,s[2]=n,s[3]=t,s[4]=a,s[5]=f,s}function Gu(r,e,n,t,a,f,s){return r[0]=e,r[1]=n,r[2]=t,r[3]=a,r[4]=f,r[5]=s,r}function Fu(r,e){var n=e[0],t=e[1],a=e[2],f=e[3],s=e[4],c=e[5],o=n*f-t*a;return o?(o=1/o,r[0]=f*o,r[1]=-t*o,r[2]=-a*o,r[3]=n*o,r[4]=(a*c-f*s)*o,r[5]=(t*s-n*c)*o,r):null}function Du(r){return r[0]*r[3]-r[1]*r[2]}function ss(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=e[4],o=e[5],m=n[0],E=n[1],O=n[2],G=n[3],F=n[4],V=n[5];return r[0]=t*m+f*E,r[1]=a*m+s*E,r[2]=t*O+f*G,r[3]=a*O+s*G,r[4]=t*F+f*V+c,r[5]=a*F+s*V+o,r}function Pu(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=e[4],o=e[5],m=Math.sin(n),E=Math.cos(n);return r[0]=t*E+f*m,r[1]=a*E+s*m,r[2]=t*-m+f*E,r[3]=a*-m+s*E,r[4]=c,r[5]=o,r}function $u(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=e[4],o=e[5],m=n[0],E=n[1];return r[0]=t*m,r[1]=a*m,r[2]=f*E,r[3]=s*E,r[4]=c,r[5]=o,r}function Iu(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=e[4],o=e[5],m=n[0],E=n[1];return r[0]=t,r[1]=a,r[2]=f,r[3]=s,r[4]=t*m+f*E+c,r[5]=a*m+s*E+o,r}function Nu(r,e){var n=Math.sin(e),t=Math.cos(e);return r[0]=t,r[1]=n,r[2]=-n,r[3]=t,r[4]=0,r[5]=0,r}function Bu(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=e[1],r[4]=0,r[5]=0,r}function ku(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=e[0],r[5]=e[1],r}function zu(r){return"mat2d("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+")"}function Uu(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2)+Math.pow(r[3],2)+Math.pow(r[4],2)+Math.pow(r[5],2)+1)}function Vu(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r[4]=e[4]+n[4],r[5]=e[5]+n[5],r}function cs(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r[4]=e[4]-n[4],r[5]=e[5]-n[5],r}function ju(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r}function qu(r,e,n,t){return r[0]=e[0]+n[0]*t,r[1]=e[1]+n[1]*t,r[2]=e[2]+n[2]*t,r[3]=e[3]+n[3]*t,r[4]=e[4]+n[4]*t,r[5]=e[5]+n[5]*t,r}function Xu(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]}function Hu(r,e){var n=r[0],t=r[1],a=r[2],f=r[3],s=r[4],c=r[5],o=e[0],m=e[1],E=e[2],O=e[3],G=e[4],F=e[5];return Math.abs(n-o)<=gr*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(t-m)<=gr*Math.max(1,Math.abs(t),Math.abs(m))&&Math.abs(a-E)<=gr*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(f-O)<=gr*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(s-G)<=gr*Math.max(1,Math.abs(s),Math.abs(G))&&Math.abs(c-F)<=gr*Math.max(1,Math.abs(c),Math.abs(F))}var Wu=ss,Yu=cs;const Qu=Object.freeze(Object.defineProperty({__proto__:null,add:Vu,clone:Lu,copy:Ou,create:wu,determinant:Du,equals:Hu,exactEquals:Xu,frob:Uu,fromRotation:Nu,fromScaling:Bu,fromTranslation:ku,fromValues:Cu,identity:Ru,invert:Fu,mul:Wu,multiply:ss,multiplyScalar:ju,multiplyScalarAndAdd:qu,rotate:Pu,scale:$u,set:Gu,str:zu,sub:Yu,subtract:cs,translate:Iu},Symbol.toStringTag,{value:"Module"}));function ls(){var r=new Vr(9);return Vr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Ku(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r}function Zu(r){var e=new Vr(9);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function Ju(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function r1(r,e,n,t,a,f,s,c,o){var m=new Vr(9);return m[0]=r,m[1]=e,m[2]=n,m[3]=t,m[4]=a,m[5]=f,m[6]=s,m[7]=c,m[8]=o,m}function e1(r,e,n,t,a,f,s,c,o,m){return r[0]=e,r[1]=n,r[2]=t,r[3]=a,r[4]=f,r[5]=s,r[6]=c,r[7]=o,r[8]=m,r}function n1(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function t1(r,e){if(r===e){var n=e[1],t=e[2],a=e[5];r[1]=e[3],r[2]=e[6],r[3]=n,r[5]=e[7],r[6]=t,r[7]=a}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r}function a1(r,e){var n=e[0],t=e[1],a=e[2],f=e[3],s=e[4],c=e[5],o=e[6],m=e[7],E=e[8],O=E*s-c*m,G=-E*f+c*o,F=m*f-s*o,V=n*O+t*G+a*F;return V?(V=1/V,r[0]=O*V,r[1]=(-E*t+a*m)*V,r[2]=(c*t-a*s)*V,r[3]=G*V,r[4]=(E*n-a*o)*V,r[5]=(-c*n+a*f)*V,r[6]=F*V,r[7]=(-m*n+t*o)*V,r[8]=(s*n-t*f)*V,r):null}function i1(r,e){var n=e[0],t=e[1],a=e[2],f=e[3],s=e[4],c=e[5],o=e[6],m=e[7],E=e[8];return r[0]=s*E-c*m,r[1]=a*m-t*E,r[2]=t*c-a*s,r[3]=c*o-f*E,r[4]=n*E-a*o,r[5]=a*f-n*c,r[6]=f*m-s*o,r[7]=t*o-n*m,r[8]=n*s-t*f,r}function f1(r){var e=r[0],n=r[1],t=r[2],a=r[3],f=r[4],s=r[5],c=r[6],o=r[7],m=r[8];return e*(m*f-s*o)+n*(-m*a+s*c)+t*(o*a-f*c)}function os(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=e[4],o=e[5],m=e[6],E=e[7],O=e[8],G=n[0],F=n[1],V=n[2],K=n[3],j=n[4],fr=n[5],Gr=n[6],Or=n[7],Cr=n[8];return r[0]=G*t+F*s+V*m,r[1]=G*a+F*c+V*E,r[2]=G*f+F*o+V*O,r[3]=K*t+j*s+fr*m,r[4]=K*a+j*c+fr*E,r[5]=K*f+j*o+fr*O,r[6]=Gr*t+Or*s+Cr*m,r[7]=Gr*a+Or*c+Cr*E,r[8]=Gr*f+Or*o+Cr*O,r}function s1(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=e[4],o=e[5],m=e[6],E=e[7],O=e[8],G=n[0],F=n[1];return r[0]=t,r[1]=a,r[2]=f,r[3]=s,r[4]=c,r[5]=o,r[6]=G*t+F*s+m,r[7]=G*a+F*c+E,r[8]=G*f+F*o+O,r}function c1(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=e[4],o=e[5],m=e[6],E=e[7],O=e[8],G=Math.sin(n),F=Math.cos(n);return r[0]=F*t+G*s,r[1]=F*a+G*c,r[2]=F*f+G*o,r[3]=F*s-G*t,r[4]=F*c-G*a,r[5]=F*o-G*f,r[6]=m,r[7]=E,r[8]=O,r}function l1(r,e,n){var t=n[0],a=n[1];return r[0]=t*e[0],r[1]=t*e[1],r[2]=t*e[2],r[3]=a*e[3],r[4]=a*e[4],r[5]=a*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function o1(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=e[0],r[7]=e[1],r[8]=1,r}function u1(r,e){var n=Math.sin(e),t=Math.cos(e);return r[0]=t,r[1]=n,r[2]=0,r[3]=-n,r[4]=t,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function v1(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=e[1],r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function d1(r,e){return r[0]=e[0],r[1]=e[1],r[2]=0,r[3]=e[2],r[4]=e[3],r[5]=0,r[6]=e[4],r[7]=e[5],r[8]=1,r}function h1(r,e){var n=e[0],t=e[1],a=e[2],f=e[3],s=n+n,c=t+t,o=a+a,m=n*s,E=t*s,O=t*c,G=a*s,F=a*c,V=a*o,K=f*s,j=f*c,fr=f*o;return r[0]=1-O-V,r[3]=E-fr,r[6]=G+j,r[1]=E+fr,r[4]=1-m-V,r[7]=F-K,r[2]=G-j,r[5]=F+K,r[8]=1-m-O,r}function m1(r,e){var n=e[0],t=e[1],a=e[2],f=e[3],s=e[4],c=e[5],o=e[6],m=e[7],E=e[8],O=e[9],G=e[10],F=e[11],V=e[12],K=e[13],j=e[14],fr=e[15],Gr=n*c-t*s,Or=n*o-a*s,Cr=n*m-f*s,Rr=t*o-a*c,Pr=t*m-f*c,Hr=a*m-f*o,Qr=E*K-O*V,Kr=E*j-G*V,Xr=E*fr-F*V,re=O*j-G*K,Wr=O*fr-F*K,ee=G*fr-F*j,Ir=Gr*ee-Or*Wr+Cr*re+Rr*Xr-Pr*Kr+Hr*Qr;return Ir?(Ir=1/Ir,r[0]=(c*ee-o*Wr+m*re)*Ir,r[1]=(o*Xr-s*ee-m*Kr)*Ir,r[2]=(s*Wr-c*Xr+m*Qr)*Ir,r[3]=(a*Wr-t*ee-f*re)*Ir,r[4]=(n*ee-a*Xr+f*Kr)*Ir,r[5]=(t*Xr-n*Wr-f*Qr)*Ir,r[6]=(K*Hr-j*Pr+fr*Rr)*Ir,r[7]=(j*Cr-V*Hr-fr*Or)*Ir,r[8]=(V*Pr-K*Cr+fr*Gr)*Ir,r):null}function p1(r,e,n){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/n,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}function y1(r){return"mat3("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+")"}function _1(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2)+Math.pow(r[3],2)+Math.pow(r[4],2)+Math.pow(r[5],2)+Math.pow(r[6],2)+Math.pow(r[7],2)+Math.pow(r[8],2))}function b1(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r[4]=e[4]+n[4],r[5]=e[5]+n[5],r[6]=e[6]+n[6],r[7]=e[7]+n[7],r[8]=e[8]+n[8],r}function us(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r[4]=e[4]-n[4],r[5]=e[5]-n[5],r[6]=e[6]-n[6],r[7]=e[7]-n[7],r[8]=e[8]-n[8],r}function x1(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[7]=e[7]*n,r[8]=e[8]*n,r}function E1(r,e,n,t){return r[0]=e[0]+n[0]*t,r[1]=e[1]+n[1]*t,r[2]=e[2]+n[2]*t,r[3]=e[3]+n[3]*t,r[4]=e[4]+n[4]*t,r[5]=e[5]+n[5]*t,r[6]=e[6]+n[6]*t,r[7]=e[7]+n[7]*t,r[8]=e[8]+n[8]*t,r}function A1(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]}function T1(r,e){var n=r[0],t=r[1],a=r[2],f=r[3],s=r[4],c=r[5],o=r[6],m=r[7],E=r[8],O=e[0],G=e[1],F=e[2],V=e[3],K=e[4],j=e[5],fr=e[6],Gr=e[7],Or=e[8];return Math.abs(n-O)<=gr*Math.max(1,Math.abs(n),Math.abs(O))&&Math.abs(t-G)<=gr*Math.max(1,Math.abs(t),Math.abs(G))&&Math.abs(a-F)<=gr*Math.max(1,Math.abs(a),Math.abs(F))&&Math.abs(f-V)<=gr*Math.max(1,Math.abs(f),Math.abs(V))&&Math.abs(s-K)<=gr*Math.max(1,Math.abs(s),Math.abs(K))&&Math.abs(c-j)<=gr*Math.max(1,Math.abs(c),Math.abs(j))&&Math.abs(o-fr)<=gr*Math.max(1,Math.abs(o),Math.abs(fr))&&Math.abs(m-Gr)<=gr*Math.max(1,Math.abs(m),Math.abs(Gr))&&Math.abs(E-Or)<=gr*Math.max(1,Math.abs(E),Math.abs(Or))}var g1=os,M1=us;const S1=Object.freeze(Object.defineProperty({__proto__:null,add:b1,adjoint:i1,clone:Zu,copy:Ju,create:ls,determinant:f1,equals:T1,exactEquals:A1,frob:_1,fromMat2d:d1,fromMat4:Ku,fromQuat:h1,fromRotation:u1,fromScaling:v1,fromTranslation:o1,fromValues:r1,identity:n1,invert:a1,mul:g1,multiply:os,multiplyScalar:x1,multiplyScalarAndAdd:E1,normalFromMat4:m1,projection:p1,rotate:c1,scale:l1,set:e1,str:y1,sub:M1,subtract:us,translate:s1,transpose:t1},Symbol.toStringTag,{value:"Module"}));function w1(){var r=new Vr(16);return Vr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function L1(r){var e=new Vr(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function O1(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function R1(r,e,n,t,a,f,s,c,o,m,E,O,G,F,V,K){var j=new Vr(16);return j[0]=r,j[1]=e,j[2]=n,j[3]=t,j[4]=a,j[5]=f,j[6]=s,j[7]=c,j[8]=o,j[9]=m,j[10]=E,j[11]=O,j[12]=G,j[13]=F,j[14]=V,j[15]=K,j}function C1(r,e,n,t,a,f,s,c,o,m,E,O,G,F,V,K,j){return r[0]=e,r[1]=n,r[2]=t,r[3]=a,r[4]=f,r[5]=s,r[6]=c,r[7]=o,r[8]=m,r[9]=E,r[10]=O,r[11]=G,r[12]=F,r[13]=V,r[14]=K,r[15]=j,r}function vs(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function G1(r,e){if(r===e){var n=e[1],t=e[2],a=e[3],f=e[6],s=e[7],c=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=n,r[6]=e[9],r[7]=e[13],r[8]=t,r[9]=f,r[11]=e[14],r[12]=a,r[13]=s,r[14]=c}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function F1(r,e){var n=e[0],t=e[1],a=e[2],f=e[3],s=e[4],c=e[5],o=e[6],m=e[7],E=e[8],O=e[9],G=e[10],F=e[11],V=e[12],K=e[13],j=e[14],fr=e[15],Gr=n*c-t*s,Or=n*o-a*s,Cr=n*m-f*s,Rr=t*o-a*c,Pr=t*m-f*c,Hr=a*m-f*o,Qr=E*K-O*V,Kr=E*j-G*V,Xr=E*fr-F*V,re=O*j-G*K,Wr=O*fr-F*K,ee=G*fr-F*j,Ir=Gr*ee-Or*Wr+Cr*re+Rr*Xr-Pr*Kr+Hr*Qr;return Ir?(Ir=1/Ir,r[0]=(c*ee-o*Wr+m*re)*Ir,r[1]=(a*Wr-t*ee-f*re)*Ir,r[2]=(K*Hr-j*Pr+fr*Rr)*Ir,r[3]=(G*Pr-O*Hr-F*Rr)*Ir,r[4]=(o*Xr-s*ee-m*Kr)*Ir,r[5]=(n*ee-a*Xr+f*Kr)*Ir,r[6]=(j*Cr-V*Hr-fr*Or)*Ir,r[7]=(E*Hr-G*Cr+F*Or)*Ir,r[8]=(s*Wr-c*Xr+m*Qr)*Ir,r[9]=(t*Xr-n*Wr-f*Qr)*Ir,r[10]=(V*Pr-K*Cr+fr*Gr)*Ir,r[11]=(O*Cr-E*Pr-F*Gr)*Ir,r[12]=(c*Kr-s*re-o*Qr)*Ir,r[13]=(n*re-t*Kr+a*Qr)*Ir,r[14]=(K*Or-V*Rr-j*Gr)*Ir,r[15]=(E*Rr-O*Or+G*Gr)*Ir,r):null}function D1(r,e){var n=e[0],t=e[1],a=e[2],f=e[3],s=e[4],c=e[5],o=e[6],m=e[7],E=e[8],O=e[9],G=e[10],F=e[11],V=e[12],K=e[13],j=e[14],fr=e[15];return r[0]=c*(G*fr-F*j)-O*(o*fr-m*j)+K*(o*F-m*G),r[1]=-(t*(G*fr-F*j)-O*(a*fr-f*j)+K*(a*F-f*G)),r[2]=t*(o*fr-m*j)-c*(a*fr-f*j)+K*(a*m-f*o),r[3]=-(t*(o*F-m*G)-c*(a*F-f*G)+O*(a*m-f*o)),r[4]=-(s*(G*fr-F*j)-E*(o*fr-m*j)+V*(o*F-m*G)),r[5]=n*(G*fr-F*j)-E*(a*fr-f*j)+V*(a*F-f*G),r[6]=-(n*(o*fr-m*j)-s*(a*fr-f*j)+V*(a*m-f*o)),r[7]=n*(o*F-m*G)-s*(a*F-f*G)+E*(a*m-f*o),r[8]=s*(O*fr-F*K)-E*(c*fr-m*K)+V*(c*F-m*O),r[9]=-(n*(O*fr-F*K)-E*(t*fr-f*K)+V*(t*F-f*O)),r[10]=n*(c*fr-m*K)-s*(t*fr-f*K)+V*(t*m-f*c),r[11]=-(n*(c*F-m*O)-s*(t*F-f*O)+E*(t*m-f*c)),r[12]=-(s*(O*j-G*K)-E*(c*j-o*K)+V*(c*G-o*O)),r[13]=n*(O*j-G*K)-E*(t*j-a*K)+V*(t*G-a*O),r[14]=-(n*(c*j-o*K)-s*(t*j-a*K)+V*(t*o-a*c)),r[15]=n*(c*G-o*O)-s*(t*G-a*O)+E*(t*o-a*c),r}function P1(r){var e=r[0],n=r[1],t=r[2],a=r[3],f=r[4],s=r[5],c=r[6],o=r[7],m=r[8],E=r[9],O=r[10],G=r[11],F=r[12],V=r[13],K=r[14],j=r[15],fr=e*s-n*f,Gr=e*c-t*f,Or=e*o-a*f,Cr=n*c-t*s,Rr=n*o-a*s,Pr=t*o-a*c,Hr=m*V-E*F,Qr=m*K-O*F,Kr=m*j-G*F,Xr=E*K-O*V,re=E*j-G*V,Wr=O*j-G*K;return fr*Wr-Gr*re+Or*Xr+Cr*Kr-Rr*Qr+Pr*Hr}function ds(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=e[4],o=e[5],m=e[6],E=e[7],O=e[8],G=e[9],F=e[10],V=e[11],K=e[12],j=e[13],fr=e[14],Gr=e[15],Or=n[0],Cr=n[1],Rr=n[2],Pr=n[3];return r[0]=Or*t+Cr*c+Rr*O+Pr*K,r[1]=Or*a+Cr*o+Rr*G+Pr*j,r[2]=Or*f+Cr*m+Rr*F+Pr*fr,r[3]=Or*s+Cr*E+Rr*V+Pr*Gr,Or=n[4],Cr=n[5],Rr=n[6],Pr=n[7],r[4]=Or*t+Cr*c+Rr*O+Pr*K,r[5]=Or*a+Cr*o+Rr*G+Pr*j,r[6]=Or*f+Cr*m+Rr*F+Pr*fr,r[7]=Or*s+Cr*E+Rr*V+Pr*Gr,Or=n[8],Cr=n[9],Rr=n[10],Pr=n[11],r[8]=Or*t+Cr*c+Rr*O+Pr*K,r[9]=Or*a+Cr*o+Rr*G+Pr*j,r[10]=Or*f+Cr*m+Rr*F+Pr*fr,r[11]=Or*s+Cr*E+Rr*V+Pr*Gr,Or=n[12],Cr=n[13],Rr=n[14],Pr=n[15],r[12]=Or*t+Cr*c+Rr*O+Pr*K,r[13]=Or*a+Cr*o+Rr*G+Pr*j,r[14]=Or*f+Cr*m+Rr*F+Pr*fr,r[15]=Or*s+Cr*E+Rr*V+Pr*Gr,r}function $1(r,e,n){var t=n[0],a=n[1],f=n[2],s=void 0,c=void 0,o=void 0,m=void 0,E=void 0,O=void 0,G=void 0,F=void 0,V=void 0,K=void 0,j=void 0,fr=void 0;return e===r?(r[12]=e[0]*t+e[4]*a+e[8]*f+e[12],r[13]=e[1]*t+e[5]*a+e[9]*f+e[13],r[14]=e[2]*t+e[6]*a+e[10]*f+e[14],r[15]=e[3]*t+e[7]*a+e[11]*f+e[15]):(s=e[0],c=e[1],o=e[2],m=e[3],E=e[4],O=e[5],G=e[6],F=e[7],V=e[8],K=e[9],j=e[10],fr=e[11],r[0]=s,r[1]=c,r[2]=o,r[3]=m,r[4]=E,r[5]=O,r[6]=G,r[7]=F,r[8]=V,r[9]=K,r[10]=j,r[11]=fr,r[12]=s*t+E*a+V*f+e[12],r[13]=c*t+O*a+K*f+e[13],r[14]=o*t+G*a+j*f+e[14],r[15]=m*t+F*a+fr*f+e[15]),r}function I1(r,e,n){var t=n[0],a=n[1],f=n[2];return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*a,r[5]=e[5]*a,r[6]=e[6]*a,r[7]=e[7]*a,r[8]=e[8]*f,r[9]=e[9]*f,r[10]=e[10]*f,r[11]=e[11]*f,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function N1(r,e,n,t){var a=t[0],f=t[1],s=t[2],c=Math.sqrt(a*a+f*f+s*s),o=void 0,m=void 0,E=void 0,O=void 0,G=void 0,F=void 0,V=void 0,K=void 0,j=void 0,fr=void 0,Gr=void 0,Or=void 0,Cr=void 0,Rr=void 0,Pr=void 0,Hr=void 0,Qr=void 0,Kr=void 0,Xr=void 0,re=void 0,Wr=void 0,ee=void 0,Ir=void 0,xe=void 0;return c<gr?null:(c=1/c,a*=c,f*=c,s*=c,o=Math.sin(n),m=Math.cos(n),E=1-m,O=e[0],G=e[1],F=e[2],V=e[3],K=e[4],j=e[5],fr=e[6],Gr=e[7],Or=e[8],Cr=e[9],Rr=e[10],Pr=e[11],Hr=a*a*E+m,Qr=f*a*E+s*o,Kr=s*a*E-f*o,Xr=a*f*E-s*o,re=f*f*E+m,Wr=s*f*E+a*o,ee=a*s*E+f*o,Ir=f*s*E-a*o,xe=s*s*E+m,r[0]=O*Hr+K*Qr+Or*Kr,r[1]=G*Hr+j*Qr+Cr*Kr,r[2]=F*Hr+fr*Qr+Rr*Kr,r[3]=V*Hr+Gr*Qr+Pr*Kr,r[4]=O*Xr+K*re+Or*Wr,r[5]=G*Xr+j*re+Cr*Wr,r[6]=F*Xr+fr*re+Rr*Wr,r[7]=V*Xr+Gr*re+Pr*Wr,r[8]=O*ee+K*Ir+Or*xe,r[9]=G*ee+j*Ir+Cr*xe,r[10]=F*ee+fr*Ir+Rr*xe,r[11]=V*ee+Gr*Ir+Pr*xe,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function B1(r,e,n){var t=Math.sin(n),a=Math.cos(n),f=e[4],s=e[5],c=e[6],o=e[7],m=e[8],E=e[9],O=e[10],G=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=f*a+m*t,r[5]=s*a+E*t,r[6]=c*a+O*t,r[7]=o*a+G*t,r[8]=m*a-f*t,r[9]=E*a-s*t,r[10]=O*a-c*t,r[11]=G*a-o*t,r}function k1(r,e,n){var t=Math.sin(n),a=Math.cos(n),f=e[0],s=e[1],c=e[2],o=e[3],m=e[8],E=e[9],O=e[10],G=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=f*a-m*t,r[1]=s*a-E*t,r[2]=c*a-O*t,r[3]=o*a-G*t,r[8]=f*t+m*a,r[9]=s*t+E*a,r[10]=c*t+O*a,r[11]=o*t+G*a,r}function z1(r,e,n){var t=Math.sin(n),a=Math.cos(n),f=e[0],s=e[1],c=e[2],o=e[3],m=e[4],E=e[5],O=e[6],G=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=f*a+m*t,r[1]=s*a+E*t,r[2]=c*a+O*t,r[3]=o*a+G*t,r[4]=m*a-f*t,r[5]=E*a-s*t,r[6]=O*a-c*t,r[7]=G*a-o*t,r}function U1(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function V1(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function j1(r,e,n){var t=n[0],a=n[1],f=n[2],s=Math.sqrt(t*t+a*a+f*f),c=void 0,o=void 0,m=void 0;return s<gr?null:(s=1/s,t*=s,a*=s,f*=s,c=Math.sin(e),o=Math.cos(e),m=1-o,r[0]=t*t*m+o,r[1]=a*t*m+f*c,r[2]=f*t*m-a*c,r[3]=0,r[4]=t*a*m-f*c,r[5]=a*a*m+o,r[6]=f*a*m+t*c,r[7]=0,r[8]=t*f*m+a*c,r[9]=a*f*m-t*c,r[10]=f*f*m+o,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function q1(r,e){var n=Math.sin(e),t=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t,r[6]=n,r[7]=0,r[8]=0,r[9]=-n,r[10]=t,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function X1(r,e){var n=Math.sin(e),t=Math.cos(e);return r[0]=t,r[1]=0,r[2]=-n,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=n,r[9]=0,r[10]=t,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function H1(r,e){var n=Math.sin(e),t=Math.cos(e);return r[0]=t,r[1]=n,r[2]=0,r[3]=0,r[4]=-n,r[5]=t,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function hs(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=t+t,o=a+a,m=f+f,E=t*c,O=t*o,G=t*m,F=a*o,V=a*m,K=f*m,j=s*c,fr=s*o,Gr=s*m;return r[0]=1-(F+K),r[1]=O+Gr,r[2]=G-fr,r[3]=0,r[4]=O-Gr,r[5]=1-(E+K),r[6]=V+j,r[7]=0,r[8]=G+fr,r[9]=V-j,r[10]=1-(E+F),r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}function W1(r,e){var n=new Vr(3),t=-e[0],a=-e[1],f=-e[2],s=e[3],c=e[4],o=e[5],m=e[6],E=e[7],O=t*t+a*a+f*f+s*s;return O>0?(n[0]=(c*s+E*t+o*f-m*a)*2/O,n[1]=(o*s+E*a+m*t-c*f)*2/O,n[2]=(m*s+E*f+c*a-o*t)*2/O):(n[0]=(c*s+E*t+o*f-m*a)*2,n[1]=(o*s+E*a+m*t-c*f)*2,n[2]=(m*s+E*f+c*a-o*t)*2),hs(r,e,n),r}function ms(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function Y1(r,e){var n=e[0],t=e[1],a=e[2],f=e[4],s=e[5],c=e[6],o=e[8],m=e[9],E=e[10];return r[0]=Math.sqrt(n*n+t*t+a*a),r[1]=Math.sqrt(f*f+s*s+c*c),r[2]=Math.sqrt(o*o+m*m+E*E),r}function ps(r,e){var n=e[0]+e[5]+e[10],t=0;return n>0?(t=Math.sqrt(n+1)*2,r[3]=.25*t,r[0]=(e[6]-e[9])/t,r[1]=(e[8]-e[2])/t,r[2]=(e[1]-e[4])/t):e[0]>e[5]&&e[0]>e[10]?(t=Math.sqrt(1+e[0]-e[5]-e[10])*2,r[3]=(e[6]-e[9])/t,r[0]=.25*t,r[1]=(e[1]+e[4])/t,r[2]=(e[8]+e[2])/t):e[5]>e[10]?(t=Math.sqrt(1+e[5]-e[0]-e[10])*2,r[3]=(e[8]-e[2])/t,r[0]=(e[1]+e[4])/t,r[1]=.25*t,r[2]=(e[6]+e[9])/t):(t=Math.sqrt(1+e[10]-e[0]-e[5])*2,r[3]=(e[1]-e[4])/t,r[0]=(e[8]+e[2])/t,r[1]=(e[6]+e[9])/t,r[2]=.25*t),r}function Q1(r,e,n,t){var a=e[0],f=e[1],s=e[2],c=e[3],o=a+a,m=f+f,E=s+s,O=a*o,G=a*m,F=a*E,V=f*m,K=f*E,j=s*E,fr=c*o,Gr=c*m,Or=c*E,Cr=t[0],Rr=t[1],Pr=t[2];return r[0]=(1-(V+j))*Cr,r[1]=(G+Or)*Cr,r[2]=(F-Gr)*Cr,r[3]=0,r[4]=(G-Or)*Rr,r[5]=(1-(O+j))*Rr,r[6]=(K+fr)*Rr,r[7]=0,r[8]=(F+Gr)*Pr,r[9]=(K-fr)*Pr,r[10]=(1-(O+V))*Pr,r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}function K1(r,e,n,t,a){var f=e[0],s=e[1],c=e[2],o=e[3],m=f+f,E=s+s,O=c+c,G=f*m,F=f*E,V=f*O,K=s*E,j=s*O,fr=c*O,Gr=o*m,Or=o*E,Cr=o*O,Rr=t[0],Pr=t[1],Hr=t[2],Qr=a[0],Kr=a[1],Xr=a[2],re=(1-(K+fr))*Rr,Wr=(F+Cr)*Rr,ee=(V-Or)*Rr,Ir=(F-Cr)*Pr,xe=(1-(G+fr))*Pr,Qe=(j+Gr)*Pr,Be=(V+Or)*Hr,Qn=(j-Gr)*Hr,Kn=(1-(G+K))*Hr;return r[0]=re,r[1]=Wr,r[2]=ee,r[3]=0,r[4]=Ir,r[5]=xe,r[6]=Qe,r[7]=0,r[8]=Be,r[9]=Qn,r[10]=Kn,r[11]=0,r[12]=n[0]+Qr-(re*Qr+Ir*Kr+Be*Xr),r[13]=n[1]+Kr-(Wr*Qr+xe*Kr+Qn*Xr),r[14]=n[2]+Xr-(ee*Qr+Qe*Kr+Kn*Xr),r[15]=1,r}function Z1(r,e){var n=e[0],t=e[1],a=e[2],f=e[3],s=n+n,c=t+t,o=a+a,m=n*s,E=t*s,O=t*c,G=a*s,F=a*c,V=a*o,K=f*s,j=f*c,fr=f*o;return r[0]=1-O-V,r[1]=E+fr,r[2]=G-j,r[3]=0,r[4]=E-fr,r[5]=1-m-V,r[6]=F+K,r[7]=0,r[8]=G+j,r[9]=F-K,r[10]=1-m-O,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function J1(r,e,n,t,a,f,s){var c=1/(n-e),o=1/(a-t),m=1/(f-s);return r[0]=f*2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=f*2*o,r[6]=0,r[7]=0,r[8]=(n+e)*c,r[9]=(a+t)*o,r[10]=(s+f)*m,r[11]=-1,r[12]=0,r[13]=0,r[14]=s*f*2*m,r[15]=0,r}function rv(r,e,n,t,a){var f=1/Math.tan(e/2),s=void 0;return r[0]=f/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=f,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,a!=null&&a!==1/0?(s=1/(t-a),r[10]=(a+t)*s,r[14]=2*a*t*s):(r[10]=-1,r[14]=-2*t),r}function ev(r,e,n,t){var a=Math.tan(e.upDegrees*Math.PI/180),f=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),c=Math.tan(e.rightDegrees*Math.PI/180),o=2/(s+c),m=2/(a+f);return r[0]=o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=m,r[6]=0,r[7]=0,r[8]=-((s-c)*o*.5),r[9]=(a-f)*m*.5,r[10]=t/(n-t),r[11]=-1,r[12]=0,r[13]=0,r[14]=t*n/(n-t),r[15]=0,r}function nv(r,e,n,t,a,f,s){var c=1/(e-n),o=1/(t-a),m=1/(f-s);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*o,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*m,r[11]=0,r[12]=(e+n)*c,r[13]=(a+t)*o,r[14]=(s+f)*m,r[15]=1,r}function tv(r,e,n,t){var a=void 0,f=void 0,s=void 0,c=void 0,o=void 0,m=void 0,E=void 0,O=void 0,G=void 0,F=void 0,V=e[0],K=e[1],j=e[2],fr=t[0],Gr=t[1],Or=t[2],Cr=n[0],Rr=n[1],Pr=n[2];return Math.abs(V-Cr)<gr&&Math.abs(K-Rr)<gr&&Math.abs(j-Pr)<gr?vs(r):(E=V-Cr,O=K-Rr,G=j-Pr,F=1/Math.sqrt(E*E+O*O+G*G),E*=F,O*=F,G*=F,a=Gr*G-Or*O,f=Or*E-fr*G,s=fr*O-Gr*E,F=Math.sqrt(a*a+f*f+s*s),F?(F=1/F,a*=F,f*=F,s*=F):(a=0,f=0,s=0),c=O*s-G*f,o=G*a-E*s,m=E*f-O*a,F=Math.sqrt(c*c+o*o+m*m),F?(F=1/F,c*=F,o*=F,m*=F):(c=0,o=0,m=0),r[0]=a,r[1]=c,r[2]=E,r[3]=0,r[4]=f,r[5]=o,r[6]=O,r[7]=0,r[8]=s,r[9]=m,r[10]=G,r[11]=0,r[12]=-(a*V+f*K+s*j),r[13]=-(c*V+o*K+m*j),r[14]=-(E*V+O*K+G*j),r[15]=1,r)}function av(r,e,n,t){var a=e[0],f=e[1],s=e[2],c=t[0],o=t[1],m=t[2],E=a-n[0],O=f-n[1],G=s-n[2],F=E*E+O*O+G*G;F>0&&(F=1/Math.sqrt(F),E*=F,O*=F,G*=F);var V=o*G-m*O,K=m*E-c*G,j=c*O-o*E;return F=V*V+K*K+j*j,F>0&&(F=1/Math.sqrt(F),V*=F,K*=F,j*=F),r[0]=V,r[1]=K,r[2]=j,r[3]=0,r[4]=O*j-G*K,r[5]=G*V-E*j,r[6]=E*K-O*V,r[7]=0,r[8]=E,r[9]=O,r[10]=G,r[11]=0,r[12]=a,r[13]=f,r[14]=s,r[15]=1,r}function iv(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function fv(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2)+Math.pow(r[3],2)+Math.pow(r[4],2)+Math.pow(r[5],2)+Math.pow(r[6],2)+Math.pow(r[7],2)+Math.pow(r[8],2)+Math.pow(r[9],2)+Math.pow(r[10],2)+Math.pow(r[11],2)+Math.pow(r[12],2)+Math.pow(r[13],2)+Math.pow(r[14],2)+Math.pow(r[15],2))}function sv(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r[4]=e[4]+n[4],r[5]=e[5]+n[5],r[6]=e[6]+n[6],r[7]=e[7]+n[7],r[8]=e[8]+n[8],r[9]=e[9]+n[9],r[10]=e[10]+n[10],r[11]=e[11]+n[11],r[12]=e[12]+n[12],r[13]=e[13]+n[13],r[14]=e[14]+n[14],r[15]=e[15]+n[15],r}function ys(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r[4]=e[4]-n[4],r[5]=e[5]-n[5],r[6]=e[6]-n[6],r[7]=e[7]-n[7],r[8]=e[8]-n[8],r[9]=e[9]-n[9],r[10]=e[10]-n[10],r[11]=e[11]-n[11],r[12]=e[12]-n[12],r[13]=e[13]-n[13],r[14]=e[14]-n[14],r[15]=e[15]-n[15],r}function cv(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[7]=e[7]*n,r[8]=e[8]*n,r[9]=e[9]*n,r[10]=e[10]*n,r[11]=e[11]*n,r[12]=e[12]*n,r[13]=e[13]*n,r[14]=e[14]*n,r[15]=e[15]*n,r}function lv(r,e,n,t){return r[0]=e[0]+n[0]*t,r[1]=e[1]+n[1]*t,r[2]=e[2]+n[2]*t,r[3]=e[3]+n[3]*t,r[4]=e[4]+n[4]*t,r[5]=e[5]+n[5]*t,r[6]=e[6]+n[6]*t,r[7]=e[7]+n[7]*t,r[8]=e[8]+n[8]*t,r[9]=e[9]+n[9]*t,r[10]=e[10]+n[10]*t,r[11]=e[11]+n[11]*t,r[12]=e[12]+n[12]*t,r[13]=e[13]+n[13]*t,r[14]=e[14]+n[14]*t,r[15]=e[15]+n[15]*t,r}function ov(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]}function uv(r,e){var n=r[0],t=r[1],a=r[2],f=r[3],s=r[4],c=r[5],o=r[6],m=r[7],E=r[8],O=r[9],G=r[10],F=r[11],V=r[12],K=r[13],j=r[14],fr=r[15],Gr=e[0],Or=e[1],Cr=e[2],Rr=e[3],Pr=e[4],Hr=e[5],Qr=e[6],Kr=e[7],Xr=e[8],re=e[9],Wr=e[10],ee=e[11],Ir=e[12],xe=e[13],Qe=e[14],Be=e[15];return Math.abs(n-Gr)<=gr*Math.max(1,Math.abs(n),Math.abs(Gr))&&Math.abs(t-Or)<=gr*Math.max(1,Math.abs(t),Math.abs(Or))&&Math.abs(a-Cr)<=gr*Math.max(1,Math.abs(a),Math.abs(Cr))&&Math.abs(f-Rr)<=gr*Math.max(1,Math.abs(f),Math.abs(Rr))&&Math.abs(s-Pr)<=gr*Math.max(1,Math.abs(s),Math.abs(Pr))&&Math.abs(c-Hr)<=gr*Math.max(1,Math.abs(c),Math.abs(Hr))&&Math.abs(o-Qr)<=gr*Math.max(1,Math.abs(o),Math.abs(Qr))&&Math.abs(m-Kr)<=gr*Math.max(1,Math.abs(m),Math.abs(Kr))&&Math.abs(E-Xr)<=gr*Math.max(1,Math.abs(E),Math.abs(Xr))&&Math.abs(O-re)<=gr*Math.max(1,Math.abs(O),Math.abs(re))&&Math.abs(G-Wr)<=gr*Math.max(1,Math.abs(G),Math.abs(Wr))&&Math.abs(F-ee)<=gr*Math.max(1,Math.abs(F),Math.abs(ee))&&Math.abs(V-Ir)<=gr*Math.max(1,Math.abs(V),Math.abs(Ir))&&Math.abs(K-xe)<=gr*Math.max(1,Math.abs(K),Math.abs(xe))&&Math.abs(j-Qe)<=gr*Math.max(1,Math.abs(j),Math.abs(Qe))&&Math.abs(fr-Be)<=gr*Math.max(1,Math.abs(fr),Math.abs(Be))}var vv=ds,dv=ys;const hv=Object.freeze(Object.defineProperty({__proto__:null,add:sv,adjoint:D1,clone:L1,copy:O1,create:w1,determinant:P1,equals:uv,exactEquals:ov,frob:fv,fromQuat:Z1,fromQuat2:W1,fromRotation:j1,fromRotationTranslation:hs,fromRotationTranslationScale:Q1,fromRotationTranslationScaleOrigin:K1,fromScaling:V1,fromTranslation:U1,fromValues:R1,fromXRotation:q1,fromYRotation:X1,fromZRotation:H1,frustum:J1,getRotation:ps,getScaling:Y1,getTranslation:ms,identity:vs,invert:F1,lookAt:tv,mul:vv,multiply:ds,multiplyScalar:cv,multiplyScalarAndAdd:lv,ortho:nv,perspective:rv,perspectiveFromFieldOfView:ev,rotate:N1,rotateX:B1,rotateY:k1,rotateZ:z1,scale:I1,set:C1,str:iv,sub:dv,subtract:ys,targetTo:av,translate:$1,transpose:G1},Symbol.toStringTag,{value:"Module"}));function za(){var r=new Vr(3);return Vr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function mv(r){var e=new Vr(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function _s(r){var e=r[0],n=r[1],t=r[2];return Math.sqrt(e*e+n*n+t*t)}function Wn(r,e,n){var t=new Vr(3);return t[0]=r,t[1]=e,t[2]=n,t}function pv(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function yv(r,e,n,t){return r[0]=e,r[1]=n,r[2]=t,r}function _v(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r}function bs(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r}function xs(r,e,n){return r[0]=e[0]*n[0],r[1]=e[1]*n[1],r[2]=e[2]*n[2],r}function Es(r,e,n){return r[0]=e[0]/n[0],r[1]=e[1]/n[1],r[2]=e[2]/n[2],r}function bv(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r}function xv(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r}function Ev(r,e,n){return r[0]=Math.min(e[0],n[0]),r[1]=Math.min(e[1],n[1]),r[2]=Math.min(e[2],n[2]),r}function Av(r,e,n){return r[0]=Math.max(e[0],n[0]),r[1]=Math.max(e[1],n[1]),r[2]=Math.max(e[2],n[2]),r}function Tv(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r}function gv(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r}function Mv(r,e,n,t){return r[0]=e[0]+n[0]*t,r[1]=e[1]+n[1]*t,r[2]=e[2]+n[2]*t,r}function As(r,e){var n=e[0]-r[0],t=e[1]-r[1],a=e[2]-r[2];return Math.sqrt(n*n+t*t+a*a)}function Ts(r,e){var n=e[0]-r[0],t=e[1]-r[1],a=e[2]-r[2];return n*n+t*t+a*a}function gs(r){var e=r[0],n=r[1],t=r[2];return e*e+n*n+t*t}function Sv(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r}function wv(r,e){return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r}function $t(r,e){var n=e[0],t=e[1],a=e[2],f=n*n+t*t+a*a;return f>0&&(f=1/Math.sqrt(f),r[0]=e[0]*f,r[1]=e[1]*f,r[2]=e[2]*f),r}function Ua(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Ft(r,e,n){var t=e[0],a=e[1],f=e[2],s=n[0],c=n[1],o=n[2];return r[0]=a*o-f*c,r[1]=f*s-t*o,r[2]=t*c-a*s,r}function Lv(r,e,n,t){var a=e[0],f=e[1],s=e[2];return r[0]=a+t*(n[0]-a),r[1]=f+t*(n[1]-f),r[2]=s+t*(n[2]-s),r}function Ov(r,e,n,t,a,f){var s=f*f,c=s*(2*f-3)+1,o=s*(f-2)+f,m=s*(f-1),E=s*(3-2*f);return r[0]=e[0]*c+n[0]*o+t[0]*m+a[0]*E,r[1]=e[1]*c+n[1]*o+t[1]*m+a[1]*E,r[2]=e[2]*c+n[2]*o+t[2]*m+a[2]*E,r}function Rv(r,e,n,t,a,f){var s=1-f,c=s*s,o=f*f,m=c*s,E=3*f*c,O=3*o*s,G=o*f;return r[0]=e[0]*m+n[0]*E+t[0]*O+a[0]*G,r[1]=e[1]*m+n[1]*E+t[1]*O+a[1]*G,r[2]=e[2]*m+n[2]*E+t[2]*O+a[2]*G,r}function Cv(r,e){e=e||1;var n=Re()*2*Math.PI,t=Re()*2-1,a=Math.sqrt(1-t*t)*e;return r[0]=Math.cos(n)*a,r[1]=Math.sin(n)*a,r[2]=t*e,r}function Gv(r,e,n){var t=e[0],a=e[1],f=e[2],s=n[3]*t+n[7]*a+n[11]*f+n[15];return s=s||1,r[0]=(n[0]*t+n[4]*a+n[8]*f+n[12])/s,r[1]=(n[1]*t+n[5]*a+n[9]*f+n[13])/s,r[2]=(n[2]*t+n[6]*a+n[10]*f+n[14])/s,r}function Fv(r,e,n){var t=e[0],a=e[1],f=e[2];return r[0]=t*n[0]+a*n[3]+f*n[6],r[1]=t*n[1]+a*n[4]+f*n[7],r[2]=t*n[2]+a*n[5]+f*n[8],r}function Dv(r,e,n){var t=n[0],a=n[1],f=n[2],s=n[3],c=e[0],o=e[1],m=e[2],E=a*m-f*o,O=f*c-t*m,G=t*o-a*c,F=a*G-f*O,V=f*E-t*G,K=t*O-a*E,j=s*2;return E*=j,O*=j,G*=j,F*=2,V*=2,K*=2,r[0]=c+E+F,r[1]=o+O+V,r[2]=m+G+K,r}function Pv(r,e,n,t){var a=[],f=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],f[0]=a[0],f[1]=a[1]*Math.cos(t)-a[2]*Math.sin(t),f[2]=a[1]*Math.sin(t)+a[2]*Math.cos(t),r[0]=f[0]+n[0],r[1]=f[1]+n[1],r[2]=f[2]+n[2],r}function $v(r,e,n,t){var a=[],f=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],f[0]=a[2]*Math.sin(t)+a[0]*Math.cos(t),f[1]=a[1],f[2]=a[2]*Math.cos(t)-a[0]*Math.sin(t),r[0]=f[0]+n[0],r[1]=f[1]+n[1],r[2]=f[2]+n[2],r}function Iv(r,e,n,t){var a=[],f=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],f[0]=a[0]*Math.cos(t)-a[1]*Math.sin(t),f[1]=a[0]*Math.sin(t)+a[1]*Math.cos(t),f[2]=a[2],r[0]=f[0]+n[0],r[1]=f[1]+n[1],r[2]=f[2]+n[2],r}function Nv(r,e){var n=Wn(r[0],r[1],r[2]),t=Wn(e[0],e[1],e[2]);$t(n,n),$t(t,t);var a=Ua(n,t);return a>1?0:a<-1?Math.PI:Math.acos(a)}function Bv(r){return"vec3("+r[0]+", "+r[1]+", "+r[2]+")"}function kv(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]}function zv(r,e){var n=r[0],t=r[1],a=r[2],f=e[0],s=e[1],c=e[2];return Math.abs(n-f)<=gr*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(t-s)<=gr*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(a-c)<=gr*Math.max(1,Math.abs(a),Math.abs(c))}var Uv=bs,Vv=xs,jv=Es,qv=As,Xv=Ts,Ms=_s,Hv=gs,Wv=function(){var r=za();return function(e,n,t,a,f,s){var c=void 0,o=void 0;for(n||(n=3),t||(t=0),a?o=Math.min(a*n+t,e.length):o=e.length,c=t;c<o;c+=n)r[0]=e[c],r[1]=e[c+1],r[2]=e[c+2],f(r,r,s),e[c]=r[0],e[c+1]=r[1],e[c+2]=r[2];return e}}();const Yv=Object.freeze(Object.defineProperty({__proto__:null,add:_v,angle:Nv,bezier:Rv,ceil:bv,clone:mv,copy:pv,create:za,cross:Ft,dist:qv,distance:As,div:jv,divide:Es,dot:Ua,equals:zv,exactEquals:kv,floor:xv,forEach:Wv,fromValues:Wn,hermite:Ov,inverse:wv,len:Ms,length:_s,lerp:Lv,max:Av,min:Ev,mul:Vv,multiply:xs,negate:Sv,normalize:$t,random:Cv,rotateX:Pv,rotateY:$v,rotateZ:Iv,round:Tv,scale:gv,scaleAndAdd:Mv,set:yv,sqrDist:Xv,sqrLen:Hv,squaredDistance:Ts,squaredLength:gs,str:Bv,sub:Uv,subtract:bs,transformMat3:Fv,transformMat4:Gv,transformQuat:Dv},Symbol.toStringTag,{value:"Module"}));function Ss(){var r=new Vr(4);return Vr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function ws(r){var e=new Vr(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function Ls(r,e,n,t){var a=new Vr(4);return a[0]=r,a[1]=e,a[2]=n,a[3]=t,a}function Os(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function Rs(r,e,n,t,a){return r[0]=e,r[1]=n,r[2]=t,r[3]=a,r}function Cs(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r}function Gs(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r}function Fs(r,e,n){return r[0]=e[0]*n[0],r[1]=e[1]*n[1],r[2]=e[2]*n[2],r[3]=e[3]*n[3],r}function Ds(r,e,n){return r[0]=e[0]/n[0],r[1]=e[1]/n[1],r[2]=e[2]/n[2],r[3]=e[3]/n[3],r}function Qv(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r[3]=Math.ceil(e[3]),r}function Kv(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r[3]=Math.floor(e[3]),r}function Zv(r,e,n){return r[0]=Math.min(e[0],n[0]),r[1]=Math.min(e[1],n[1]),r[2]=Math.min(e[2],n[2]),r[3]=Math.min(e[3],n[3]),r}function Jv(r,e,n){return r[0]=Math.max(e[0],n[0]),r[1]=Math.max(e[1],n[1]),r[2]=Math.max(e[2],n[2]),r[3]=Math.max(e[3],n[3]),r}function rd(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r[3]=Math.round(e[3]),r}function Ps(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r}function ed(r,e,n,t){return r[0]=e[0]+n[0]*t,r[1]=e[1]+n[1]*t,r[2]=e[2]+n[2]*t,r[3]=e[3]+n[3]*t,r}function $s(r,e){var n=e[0]-r[0],t=e[1]-r[1],a=e[2]-r[2],f=e[3]-r[3];return Math.sqrt(n*n+t*t+a*a+f*f)}function Is(r,e){var n=e[0]-r[0],t=e[1]-r[1],a=e[2]-r[2],f=e[3]-r[3];return n*n+t*t+a*a+f*f}function Va(r){var e=r[0],n=r[1],t=r[2],a=r[3];return Math.sqrt(e*e+n*n+t*t+a*a)}function ja(r){var e=r[0],n=r[1],t=r[2],a=r[3];return e*e+n*n+t*t+a*a}function nd(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=-e[3],r}function td(r,e){return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r[3]=1/e[3],r}function Ns(r,e){var n=e[0],t=e[1],a=e[2],f=e[3],s=n*n+t*t+a*a+f*f;return s>0&&(s=1/Math.sqrt(s),r[0]=n*s,r[1]=t*s,r[2]=a*s,r[3]=f*s),r}function Bs(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]}function ks(r,e,n,t){var a=e[0],f=e[1],s=e[2],c=e[3];return r[0]=a+t*(n[0]-a),r[1]=f+t*(n[1]-f),r[2]=s+t*(n[2]-s),r[3]=c+t*(n[3]-c),r}function ad(r,e){e=e||1;var n,t,a,f,s,c;do n=Re()*2-1,t=Re()*2-1,s=n*n+t*t;while(s>=1);do a=Re()*2-1,f=Re()*2-1,c=a*a+f*f;while(c>=1);var o=Math.sqrt((1-s)/c);return r[0]=e*n,r[1]=e*t,r[2]=e*a*o,r[3]=e*f*o,r}function id(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3];return r[0]=n[0]*t+n[4]*a+n[8]*f+n[12]*s,r[1]=n[1]*t+n[5]*a+n[9]*f+n[13]*s,r[2]=n[2]*t+n[6]*a+n[10]*f+n[14]*s,r[3]=n[3]*t+n[7]*a+n[11]*f+n[15]*s,r}function fd(r,e,n){var t=e[0],a=e[1],f=e[2],s=n[0],c=n[1],o=n[2],m=n[3],E=m*t+c*f-o*a,O=m*a+o*t-s*f,G=m*f+s*a-c*t,F=-s*t-c*a-o*f;return r[0]=E*m+F*-s+O*-o-G*-c,r[1]=O*m+F*-c+G*-s-E*-o,r[2]=G*m+F*-o+E*-c-O*-s,r[3]=e[3],r}function sd(r){return"vec4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}function zs(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]}function Us(r,e){var n=r[0],t=r[1],a=r[2],f=r[3],s=e[0],c=e[1],o=e[2],m=e[3];return Math.abs(n-s)<=gr*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(t-c)<=gr*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(a-o)<=gr*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(f-m)<=gr*Math.max(1,Math.abs(f),Math.abs(m))}var cd=Gs,ld=Fs,od=Ds,ud=$s,vd=Is,dd=Va,hd=ja,md=function(){var r=Ss();return function(e,n,t,a,f,s){var c=void 0,o=void 0;for(n||(n=4),t||(t=0),a?o=Math.min(a*n+t,e.length):o=e.length,c=t;c<o;c+=n)r[0]=e[c],r[1]=e[c+1],r[2]=e[c+2],r[3]=e[c+3],f(r,r,s),e[c]=r[0],e[c+1]=r[1],e[c+2]=r[2],e[c+3]=r[3];return e}}();const pd=Object.freeze(Object.defineProperty({__proto__:null,add:Cs,ceil:Qv,clone:ws,copy:Os,create:Ss,dist:ud,distance:$s,div:od,divide:Ds,dot:Bs,equals:Us,exactEquals:zs,floor:Kv,forEach:md,fromValues:Ls,inverse:td,len:dd,length:Va,lerp:ks,max:Jv,min:Zv,mul:ld,multiply:Fs,negate:nd,normalize:Ns,random:ad,round:rd,scale:Ps,scaleAndAdd:ed,set:Rs,sqrDist:vd,sqrLen:hd,squaredDistance:Is,squaredLength:ja,str:sd,sub:cd,subtract:Gs,transformMat4:id,transformQuat:fd},Symbol.toStringTag,{value:"Module"}));function It(){var r=new Vr(4);return Vr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function yd(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function Vs(r,e,n){n=n*.5;var t=Math.sin(n);return r[0]=t*e[0],r[1]=t*e[1],r[2]=t*e[2],r[3]=Math.cos(n),r}function _d(r,e){var n=Math.acos(e[3])*2,t=Math.sin(n/2);return t>gr?(r[0]=e[0]/t,r[1]=e[1]/t,r[2]=e[2]/t):(r[0]=1,r[1]=0,r[2]=0),n}function js(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=n[0],o=n[1],m=n[2],E=n[3];return r[0]=t*E+s*c+a*m-f*o,r[1]=a*E+s*o+f*c-t*m,r[2]=f*E+s*m+t*o-a*c,r[3]=s*E-t*c-a*o-f*m,r}function qs(r,e,n){n*=.5;var t=e[0],a=e[1],f=e[2],s=e[3],c=Math.sin(n),o=Math.cos(n);return r[0]=t*o+s*c,r[1]=a*o+f*c,r[2]=f*o-a*c,r[3]=s*o-t*c,r}function Xs(r,e,n){n*=.5;var t=e[0],a=e[1],f=e[2],s=e[3],c=Math.sin(n),o=Math.cos(n);return r[0]=t*o-f*c,r[1]=a*o+s*c,r[2]=f*o+t*c,r[3]=s*o-a*c,r}function Hs(r,e,n){n*=.5;var t=e[0],a=e[1],f=e[2],s=e[3],c=Math.sin(n),o=Math.cos(n);return r[0]=t*o+a*c,r[1]=a*o-t*c,r[2]=f*o+s*c,r[3]=s*o-f*c,r}function bd(r,e){var n=e[0],t=e[1],a=e[2];return r[0]=n,r[1]=t,r[2]=a,r[3]=Math.sqrt(Math.abs(1-n*n-t*t-a*a)),r}function Dt(r,e,n,t){var a=e[0],f=e[1],s=e[2],c=e[3],o=n[0],m=n[1],E=n[2],O=n[3],G=void 0,F=void 0,V=void 0,K=void 0,j=void 0;return F=a*o+f*m+s*E+c*O,F<0&&(F=-F,o=-o,m=-m,E=-E,O=-O),1-F>gr?(G=Math.acos(F),V=Math.sin(G),K=Math.sin((1-t)*G)/V,j=Math.sin(t*G)/V):(K=1-t,j=t),r[0]=K*a+j*o,r[1]=K*f+j*m,r[2]=K*s+j*E,r[3]=K*c+j*O,r}function xd(r){var e=Re(),n=Re(),t=Re(),a=Math.sqrt(1-e),f=Math.sqrt(e);return r[0]=a*Math.sin(2*Math.PI*n),r[1]=a*Math.cos(2*Math.PI*n),r[2]=f*Math.sin(2*Math.PI*t),r[3]=f*Math.cos(2*Math.PI*t),r}function Ed(r,e){var n=e[0],t=e[1],a=e[2],f=e[3],s=n*n+t*t+a*a+f*f,c=s?1/s:0;return r[0]=-n*c,r[1]=-t*c,r[2]=-a*c,r[3]=f*c,r}function Ad(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r}function Ws(r,e){var n=e[0]+e[4]+e[8],t=void 0;if(n>0)t=Math.sqrt(n+1),r[3]=.5*t,t=.5/t,r[0]=(e[5]-e[7])*t,r[1]=(e[6]-e[2])*t,r[2]=(e[1]-e[3])*t;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[a*3+a]&&(a=2);var f=(a+1)%3,s=(a+2)%3;t=Math.sqrt(e[a*3+a]-e[f*3+f]-e[s*3+s]+1),r[a]=.5*t,t=.5/t,r[3]=(e[f*3+s]-e[s*3+f])*t,r[f]=(e[f*3+a]+e[a*3+f])*t,r[s]=(e[s*3+a]+e[a*3+s])*t}return r}function Td(r,e,n,t){var a=.5*Math.PI/180;e*=a,n*=a,t*=a;var f=Math.sin(e),s=Math.cos(e),c=Math.sin(n),o=Math.cos(n),m=Math.sin(t),E=Math.cos(t);return r[0]=f*o*E-s*c*m,r[1]=s*c*E+f*o*m,r[2]=s*o*m-f*c*E,r[3]=s*o*E+f*c*m,r}function gd(r){return"quat("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"}var Md=ws,Sd=Ls,qa=Os,wd=Rs,Ld=Cs,Od=js,Rd=Ps,Ys=Bs,Cd=ks,Xa=Va,Gd=Xa,Ha=ja,Fd=Ha,Wa=Ns,Dd=zs,Pd=Us,$d=function(){var r=za(),e=Wn(1,0,0),n=Wn(0,1,0);return function(t,a,f){var s=Ua(a,f);return s<-.999999?(Ft(r,e,a),Ms(r)<1e-6&&Ft(r,n,a),$t(r,r),Vs(t,r,Math.PI),t):s>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Ft(r,a,f),t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=1+s,Wa(t,t))}}(),Id=function(){var r=It(),e=It();return function(n,t,a,f,s,c){return Dt(r,t,s,c),Dt(e,a,f,c),Dt(n,r,e,2*c*(1-c)),n}}(),Nd=function(){var r=ls();return function(e,n,t,a){return r[0]=t[0],r[3]=t[1],r[6]=t[2],r[1]=a[0],r[4]=a[1],r[7]=a[2],r[2]=-n[0],r[5]=-n[1],r[8]=-n[2],Wa(e,Ws(e,r))}}();const Bd=Object.freeze(Object.defineProperty({__proto__:null,add:Ld,calculateW:bd,clone:Md,conjugate:Ad,copy:qa,create:It,dot:Ys,equals:Pd,exactEquals:Dd,fromEuler:Td,fromMat3:Ws,fromValues:Sd,getAxisAngle:_d,identity:yd,invert:Ed,len:Gd,length:Xa,lerp:Cd,mul:Od,multiply:js,normalize:Wa,random:xd,rotateX:qs,rotateY:Xs,rotateZ:Hs,rotationTo:$d,scale:Rd,set:wd,setAxes:Nd,setAxisAngle:Vs,slerp:Dt,sqlerp:Id,sqrLen:Fd,squaredLength:Ha,str:gd},Symbol.toStringTag,{value:"Module"}));function kd(){var r=new Vr(8);return Vr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0),r[3]=1,r}function zd(r){var e=new Vr(8);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e}function Ud(r,e,n,t,a,f,s,c){var o=new Vr(8);return o[0]=r,o[1]=e,o[2]=n,o[3]=t,o[4]=a,o[5]=f,o[6]=s,o[7]=c,o}function Vd(r,e,n,t,a,f,s){var c=new Vr(8);c[0]=r,c[1]=e,c[2]=n,c[3]=t;var o=a*.5,m=f*.5,E=s*.5;return c[4]=o*t+m*n-E*e,c[5]=m*t+E*r-o*n,c[6]=E*t+o*e-m*r,c[7]=-o*r-m*e-E*n,c}function Qs(r,e,n){var t=n[0]*.5,a=n[1]*.5,f=n[2]*.5,s=e[0],c=e[1],o=e[2],m=e[3];return r[0]=s,r[1]=c,r[2]=o,r[3]=m,r[4]=t*m+a*o-f*c,r[5]=a*m+f*s-t*o,r[6]=f*m+t*c-a*s,r[7]=-t*s-a*c-f*o,r}function jd(r,e){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=e[0]*.5,r[5]=e[1]*.5,r[6]=e[2]*.5,r[7]=0,r}function qd(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=0,r[5]=0,r[6]=0,r[7]=0,r}function Xd(r,e){var n=It();ps(n,e);var t=new Vr(3);return ms(t,e),Qs(r,n,t),r}function Ks(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r}function Hd(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r}function Wd(r,e,n,t,a,f,s,c,o){return r[0]=e,r[1]=n,r[2]=t,r[3]=a,r[4]=f,r[5]=s,r[6]=c,r[7]=o,r}var Yd=qa;function Qd(r,e){return r[0]=e[4],r[1]=e[5],r[2]=e[6],r[3]=e[7],r}var Kd=qa;function Zd(r,e){return r[4]=e[0],r[5]=e[1],r[6]=e[2],r[7]=e[3],r}function Jd(r,e){var n=e[4],t=e[5],a=e[6],f=e[7],s=-e[0],c=-e[1],o=-e[2],m=e[3];return r[0]=(n*m+f*s+t*o-a*c)*2,r[1]=(t*m+f*c+a*s-n*o)*2,r[2]=(a*m+f*o+n*c-t*s)*2,r}function rh(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=n[0]*.5,o=n[1]*.5,m=n[2]*.5,E=e[4],O=e[5],G=e[6],F=e[7];return r[0]=t,r[1]=a,r[2]=f,r[3]=s,r[4]=s*c+a*m-f*o+E,r[5]=s*o+f*c-t*m+O,r[6]=s*m+t*o-a*c+G,r[7]=-t*c-a*o-f*m+F,r}function eh(r,e,n){var t=-e[0],a=-e[1],f=-e[2],s=e[3],c=e[4],o=e[5],m=e[6],E=e[7],O=c*s+E*t+o*f-m*a,G=o*s+E*a+m*t-c*f,F=m*s+E*f+c*a-o*t,V=E*s-c*t-o*a-m*f;return qs(r,e,n),t=r[0],a=r[1],f=r[2],s=r[3],r[4]=O*s+V*t+G*f-F*a,r[5]=G*s+V*a+F*t-O*f,r[6]=F*s+V*f+O*a-G*t,r[7]=V*s-O*t-G*a-F*f,r}function nh(r,e,n){var t=-e[0],a=-e[1],f=-e[2],s=e[3],c=e[4],o=e[5],m=e[6],E=e[7],O=c*s+E*t+o*f-m*a,G=o*s+E*a+m*t-c*f,F=m*s+E*f+c*a-o*t,V=E*s-c*t-o*a-m*f;return Xs(r,e,n),t=r[0],a=r[1],f=r[2],s=r[3],r[4]=O*s+V*t+G*f-F*a,r[5]=G*s+V*a+F*t-O*f,r[6]=F*s+V*f+O*a-G*t,r[7]=V*s-O*t-G*a-F*f,r}function th(r,e,n){var t=-e[0],a=-e[1],f=-e[2],s=e[3],c=e[4],o=e[5],m=e[6],E=e[7],O=c*s+E*t+o*f-m*a,G=o*s+E*a+m*t-c*f,F=m*s+E*f+c*a-o*t,V=E*s-c*t-o*a-m*f;return Hs(r,e,n),t=r[0],a=r[1],f=r[2],s=r[3],r[4]=O*s+V*t+G*f-F*a,r[5]=G*s+V*a+F*t-O*f,r[6]=F*s+V*f+O*a-G*t,r[7]=V*s-O*t-G*a-F*f,r}function ah(r,e,n){var t=n[0],a=n[1],f=n[2],s=n[3],c=e[0],o=e[1],m=e[2],E=e[3];return r[0]=c*s+E*t+o*f-m*a,r[1]=o*s+E*a+m*t-c*f,r[2]=m*s+E*f+c*a-o*t,r[3]=E*s-c*t-o*a-m*f,c=e[4],o=e[5],m=e[6],E=e[7],r[4]=c*s+E*t+o*f-m*a,r[5]=o*s+E*a+m*t-c*f,r[6]=m*s+E*f+c*a-o*t,r[7]=E*s-c*t-o*a-m*f,r}function ih(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=n[0],o=n[1],m=n[2],E=n[3];return r[0]=t*E+s*c+a*m-f*o,r[1]=a*E+s*o+f*c-t*m,r[2]=f*E+s*m+t*o-a*c,r[3]=s*E-t*c-a*o-f*m,c=n[4],o=n[5],m=n[6],E=n[7],r[4]=t*E+s*c+a*m-f*o,r[5]=a*E+s*o+f*c-t*m,r[6]=f*E+s*m+t*o-a*c,r[7]=s*E-t*c-a*o-f*m,r}function fh(r,e,n,t){if(Math.abs(t)<gr)return Ks(r,e);var a=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);t=t*.5;var f=Math.sin(t),s=f*n[0]/a,c=f*n[1]/a,o=f*n[2]/a,m=Math.cos(t),E=e[0],O=e[1],G=e[2],F=e[3];r[0]=E*m+F*s+O*o-G*c,r[1]=O*m+F*c+G*s-E*o,r[2]=G*m+F*o+E*c-O*s,r[3]=F*m-E*s-O*c-G*o;var V=e[4],K=e[5],j=e[6],fr=e[7];return r[4]=V*m+fr*s+K*o-j*c,r[5]=K*m+fr*c+j*s-V*o,r[6]=j*m+fr*o+V*c-K*s,r[7]=fr*m-V*s-K*c-j*o,r}function sh(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r[4]=e[4]+n[4],r[5]=e[5]+n[5],r[6]=e[6]+n[6],r[7]=e[7]+n[7],r}function Zs(r,e,n){var t=e[0],a=e[1],f=e[2],s=e[3],c=n[4],o=n[5],m=n[6],E=n[7],O=e[4],G=e[5],F=e[6],V=e[7],K=n[0],j=n[1],fr=n[2],Gr=n[3];return r[0]=t*Gr+s*K+a*fr-f*j,r[1]=a*Gr+s*j+f*K-t*fr,r[2]=f*Gr+s*fr+t*j-a*K,r[3]=s*Gr-t*K-a*j-f*fr,r[4]=t*E+s*c+a*m-f*o+O*Gr+V*K+G*fr-F*j,r[5]=a*E+s*o+f*c-t*m+G*Gr+V*j+F*K-O*fr,r[6]=f*E+s*m+t*o-a*c+F*Gr+V*fr+O*j-G*K,r[7]=s*E-t*c-a*o-f*m+V*Gr-O*K-G*j-F*fr,r}var ch=Zs;function lh(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[7]=e[7]*n,r}var Js=Ys;function oh(r,e,n,t){var a=1-t;return Js(e,n)<0&&(t=-t),r[0]=e[0]*a+n[0]*t,r[1]=e[1]*a+n[1]*t,r[2]=e[2]*a+n[2]*t,r[3]=e[3]*a+n[3]*t,r[4]=e[4]*a+n[4]*t,r[5]=e[5]*a+n[5]*t,r[6]=e[6]*a+n[6]*t,r[7]=e[7]*a+n[7]*t,r}function uh(r,e){var n=Nt(e);return r[0]=-e[0]/n,r[1]=-e[1]/n,r[2]=-e[2]/n,r[3]=e[3]/n,r[4]=-e[4]/n,r[5]=-e[5]/n,r[6]=-e[6]/n,r[7]=e[7]/n,r}function vh(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r[4]=-e[4],r[5]=-e[5],r[6]=-e[6],r[7]=e[7],r}var rc=Xa,dh=rc,Nt=Ha,hh=Nt;function mh(r,e){var n=Nt(e);if(n>0){n=Math.sqrt(n);var t=e[0]/n,a=e[1]/n,f=e[2]/n,s=e[3]/n,c=e[4],o=e[5],m=e[6],E=e[7],O=t*c+a*o+f*m+s*E;r[0]=t,r[1]=a,r[2]=f,r[3]=s,r[4]=(c-t*O)/n,r[5]=(o-a*O)/n,r[6]=(m-f*O)/n,r[7]=(E-s*O)/n}return r}function ph(r){return"quat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+")"}function yh(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]}function _h(r,e){var n=r[0],t=r[1],a=r[2],f=r[3],s=r[4],c=r[5],o=r[6],m=r[7],E=e[0],O=e[1],G=e[2],F=e[3],V=e[4],K=e[5],j=e[6],fr=e[7];return Math.abs(n-E)<=gr*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(t-O)<=gr*Math.max(1,Math.abs(t),Math.abs(O))&&Math.abs(a-G)<=gr*Math.max(1,Math.abs(a),Math.abs(G))&&Math.abs(f-F)<=gr*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(s-V)<=gr*Math.max(1,Math.abs(s),Math.abs(V))&&Math.abs(c-K)<=gr*Math.max(1,Math.abs(c),Math.abs(K))&&Math.abs(o-j)<=gr*Math.max(1,Math.abs(o),Math.abs(j))&&Math.abs(m-fr)<=gr*Math.max(1,Math.abs(m),Math.abs(fr))}const bh=Object.freeze(Object.defineProperty({__proto__:null,add:sh,clone:zd,conjugate:vh,copy:Ks,create:kd,dot:Js,equals:_h,exactEquals:yh,fromMat4:Xd,fromRotation:qd,fromRotationTranslation:Qs,fromRotationTranslationValues:Vd,fromTranslation:jd,fromValues:Ud,getDual:Qd,getReal:Yd,getTranslation:Jd,identity:Hd,invert:uh,len:dh,length:rc,lerp:oh,mul:ch,multiply:Zs,normalize:mh,rotateAroundAxis:fh,rotateByQuatAppend:ah,rotateByQuatPrepend:ih,rotateX:eh,rotateY:nh,rotateZ:th,scale:lh,set:Wd,setDual:Zd,setReal:Kd,sqrLen:hh,squaredLength:Nt,str:ph,translate:rh},Symbol.toStringTag,{value:"Module"}));function ec(){var r=new Vr(2);return Vr!=Float32Array&&(r[0]=0,r[1]=0),r}function xh(r){var e=new Vr(2);return e[0]=r[0],e[1]=r[1],e}function Eh(r,e){var n=new Vr(2);return n[0]=r,n[1]=e,n}function Ah(r,e){return r[0]=e[0],r[1]=e[1],r}function Th(r,e,n){return r[0]=e,r[1]=n,r}function gh(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r}function nc(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r}function tc(r,e,n){return r[0]=e[0]*n[0],r[1]=e[1]*n[1],r}function ac(r,e,n){return r[0]=e[0]/n[0],r[1]=e[1]/n[1],r}function Mh(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r}function Sh(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r}function wh(r,e,n){return r[0]=Math.min(e[0],n[0]),r[1]=Math.min(e[1],n[1]),r}function Lh(r,e,n){return r[0]=Math.max(e[0],n[0]),r[1]=Math.max(e[1],n[1]),r}function Oh(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r}function Rh(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r}function Ch(r,e,n,t){return r[0]=e[0]+n[0]*t,r[1]=e[1]+n[1]*t,r}function ic(r,e){var n=e[0]-r[0],t=e[1]-r[1];return Math.sqrt(n*n+t*t)}function fc(r,e){var n=e[0]-r[0],t=e[1]-r[1];return n*n+t*t}function sc(r){var e=r[0],n=r[1];return Math.sqrt(e*e+n*n)}function cc(r){var e=r[0],n=r[1];return e*e+n*n}function Gh(r,e){return r[0]=-e[0],r[1]=-e[1],r}function Fh(r,e){return r[0]=1/e[0],r[1]=1/e[1],r}function Dh(r,e){var n=e[0],t=e[1],a=n*n+t*t;return a>0&&(a=1/Math.sqrt(a),r[0]=e[0]*a,r[1]=e[1]*a),r}function Ph(r,e){return r[0]*e[0]+r[1]*e[1]}function $h(r,e,n){var t=e[0]*n[1]-e[1]*n[0];return r[0]=r[1]=0,r[2]=t,r}function Ih(r,e,n,t){var a=e[0],f=e[1];return r[0]=a+t*(n[0]-a),r[1]=f+t*(n[1]-f),r}function Nh(r,e){e=e||1;var n=Re()*2*Math.PI;return r[0]=Math.cos(n)*e,r[1]=Math.sin(n)*e,r}function Bh(r,e,n){var t=e[0],a=e[1];return r[0]=n[0]*t+n[2]*a,r[1]=n[1]*t+n[3]*a,r}function kh(r,e,n){var t=e[0],a=e[1];return r[0]=n[0]*t+n[2]*a+n[4],r[1]=n[1]*t+n[3]*a+n[5],r}function zh(r,e,n){var t=e[0],a=e[1];return r[0]=n[0]*t+n[3]*a+n[6],r[1]=n[1]*t+n[4]*a+n[7],r}function Uh(r,e,n){var t=e[0],a=e[1];return r[0]=n[0]*t+n[4]*a+n[12],r[1]=n[1]*t+n[5]*a+n[13],r}function Vh(r,e,n,t){var a=e[0]-n[0],f=e[1]-n[1],s=Math.sin(t),c=Math.cos(t);return r[0]=a*c-f*s+n[0],r[1]=a*s+f*c+n[1],r}function jh(r,e){var n=r[0],t=r[1],a=e[0],f=e[1],s=n*n+t*t;s>0&&(s=1/Math.sqrt(s));var c=a*a+f*f;c>0&&(c=1/Math.sqrt(c));var o=(n*a+t*f)*s*c;return o>1?0:o<-1?Math.PI:Math.acos(o)}function qh(r){return"vec2("+r[0]+", "+r[1]+")"}function Xh(r,e){return r[0]===e[0]&&r[1]===e[1]}function Hh(r,e){var n=r[0],t=r[1],a=e[0],f=e[1];return Math.abs(n-a)<=gr*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(t-f)<=gr*Math.max(1,Math.abs(t),Math.abs(f))}var Wh=sc,Yh=nc,Qh=tc,Kh=ac,Zh=ic,Jh=fc,rm=cc,em=function(){var r=ec();return function(e,n,t,a,f,s){var c=void 0,o=void 0;for(n||(n=2),t||(t=0),a?o=Math.min(a*n+t,e.length):o=e.length,c=t;c<o;c+=n)r[0]=e[c],r[1]=e[c+1],f(r,r,s),e[c]=r[0],e[c+1]=r[1];return e}}();const nm=Object.freeze(Object.defineProperty({__proto__:null,add:gh,angle:jh,ceil:Mh,clone:xh,copy:Ah,create:ec,cross:$h,dist:Zh,distance:ic,div:Kh,divide:ac,dot:Ph,equals:Hh,exactEquals:Xh,floor:Sh,forEach:em,fromValues:Eh,inverse:Fh,len:Wh,length:sc,lerp:Ih,max:Lh,min:wh,mul:Qh,multiply:tc,negate:Gh,normalize:Dh,random:Nh,rotate:Vh,round:Oh,scale:Rh,scaleAndAdd:Ch,set:Th,sqrDist:Jh,sqrLen:rm,squaredDistance:fc,squaredLength:cc,str:qh,sub:Yh,subtract:nc,transformMat2:Bh,transformMat2d:kh,transformMat3:zh,transformMat4:Uh},Symbol.toStringTag,{value:"Module"})),tm=Object.freeze(Object.defineProperty({__proto__:null,glMatrix:eu,mat2:Su,mat2d:Qu,mat3:S1,mat4:hv,quat:Bd,quat2:bh,vec2:nm,vec3:Yv,vec4:pd},Symbol.toStringTag,{value:"Module"})),am=W0(tm);var Bt=am,On=Bt.vec3,im=Bt.mat3,Pt=Bt.mat4,He=Bt.quat,ye=new Float32Array(16),We=new Float32Array(16);function lc(r,e,n){this.rotation=r,this.center=e,this.distance=n}var Yn=lc.prototype;Yn.view=function(r){return r||(r=Pt.create()),We[0]=We[1]=0,We[2]=-this.distance,Pt.fromRotationTranslation(r,He.conjugate(ye,this.rotation),We),Pt.translate(r,r,On.negate(ye,this.center)),r};Yn.lookAt=function(r,e,n){Pt.lookAt(ye,r,e,n),im.fromMat4(ye,ye),He.fromMat3(this.rotation,ye),On.copy(this.center,e),this.distance=On.distance(r,e)};Yn.pan=function(r){var e=this.distance;ye[0]=-e*(r[0]||0),ye[1]=e*(r[1]||0),ye[2]=e*(r[2]||0),On.transformQuat(ye,ye,this.rotation),On.add(this.center,this.center,ye)};Yn.zoom=function(r){this.distance+=r,this.distance<0&&(this.distance=0)};function es(r,e){var n=e[0],t=e[1];e[2];var a=n*n+t*t;a>1&&(a=1),r[0]=-e[0],r[1]=e[1],r[2]=e[2]||Math.sqrt(1-a),r[3]=0}Yn.rotate=function(r,e){es(ye,r),es(We,e),He.invert(We,We),He.multiply(ye,ye,We),!(He.length(ye)<1e-6)&&(He.multiply(this.rotation,this.rotation,ye),He.normalize(this.rotation,this.rotation))};function fm(r,e,n){r=r||[0,0,-1],e=e||[0,0,0],n=n||[0,1,0];var t=new lc(He.create(),On.create(),1);return t.lookAt(r,e,n),t}var sm=fm;const oc=ts(sm);console.log(oc);const cm=Object.assign({"./shaders/prcl.frag":j0,"./shaders/prcl.vert":ns,"./shaders/prcl_process.frag":q0,"./shaders/prcl_process.vert":X0}),Na=Object.fromEntries(Object.entries(cm).map(([r,e])=>{const n=r.match(new RegExp("(?<=\\/)[^/]+$"))[0];return console.log(n),[n,e]})),Ye=Q0({extensions:["OES_texture_float","OES_texture_float_linear","WEBGL_draw_buffers"],attributes:{alpha:!0,depth:!0,premultipliedAlpha:!1}});Ye.clear({color:[0/255,18/255,70/255,1]});const Ne=64,dn=Ne**2,uc=Ye.buffer({length:dn,type:"float32",data:new Float32Array(dn).map((r,e)=>e)});console.log(new Uint32Array(dn).map((r,e)=>e));const vc=Ye.texture({width:Ne,height:Ne,channels:4,data:new Float32Array(dn*4).map(()=>-1+2*Math.random())}),Ba=new Float32Array(dn*4);for(let r=0;r<Ba.length;r+=4){const e=Math.random()*Math.PI*2,n=.5+Math.sqrt(Math.random())/2,t=Math.cos(e)*n,a=Math.sin(e)*n,f=Math.sqrt(n)*1,s=e+Math.PI/2,c=t/2+.5,o=a/2+.5;Ba.set([c,o,Math.cos(s)*f,Math.sin(s)*f],r)}const ka=[0,0].map(()=>{const r=Ye.texture({width:Ne,height:Ne,wrap:"repeat",data:Ba});return[Ye.framebuffer({width:Ne,height:Ne,color:r,depthStencil:!1}),r]}),lm=Ye({attributes:{aIndex:uc},count:dn,primitive:"points",uniforms:{uColorTex:vc,uPhysTex:(r,e)=>ka[(e.set+1)%2][1],uParticleRadius:Ne},framebuffer:(r,e)=>ka[e.set][0],vert:Na["prcl_process.vert"],frag:Na["prcl_process.frag"]}),dc=new Float32Array(16),hc=Ye({attributes:{aIndex:uc},count:dn,primitive:"points",uniforms:{uColorTex:vc,uPhysTex:(r,e)=>ka[e.set][0],uParticleRadius:Ne,uCamMat:(r,e)=>e.view??dc},vert:ns,frag:Na["prcl.frag"],blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:"src alpha",dstRGB:"one minus src alpha",dstAlpha:"dst alpha"},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!0}});hc({set:0});let Gt=0,Ia=0;const mc=()=>{const r=oc([0,1-Math.cos(Ia/1e3),Math.sin(Ia/1e3)],[0,0,0],[0,-1,0]);r.zoom(-10),r.zoom(-10);const e=r.view(dc);Ye.clear({color:[0/255,18/255,70/255,1]}),lm({set:Gt}),hc({set:Gt,view:e}),Gt=(Gt+1)%2,requestAnimationFrame(mc),Ia++};mc();
